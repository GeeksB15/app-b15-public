"use strict";(self.webpackChunkb15=self.webpackChunkb15||[]).push([[987],{65923:(e,o,t)=>{t.d(o,{Z:()=>le});var a=t(34182);const i={class:"col-auto q-pl-none items-center"},r={class:"col"},l={class:"col-12"},d=(0,a.createTextVNode)(" Finalizado "),n=(0,a.createTextVNode)(" Emissão "),s=(0,a.createTextVNode)(" Vendedor(a) "),c=(0,a.createTextVNode)("Valor total"),m=(0,a.createTextVNode)("NFe de Saída/Venda"),u=(0,a.createTextVNode)("NFe de Entrada/Devolução"),p=(0,a.createTextVNode)("NFe de Remessa"),f=(0,a.createTextVNode)("Migrar para nova fatura"),h=(0,a.createTextVNode)("Histórico do Status"),v=(0,a.createTextVNode)("Sync RouteEasy"),g={class:"col-12 col-md-4"},V=(0,a.createTextVNode)(" OS "),C=(0,a.createTextVNode)("OS "),w={class:"col-12 col-md-4"},N={class:"q-px-sm"},x={class:"q-mt-sm"},b={style:{display:"block"}},y=(0,a.createElementVNode)("br",null,null,-1),k={class:"round-borders"},D={class:"col-12 col-md-4"},E={class:"q-px-sm"},S=(0,a.createTextVNode)(" Faturamento "),F={class:"q-mt-sm"},_={style:{display:"block"}},I={class:"q-px-sm text-right"},T={class:"q-mt-none text-right"},q=(0,a.createElementVNode)("small",{class:"q-mr-xs"},"Desconto",-1),$={class:"text-subtitle1"};var A=t(33337),B=(t(91330),t(72407)),z=t(40480),R=t(51522),U=t(80446),O=t(6791),P=t(58294),M=t(88603);t(65278);const Z={alterados:0,arquivo:null,cor:"text-negative",corFinal:"",erro:"",erros:0,incluidos:0,listaErros:[],mensagem:"",mensagemFinal:"",modalResultado:!1},L={components:{Avatar:A.Z,Badge:B.Z,DocumentosFiscais:z.Z,VendaModal:U.Z,ModalHistoricoStatus:R.Z},computed:{config:()=>O.db.configuracoes.valores,podeMigrarFatura(){return!["Aguardando Estoque","Aguardando Financeiro","Aguardando Aprovação","Aguardando Pagamento","Cancelado","Não Aprovado","Orçamento","Faturado"].includes(this.dados.venda.status)}},data:()=>({importar:$utils.clonarV2(Z),dbUsuario:O.db.usuario,dados:{venda:{}},contatos:{},faturasAbertas:[],detalhesVisivel:!1,visibilidade:{botao:{editar:!1,remover:!1}},modalDevolucaoGarantia:{visivel:!1,item:{},orcamento:{}},sistemaPai:"",configImpressaoOrcamento:[],configImpressaoEnvelope:[]}),emits:["executar"],methods:{irParaAtendimentoFatura(e){this.$router.push({name:"AtendimentoFatura",params:{id:e}})},async migrarFatura(e){try{await this.$q.dialog({message:"Esta ação irá migrar esta venda para outra fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-primary",textColor:"white",flat:!0}})}catch(e){return}e||(e=O.db.fatura.criar(this.dados.venda),await O.db.fatura.grava({fatura:e})),e.id?(await O.db.venda.grava({venda:{id:this.dados.venda.id,idFatura:e.id},vendaOriginal:this.dados.venda}),localStorage.setItem("idFatura",e.id),this.dados.venda.idContato&&(this.$emit("executar","atualizar"),this.irParaAtendimentoFatura(this.dados.venda.idContato))):this.$q.notify("Não foi possível realizar a operação")},alternarDetalhes(){this.detalhesVisivel=!this.detalhesVisivel},async atualizar(){const e=await O.db.venda.leCompleto(this.id);if(e.fatura=await $db.fatura.leCompleto(e.idFatura)||null,e.rota=await $db.documento.le({documentoId:e.venda.id,tipo:"ROTARE"})||null,e.rota=e.rota[0]?e.rota[0]:null,e.carrinho.sort(((e,o)=>new Date(e.dataHoraEmissao)<new Date(o.dataHoraEmissao)?-1:1)),e.oss.sort(((e,o)=>new Date(e.documento.dataHoraEmissao)<new Date(o.documento.dataHoraEmissao)?-1:1)),e.customs.sort(((e,o)=>new Date(e.documento.dataHoraEmissao)<new Date(o.documento.dataHoraEmissao)?-1:1)),(e.venda||{}).idContato&&(e.venda||{}).idEmpresa){let o=[];o=await O.db.fatura.obterAbertas(e.venda.idContato,e.venda.idEmpresa),this.faturasAbertas=o.sort(((e,o)=>!e.numero||e.numero<o.numero?-1:1))}const o={};if(e.venda.idContato){const t=e.venda.idContato;o[t]||(o[t]=await O.db.contato.le({id:t}))}if(e.venda.idContatoVendedor){const t=e.venda.idContatoVendedor;o[t]||(o[t]=await O.db.contato.le({id:t}))}this.configuraImpressaoEnvelope(e.venda.idEmpresa),this.configuraImpressaoOrcamento(e.venda.idEmpresa),this.contatos=o,this.dados=e,await this.$nextTick(),e.venda.id===localStorage.getItem("idVenda")&&(this.$refs.vendaModal.mostrar({id:e.venda.id}),localStorage.removeItem("idVenda"))},async configuraImpressaoEnvelope(e){const o=await O.db.configuracoes.porNome("impressao.envelope",e);this.configImpressaoEnvelope=[...o.length?o.map((e=>({texto:"Imprimir Envelope",...e}))):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]]},async configuraImpressaoOrcamento(e){const o=await O.db.configuracoes.porNome("impressao.venda",e);this.configImpressaoOrcamento=[...o.length?o.map((e=>({texto:"Imprimir Orçamento",...e}))):[{valor:"invoice",texto:"Orçamento/Venda (Invoice)"},"optisoul"===this.sistemaPai?{valor:"orcamento",texto:"Orçamento (Antigo)"}:{}]]},copiarUid(){const e=this.$refs.uid;e.type="text";try{e.select(),document.execCommand("copy"),this.$q.notify({message:"UID copiado para a área de transferência.",type:"info"})}catch(e){this.$q.notify("Erro ao copiar.")}e.type="hidden",window.getSelection().removeAllRanges()},descricaoEnvelope(e){let o="";for(const t of this.dados.itensEnvelopes)t.idDocumentoAdicional===e&&t.descricaoItem.trim()&&(o+=t.descricaoItem.trim()+" | ");return o.slice(0,-3)},async devolucaoGarantia(e){let o=await O.db.documento.le({idContato:O.db.contato.selecionado.id,tipo:"Venda",status:"Orçamento"});o=(0,M.orderBy)(o,"dataHoraEmissao","desc"),o.length?this.modalDevolucaoGarantia={visivel:!0,item:e,orcamento:o[0]}:this.$q.notify({message:"Crie um orçamento para inclusão de devolução/garantia.",type:"info"})},editar(){this.$refs.vendaModal.mostrar({id:this.dados.venda.id})},executar(e){switch(e){case"atualizar":this.atualizar();break;case"cancelar":case"finalizar":case"reprovar":this.$emit("executar","atualizar");break;case"retornarOrcamento":this.$emit("executar",e)}},async finalizaDevolucaoGarantia(e,o,t){const a=(0,P.clonar)(e);"devolucao"===o&&(a.operacao="Devolução de Venda"),"garantia"===o&&(a.operacao="Garantia de Venda",a.motivo=t),a.idDocumentoItemVenda=a.id,a.idDocumentoVenda=a.idDocumento,a.id=(0,P.uuid)(),a.idDocumento=this.modalDevolucaoGarantia.orcamento.id,a.status="Orçamento",a.operacaoFator=1,a.codigoCfop=20,a.idCfop=(await O.db.cfop.le({codigoCfop:20}))[0].id,a.dataHoraEmissao=(0,P.dataAtual)(),a.dataHoraFinalizado="",a.subTotal=-1*a.subTotal,a.total=-1*a.total,a.valorItem=-1*a.valorItem,a.descontoSubTotal=0,delete a.codigoCfop,delete a.codigoDocumento,delete a.codigoDocumentoItem,delete a.codigoItem,delete a.codigoPlanoContaDestino,delete a.codigoPlanoContaEstoque,await O.db.documentoItem.grava({atual:a}),this.$q.notify({message:"Item adicionado ao orçamento.",type:"positive"}),localStorage.setItem("idVenda",this.modalDevolucaoGarantia.orcamento.id),this.$emit("executar","atualizar")},async remover(){this.$q.dialog({message:"Esta ação irá remover esta venda da fatura",title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk((async()=>{let e=(0,P.clonar)(this.dados.venda);this.dados.venda.idFatura="",await O.db.venda.grava({venda:this.dados.venda,vendaOriginal:e}),this.$emit("executar","remover")}))}},props:{id:{required:!0,type:String},sendRouteEasy:{required:!1,type:Function},sendRouteEasyAll:{required:!1,type:Function},rota:{required:!1,type:Object}},watch:{async dados(e){this.visibilidade.botao.editar=!1,this.visibilidade.botao.remover=!1,(await O.db.contatoBusca.filtrar(null,{ativo:!0,empresas:!0},0)).find((o=>o.id===e.venda.idEmpresa))&&(e.venda.idFatura&&this.faturasAbertas.find((o=>o.id===e.venda.idFatura))&&(this.visibilidade.botao.remover=!0),["Cancelado","Não Aprovado"].includes(e.venda.status)||e.venda.idFatura||(this.visibilidade.botao.editar=!0))}},mounted(){this.sistemaPai=(0,P.sistemaPai)(),this.atualizar()}};var H=t(74260),Q=t(77953),G=t(60880),j=t(31106),X=t(76106),J=t(4957),W=t(37617),Y=t(54707),K=t(25901),ee=t(68900),oe=t(48761),te=t(83831),ae=t(98586),ie=t(7518),re=t.n(ie);const le=(0,H.Z)(L,[["render",function(e,o,t,A,B,z){const R=(0,a.resolveComponent)("badge"),U=(0,a.resolveComponent)("q-item-section"),O=(0,a.resolveComponent)("avatar"),P=(0,a.resolveComponent)("q-item-label"),M=(0,a.resolveComponent)("q-badge"),Z=(0,a.resolveComponent)("row"),L=(0,a.resolveComponent)("q-tooltip"),H=(0,a.resolveComponent)("q-btn"),Q=(0,a.resolveComponent)("q-icon"),G=(0,a.resolveComponent)("q-item"),j=(0,a.resolveComponent)("q-list"),X=(0,a.resolveComponent)("q-menu"),J=(0,a.resolveComponent)("q-toolbar-title"),W=(0,a.resolveComponent)("documentos-fiscais"),Y=(0,a.resolveComponent)("q-separator"),K=(0,a.resolveComponent)("VendaModal"),ee=(0,a.resolveComponent)("modal-historico-status"),oe=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[B.dados.venda.id?((0,a.openBlock)(),(0,a.createBlock)(G,{key:0,id:"VendaCard","manual-focus":"",clickable:"",class:"items-center d-flex q-pa-xs"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:"",center:"",class:"mw100",onClick:z.editar},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(R,{class:"q-mr-sm",escuro:"",cor:"positive",onClick:z.copiarUid},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" #"+(0,a.toDisplayString)(parseInt(B.dados.venda.numero)||(B.dados.venda.id||"").slice(-6))+" ",1),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"hidden","onUpdate:modelValue":o[0]||(o[0]=e=>B.dados.venda.id=e),ref:"uid"},null,512),[[a.vModelText,B.dados.venda.id]])])),_:1},8,["onClick"])])),_:1},8,["onClick"]),(0,a.createVNode)(U,{onClick:z.editar},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{class:"items-center"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",i,[(0,a.createVNode)(O,{imagem:(B.contatos[B.dados.venda.idContato]||{}).imagem,rotulo:B.dados.venda.descricaoContato,tamanho:"40",style:{float:"left"}},null,8,["imagem","rotulo"])]),(0,a.createElementVNode)("div",r,[(0,a.createVNode)(P,{class:"text-tertiary text-weight-bold"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.dados.venda.descricaoContato),1)])),_:1}),(0,a.createVNode)(Z,{class:"hideondesktop items-center q-my-sm"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",l,[(0,a.createVNode)(M,{color:"tertiary"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.dados.venda.status),1)])),_:1})])])),_:1})])])),_:1})])),_:1},8,["onClick"]),(0,a.createVNode)(U,{onClick:z.editar,class:"hideonmobile"},{default:(0,a.withCtx)((()=>[B.dados.venda.dataHoraFinalizado?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(B.dados.venda.dataHoraFinalizado))+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[d])),_:1})],64)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(B.dados.venda.dataHoraEmissao))+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[n])),_:1})],64))])),_:1},8,["onClick"]),(0,a.createVNode)(U,{onClick:z.editar,class:"hideonmobile"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)((B.contatos[B.dados.venda.idContatoVendedor]||{}).apelido)+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[s])),_:1})])),_:1},8,["onClick"]),(0,a.createVNode)(U,{avatar:"",class:"mw240 hideonmobile"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(M,{color:"tertiary"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.dados.venda.status),1)])),_:1}),B.dados.rota?((0,a.openBlock)(),(0,a.createBlock)(M,{key:0,color:"primary",style:{"margin-top":"5px"}},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.dados.rota.RotaStatus),1)])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(U,{onClick:z.editar},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,{caption:"",class:"text-right text-tertiary text-weight-bold"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(B.dados.venda.totalDocumento,2))+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[c])),_:1})])),_:1})])),_:1},8,["onClick"]),(0,a.createVNode)(U,{side:"",top:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(H,{rounded:"",dense:"",flat:"",icon:B.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",unelevated:"",class:"hideonmobile q-mx-xs",color:"tertiary",style:{float:"right"},onClick:z.alternarDetalhes},null,8,["icon","onClick"]),(0,a.createVNode)(H,{rounded:"",dense:"",flat:"",icon:"clear",color:"tertiary",unelevated:"",class:"hideonmobile q-mx-xs",size:"md",onClick:z.remover,style:{float:"right"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{anchor:"top left",self:"bottom start"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Remover da fatura #"+(0,a.toDisplayString)(parseInt(B.dados.venda.numero)||(B.dados.venda.id||"").slice(-6)),1)])),_:1})])),_:1},8,["onClick"]),(0,a.createVNode)(H,{rounded:"",dense:"",flat:"",icon:"edit",color:"primary",unelevated:"",class:"hideonmobile q-mx-xs",size:"md",onClick:z.editar,style:{float:"right"}},null,8,["onClick"]),(0,a.createVNode)(H,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",unelevated:"",class:"hideonmobile q-mx-xs",size:"md",style:{float:"right"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(X,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(j,{link:"",separator:""},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.configImpressaoOrcamento.filter((e=>e.valor)),(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{clickable:"",key:o.valor,onClick:t=>e.$imprimir(o.valor,{id:(B.dados.venda||{}).id||"0",Oculto:"0"})},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"print"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.texto),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),"optisoul"===B.sistemaPai?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(B.configImpressaoEnvelope,(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{clickable:"",key:o.valor,onClick:t=>e.$imprimir(o.valor,(B.dados.venda||{}).id||"0")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"print"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.texto),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(H,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",unelevated:"",class:"q-mx-xs",size:"md",style:{float:"right"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(X,null,{default:(0,a.withCtx)((()=>[(0,a.withDirectives)((0,a.createVNode)(j,{link:"",separator:""},{default:(0,a.withCtx)((()=>[e.$utils.mapearStatus(B.dados.venda).permiteNota?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.withDirectives)((0,a.createVNode)(G,{clickable:"",onClick:o[1]||(o[1]=o=>e.emitirNFeV2({idVenda:B.dados.venda.id},1,"Venda"))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"account_balance"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[m])),_:1})])),_:1},512),[[oe]]),(0,a.withDirectives)((0,a.createVNode)(G,{clickable:"",onClick:o[2]||(o[2]=o=>e.emitirNFeV2({idVenda:B.dados.venda.id},0,"Devolução"))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"account_balance"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[u])),_:1})])),_:1},512),[[oe]]),(0,a.withDirectives)((0,a.createVNode)(G,{clickable:"",onClick:o[3]||(o[3]=o=>e.emitirNFeV2({idVenda:B.dados.venda.id},1,"Remessa"))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"account_balance"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[p])),_:1})])),_:1},512),[[oe]])],64)):(0,a.createCommentVNode)("",!0),z.podeMigrarFatura?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.faturasAbertas.filter((e=>e.id!==B.dados.venda.idFatura)),(e=>(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(G,{key:e.id,onClick:o=>z.migrarFatura(e)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"mdi-folder-move"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)("Migrar para fatura #"+(e.numero||e.id.slice(-6))),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[oe]]))),128)),(0,a.withDirectives)((0,a.createVNode)(G,{onClick:o[4]||(o[4]=e=>z.migrarFatura())},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"mdi-folder-move"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[f])),_:1})])),_:1},512),[[oe]])],64)):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(G,{clickable:"",onClick:o[5]||(o[5]=o=>e.$refs.modalHistoricoStatus.mostrar({idDocumento:B.dados.venda.id}))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"history"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[h])),_:1})])),_:1}),"function"==typeof t.sendRouteEasy?((0,a.openBlock)(),(0,a.createBlock)(G,{key:2,clickable:"",onClick:o[6]||(o[6]=e=>t.sendRouteEasy([B.dados]))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"history"})])),_:1}),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[v])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1},512),[[oe]])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0),B.detalhesVisivel?((0,a.openBlock)(),(0,a.createBlock)(Z,{key:1,class:"q-col-gutter-md q-pt-md"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",g,[B.detalhesVisivel?((0,a.openBlock)(),(0,a.createBlock)(j,{key:0},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.dados.carrinho,(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{class:"fullWidth",key:o.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:"",class:"w120"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.quantidade)+"x",1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.descricaoItem),1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,{side:"",top:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(o.total,2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.dados.customs,(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{class:"fullWidth",key:o.documento.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:"",class:"w120"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.documento.numero)+"x ",1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.documento.descricao),1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,{side:"",top:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(o.documento.totalDocumento,2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.dados.oss,(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{class:"fullWidth",key:o.documento.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:"",class:"w120"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>["Orçamento"!==o.documento.status?((0,a.openBlock)(),(0,a.createBlock)(R,{key:0,class:"q-mx-sm",escuro:"",cor:"grey-5",denso:"",round:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.documento.status)+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[V])),_:1})])),_:2},1024)):((0,a.openBlock)(),(0,a.createBlock)(R,{key:1},{default:(0,a.withCtx)((()=>[C])),_:1}))])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.documento.descricao),1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,{right:"",top:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(o.documento.totalDocumento,2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.dados.envelopes,(o=>((0,a.openBlock)(),(0,a.createBlock)(G,{class:"fullWidth",key:o.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{avatar:"",class:"w120"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(R,{class:"q-mx-sm",escuro:"",cor:"grey-5",denso:"",round:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" #"+(0,a.toDisplayString)(parseInt(o.numero)||(o.id||"").slice(-6))+" ",1),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.tipo)+" - "+(0,a.toDisplayString)(o.descricaoContato),1)])),_:2},1024)])),_:2},1024),"Orçamento"!==o.status?((0,a.openBlock)(),(0,a.createBlock)(R,{key:0,class:"q-mx-sm",escuro:"",cor:"grey-5",denso:"",round:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.status),1)])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:2},1024),(0,a.createVNode)(U,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(z.descricaoEnvelope(o.id)),1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(U,{right:"",top:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(o.totalDocumento,2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",w,[(0,a.createElementVNode)("div",N,[(0,a.createVNode)(J,{class:"q-mx-none q-mt-sm q-px-none"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{name:"business"}),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(B.dados.venda.descricaoEmpresa),1)])),_:1}),(0,a.createElementVNode)("p",x,[(0,a.createElementVNode)("small",b,[(0,a.createTextVNode)((0,a.toDisplayString)(B.dados.venda.observacao)+" ",1),y,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(B.dados.venda.observacaoInterna),1)])]),(0,a.createElementVNode)("div",k,[(0,a.createVNode)(W,{idVenda:B.dados.venda.id},null,8,["idVenda"])])])]),(0,a.createElementVNode)("div",D,[(0,a.createElementVNode)("div",E,[(0,a.createVNode)(J,{class:"q-mx-none q-mt-sm q-px-none"},{default:(0,a.withCtx)((()=>[S])),_:1}),(0,a.createElementVNode)("p",F,[(0,a.createElementVNode)("small",_,(0,a.toDisplayString)(B.dados.venda.observacaoFaturamento),1)])]),(0,a.createElementVNode)("div",I,[(0,a.createElementVNode)("dl",T,[(0,a.createElementVNode)("dd",null,[q,(0,a.createElementVNode)("span",$,[(0,a.createElementVNode)("strong",null,(0,a.toDisplayString)(e.$filters.numero(B.dados.venda.totalDesconto,2)),1)])])])])])])),_:1})):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(Y),(0,a.createVNode)(K,{ref:"vendaModal",onExecutar:z.executar},null,8,["onExecutar"]),(0,a.createVNode)(ee,{ref:"modalHistoricoStatus"},null,512)])}]]);re()(L,"components",{QItem:Q.Z,QItemSection:G.Z,QItemLabel:j.Z,QBadge:X.Z,QTooltip:J.Z,QBtn:W.Z,QMenu:Y.Z,QList:K.Z,QIcon:ee.Z,QToolbarTitle:oe.Z,QSeparator:te.Z}),re()(L,"directives",{ClosePopup:ae.Z})},23238:(e,o,t)=>{t.r(o),t.d(o,{default:()=>w});var a=t(34182);const i=(0,a.createElementVNode)("span",{class:"col-12 text-body1 text-dark"},"Período de Emissão",-1),r=(0,a.createElementVNode)("span",{class:"col-12 text-body1 text-dark"},"Período de Finalização",-1);var l=t(98107),d=t(65923),n=t(80446),s=t(58294),c=t(6791),m=t(88603),u=t(60357);const p={components:{lista:l.Z,VendaCard:d.Z,PromptContatoNovo:u.Z,VendaModal:n.Z},data:()=>({tabSelecionada:{valor:"Todas"},tabs:[{rotulo:"Aguardando Faturamento",value:"Aguardando Faturamento"},{rotulo:"Faturado",value:"Faturado"},{rotulo:"Orçamento",value:"Orçamento"},{rotulo:"Aguardando Liberação",value:"Aguardando Liberação"},{rotulo:"Não Aprovado",value:"Não Aprovado"},{rotulo:"Todas",value:"Todas"}],page:{digitacao:{current:1,min:0,max:0},finalizado:{current:1,min:0,max:0},ativa:"Digitação"},entregueInicio:new Date(new Date($utils.dataAtual()).toDateString()),entregueFim:new Date(new Date($utils.dataAtual()).toDateString()),status:[],operacoes:[],pageSize:10,grupos:[],buscaCampo:"",empresas:[],empresa:{},contatosModal:!1,vendedorModal:!1,digitadorModal:!1,filtro:{status:"",operacao:"",grupos:[],empresa:{id:""},cliente:{id:""},vendedor:{id:""},digitador:{id:""},periodo:{emissao:{ini:"",fim:""},finalizado:{ini:"",fim:""}}},paginacao:{atual:1,maximo:1,total:1,limite:25},dbContato:c.db.contato,documentos:null,showFilters:!1,itens:[],documentoItens:[],vendedorDigitadorSelecionado:null,vendedoresDigitadoresOpcoes:[],diretivaContatosAcessaTodosContatos:!1,showAllPreviewDetail:!1,lista:[]}),methods:{async filtrar(){this.documentos=await c.db.venda.leNew(),this.empresas=await c.db.empresa.le(),this.documentos.map((e=>{this.status.includes(e.status)||this.status.push(e.status),this.operacoes.includes(e.operacao)||this.operacoes.push(e.operacao)}));let e=[];try{const o=await c.db.venda.leRefatorado({filtros:{periodoEmissao:{ini:this.filtro.periodo.emissao.ini,fim:this.filtro.periodo.emissao.fim},periodoFinalizado:{ini:this.filtro.periodo.finalizado.ini,fim:this.filtro.periodo.finalizado.fim},status:this.filtro.status,operacao:this.filtro.operacao,idEmpresa:this.filtro.empresa.id,idContato:this.filtro.cliente.id,idContatoVendedor:this.filtro.vendedor.id,idContatoDigitador:this.filtro.digitador.id},termoBusca:this.buscaCampo,limit:this.paginacao.limite,page:this.paginacao.atual,sort:""});e=o.data,this.paginacao.total=o.total,this.paginacao.maximo=o.totalPages;let t=[];for(const o of e){const e=await c.db.documentoItem.leNew({idDocumento:o.id});t=[...t,...e.filter((e=>e.idItem))]}let a=[];for(const e of t)if(e.idItem&&!a.filter((o=>o.id===e.idItem)).length){const o=await c.db.item.leNew({id:e.idItem});a.push(o)}this.documentos=e}catch(e){this.$q.notify("Erro ao filtrar")}},aoSelecionarEmpresa(){this.filtro.empresa=this.empresas.filter((e=>e.id===this.empresa.id))[0]},aoSelecionarCliente(e,o){e&&(this.filtro.cliente=(0,s.clonarV2)(o),this.contatosModal=!1)},adicionarVenda(){this.$refs.modalVenda.mostrar()},async buscar(){let e=await c.db.venda.leNew(),o=[];for(const t of e){const e=await c.db.documentoItem.leNew({idDocumento:t.id});o=[...o,...e.filter((e=>e.idItem))]}let t=[],a={};for(const e of o)if(e.idItem&&!t.filter((o=>o.id===e.idItem)).length){const o=await c.db.item.leNew({id:e.idItem});t.push(o)}const i=[(0,s.removerAcentos)(this.buscaCampo)];let r=e.filter((e=>{if(!e.numero)return!1;const o=String(e.numero);for(const e of i){const t=new RegExp(e,"gi");if(o.match(t))return!0}})),l=[],d=o.filter((e=>{if(!e.idItem&&!e.descricaoItem)return!1;const o=(0,s.removerAcentos)(e.descricaoItem);for(const t of i){const a=new RegExp(t,"gi");if(o.match(a))return l.push(e.id),!0}}));a=t.filter((e=>{const o=e.marca||"",t=e.referencia||"",a=e.codigoItem?String(e.codigoItem):"",r=e.codigoBarras||"",l=(0,s.removerAcentos)(o+t+a+r);for(const e of i){const o=new RegExp(e,"gi");if(l.match(o))return!0}}));for(const e of r){const t=o.filter((o=>{if(o.idItem&&o.idDocumento===e.id&&!l.includes(o.id))return l.push(o.id),!0}));d=[...d,...t]}for(const e of a){const t=o.filter((o=>{if(o.idItem===e.id&&!l.includes(o.id))return l.push(o.id),!0}));d=[...d,...t]}d=d.filter((o=>{let a=(0,s.clonarV2)(i),r=e.filter((e=>e.id===o.idDocumento)),l=t.filter((e=>e.id===o.idItem));r=r.length?r[0]:{},l=l.length?l[0]:{};let d=r.numero?String(r.numero):"";if(d+=o.descricaoItem||"",d+=l.marca||"",d+=l.referencia||"",d+=l.codigoItem?String(l.codigoItem):"",d+=l.codigoBarras||"",d)for(const e of i){const o=new RegExp(e,"gi");d.match(o)&&(a=a.filter((o=>o!==e)))}if(!a.length)return!0}));let n=[];r=[],a={};for(const o of d)if(n.includes(o.idDocumento)||(n.push(o.idDocumento),r=[...r,...e.filter((e=>e.id===o.idDocumento))]),!a[o.idItem]){const e=t.filter((e=>e.id===o.idItem));e.length&&(a[o.idItem]=e[0])}e=(0,m.orderBy)(r,["dataHoraFinalizado","dataHoraEmissao"],["desc","desc"]),this.documentos=r.reduce(((e,o)=>(e[o.id]||(e[o.id]=o),e)),{}),this.itens=a,this.documentosItens=(0,m.orderBy)(d,["dataHoraFinalizado","dataHoraEmissao"],["desc","desc"])},async abrirEdicao(e){console.log(e);let o=await c.db.venda.leCompleto({codigoDocumento:e.codigoDocumento});console.log({leCompleto:o})},filtraDebounce(){(0,m.debounce)(this.refazFiltro,700)()},refazFiltro(){s.gconsole.log("FunilVendas","refazFiltro()",this.fraseFiltro,this.empresaSelecionada);const e=(0,s.removerAcentos)((this.fraseFiltro||"").toUpperCase()).split(" ").filter((e=>""!==e)),o={};for(const t in this.listas)for(const a of this.listas[t]){const t=(0,s.removerAcentos)((a.id||"").toUpperCase()+(a.nomeCliente||"").toUpperCase()+(a.nomeDigitador||"").toUpperCase()+(a.nomeVendedor||"").toUpperCase()+" "+String(a.numeroVenda||"")+" ");let i=!0;for(const o of e)i=isNaN(Number(o))?i&&t.includes(o):i&&t.includes(" "+o+" ");this.empresaSelecionada&&(i=i&&this.empresaSelecionada===a.codigoEmpresa),this.vendedorDigitadorSelecionado&&(i=i&&(this.vendedorDigitadorSelecionado.value===a.codigoContatoDigitador||this.vendedorDigitadorSelecionado.value===a.codigoContatoVendedor)),a.mostra=i,a.mostra&&(o[a.crmFunilStatus]=(o[a.crmFunilStatus]||0)+(a.totalDocumento||0))}this.total=o},async atualizar(){try{$q.loading.show();let e="";"Todas"!==this.tabSelecionada.valor&&(e=this.tabSelecionada.valor),null!==this.vendedorDigitadorSelecionado&&(this.filtro.vendedor.id=this.vendedorDigitadorSelecionado.value),this.filtro.status=e,await this.filtrar()}catch(e){$q.notifyError("Erro iniciar",e)}finally{$q.loading.hide()}},abrirTodosPreview(){this.showAllPreviewDetail=!this.showAllPreviewDetail;for(let e of this.documentos)this.$refs[e.id].detalhesVisivel=this.showAllPreviewDetail}},watch:{},created(){s.gconsole.log("FunilVendas","created()"),$db.permissao.objeto("Diretiva_RelatorioVenda_VerTodos").then((e=>{this.diretivaContatosAcessaTodosContatos=e,this.diretivaContatosAcessaTodosContatos&&(this.vendedoresDigitadoresOpcoes=[],$db.crm.leOnlineVendedoresDigitadores({entregueInicio:this.entregueInicio,entregueFim:this.entregueFim}).then((e=>{e.forEach((e=>{e.codigo&&this.vendedoresDigitadoresOpcoes.push({label:e.nome,value:e.codigo})}))})))})),this.atualizar()},refazFiltro(){$utils.gconsole.log("FunilVendas","refazFiltro()",this.fraseFiltro,this.empresaSelecionada);const e=$utils.removerAcentos((this.fraseFiltro||"").toUpperCase()).split(" ").filter((e=>""!==e)),o={};for(const t in this.listas)for(const a of this.listas[t]){const t=$utils.removerAcentos((a.id||"").toUpperCase()+(a.nomeCliente||"").toUpperCase()+(a.nomeDigitador||"").toUpperCase()+(a.nomeVendedor||"").toUpperCase()+" "+String(a.numeroVenda||"")+" ");let i=!0;for(const o of e)i=isNaN(Number(o))?i&&t.includes(o):i&&t.includes(" "+o+" ");this.empresaSelecionada&&(i=i&&this.empresaSelecionada.value===a.codigoEmpresa),this.vendedorDigitadorSelecionado&&(i=i&&(this.vendedorDigitadorSelecionado.value===a.codigoContatoDigitador||this.vendedorDigitadorSelecionado.value===a.codigoContatoVendedor)),a.mostra=i,a.mostra&&(o[a.crmFunilStatus]=(o[a.crmFunilStatus]||0)+(a.totalDocumento||0))}const t={};for(const e in this.listas)this.tamanhoLista[e]=10,t[e]=this.listas[e].filter((e=>e.mostra)).slice(0,this.tamanhoLista[e]),document.getElementById(e);this.listasFiltradas=t,this.$nextTick((()=>{for(const e in this.listasFiltradas)document.getElementById(e).removeEventListener("scroll",this.scrollHandler),document.getElementById(e).addEventListener("scroll",this.scrollHandler)})),this.total=o}};var f=t(74260),h=t(67280),v=t(40320),g=t(25901),V=t(7518),C=t.n(V);const w=(0,f.Z)(p,[["render",function(e,o,t,l,d,n){const s=(0,a.resolveComponent)("q-chips-input"),c=(0,a.resolveComponent)("campo"),m=(0,a.resolveComponent)("q-select"),u=(0,a.resolveComponent)("row"),p=(0,a.resolveComponent)("venda-card"),f=(0,a.resolveComponent)("q-list"),h=(0,a.resolveComponent)("lista"),v=(0,a.resolveComponent)("prompt-contato-novo"),g=(0,a.resolveComponent)("VendaModal");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(h,{titulo:"Vendas",onCriar_click:n.adicionarVenda,onCheckBoxGeral_click:e.checkBoxGeral_click,showAdd:"false",icone:"mdi-cart-arrow-up",showToolbar:"false",onFiltro_change:n.atualizar,onLimparFiltros_click:e.limparFiltros_click,onAbrirTodosPreview:n.abrirTodosPreview,onExportarXLSX_click:e.exportarXLSX_click,onRemoverTodos:e.removerTodos,onRestaurarTodos:e.restaurarTodos,tabSelecionada:d.tabSelecionada,tabs:d.tabs,lista:d.lista,listaLayout:e.listaLayout,paginacao:d.paginacao,filtros:d.filtro,opcoesMarca:e.opcoesMarca,opcoesGrupo:e.opcoesGrupo,opcoesSubGrupo:e.opcoesSubGrupo,opcoesTipo:e.opcoesTipo,exportarXLSXVisible:!1,permissaoFicha:!1,buscaCampo:d.buscaCampo,"onUpdate:buscaCampo":o[10]||(o[10]=e=>d.buscaCampo=e),checkboxModel:e.checkboxModel,"onUpdate:checkboxModel":o[11]||(o[11]=o=>e.checkboxModel=o)},{filtroCampos:(0,a.withCtx)((()=>[(0,a.createVNode)(s,{modelValue:d.filtro.grupos,"onUpdate:modelValue":o[0]||(o[0]=e=>d.filtro.grupos=e),color:"tertiary",class:"col-12",placeholder:"Filtre por Produto, Marca, Número..."},null,8,["modelValue","placeholder"]),(0,a.createVNode)(c,{tipo:"seletor",dense:"",modelValue:d.empresa.id,"onUpdate:modelValue":[o[1]||(o[1]=e=>d.empresa.id=e),n.aoSelecionarEmpresa],options:d.empresas.map((e=>({label:e.nome,value:e.id}))),clearable:"",rotulo:"Por empresa"},null,8,["modelValue","options","onUpdate:modelValue"]),(0,a.createVNode)(c,{tipo:"seletor",dense:"",modelValue:d.filtro.operacao,"onUpdate:modelValue":o[2]||(o[2]=e=>d.filtro.operacao=e),options:d.operacoes.map((e=>({label:e,value:e}))),clearable:"",rotulo:"Operação"},null,8,["modelValue","options"]),(0,a.createVNode)(c,{rotulo:"Cliente",tipo:"texto",before:[{icon:"search"}],modelValue:d.filtro.cliente.nome,"onUpdate:modelValue":[o[3]||(o[3]=e=>d.filtro.cliente.nome=e),n.aoSelecionarCliente],onClick:o[4]||(o[4]=e=>d.contatosModal=!0),dense:""},null,8,["modelValue","onUpdate:modelValue"]),d.diretivaContatosAcessaTodosContatos?((0,a.openBlock)(),(0,a.createBlock)(m,{key:0,modelValue:d.vendedorDigitadorSelecionado,"onUpdate:modelValue":[o[5]||(o[5]=e=>d.vendedorDigitadorSelecionado=e),n.atualizar],options:d.vendedoresDigitadoresOpcoes,clearable:"",label:"Vendedor / Digitador"},null,8,["modelValue","options","onUpdate:modelValue"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(u,{class:"q-col-gutter-md q-mt-md"},{default:(0,a.withCtx)((()=>[i,(0,a.createVNode)(c,{modelValue:d.filtro.periodo.emissao.ini,"onUpdate:modelValue":o[6]||(o[6]=e=>d.filtro.periodo.emissao.ini=e),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){d.filtro.periodo.emissao.ini=""}}],dense:""},null,8,["modelValue","after"]),(0,a.createVNode)(c,{modelValue:d.filtro.periodo.emissao.fim,"onUpdate:modelValue":o[7]||(o[7]=e=>d.filtro.periodo.emissao.fim=e),tipo:"data",class:"no-shadow full-width",rotulo:"até",col:"12",after:[{icon:"mdi-close-circle",handler(){d.filtro.periodo.emissao.fim=""}}],dense:""},null,8,["modelValue","after"])])),_:1}),(0,a.createVNode)(u,{class:"q-col-gutter-md q-mt-md"},{default:(0,a.withCtx)((()=>[r,(0,a.createVNode)(c,{modelValue:d.filtro.periodo.finalizado.ini,"onUpdate:modelValue":o[8]||(o[8]=e=>d.filtro.periodo.finalizado.ini=e),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){d.filtro.periodo.finalizado.ini=""}}],dense:""},null,8,["modelValue","after"]),(0,a.createVNode)(c,{modelValue:d.filtro.periodo.finalizado.fim,"onUpdate:modelValue":o[9]||(o[9]=e=>d.filtro.periodo.finalizado.fim=e),tipo:"data",class:"no-shadow full-width",rotulo:"até",col:"12",after:[{icon:"mdi-close-circle",handler(){d.filtro.periodo.finalizado.fim=""}}],dense:""},null,8,["modelValue","after"])])),_:1})])),itemLista:(0,a.withCtx)((()=>[(0,a.createVNode)(f,{class:"rounded-borders"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(d.documentos,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:"itemHover fullWidth q-px-sm"},[(0,a.createVNode)(p,{id:e.id,ref:e.id,class:"q-mb-md"},null,8,["id"])])))),128))])),_:1})])),_:1},8,["onCriar_click","onCheckBoxGeral_click","onFiltro_change","onLimparFiltros_click","onAbrirTodosPreview","onExportarXLSX_click","onRemoverTodos","onRestaurarTodos","tabSelecionada","tabs","lista","listaLayout","paginacao","filtros","opcoesMarca","opcoesGrupo","opcoesSubGrupo","opcoesTipo","buscaCampo","checkboxModel"])]),(0,a.createVNode)(v,{modelValue:d.contatosModal,"onUpdate:modelValue":o[12]||(o[12]=e=>d.contatosModal=e),filtro:{ativo:!0},onSelecionar:n.aoSelecionarCliente},null,8,["modelValue","onSelecionar"]),(0,a.createVNode)(v,{modelValue:d.vendedorModal,"onUpdate:modelValue":o[13]||(o[13]=e=>d.vendedorModal=e),filtro:{ativo:!0,vendedores:!0},onSelecionar:e.aoSelecionarVendedor},null,8,["modelValue","onSelecionar"]),(0,a.createVNode)(v,{modelValue:d.digitadorModal,"onUpdate:modelValue":o[14]||(o[14]=e=>d.digitadorModal=e),filtro:{ativo:!0},onSelecionar:e.aoSelecionarDigitador},null,8,["modelValue","onSelecionar"]),(0,a.createVNode)(g,{ref:"modalVenda",onExecutar:e.executar},null,8,["onExecutar"])],64)}]]);C()(p,"components",{QChip:h.Z,QSelect:v.Z,QList:g.Z})},91226:(e,o,t)=>{t.r(o),t.d(o,{default:()=>U});var a=t(34182);const i={class:"row no-wrap q-pa-md"},r={class:"column"},l=(0,a.createElementVNode)("div",{class:"text-h6 q-mb-md"},"Sincronismo RoutEasy",-1),d=(0,a.createTextVNode)("Enviar todos da Tela"),n=(0,a.createTextVNode)("Acessar Painel"),s={class:"column items-center",style:{"margin-bottom":"0px"}},c=(0,a.createElementVNode)("div",{class:"text-h6 q-mb-md"},"Importar Roterização",-1),m={class:"q-mt-sm"},u=(0,a.createElementVNode)("span",{class:"col-12 text-body1 text-dark"},"Período de Emissão",-1),p=(0,a.createElementVNode)("span",{class:"col-12 text-body1 text-dark"},"Período de Finalização",-1),f=["onClick"];var h=t(98107),v=t(65923),g=(t(80446),t(30052)),V=t.n(g),C=t(84830),w=t.n(C),N=t(58294),x=t(6791),b=t(88603);t(60357);const y={alterados:0,arquivo:null,cor:"text-negative",corFinal:"",erro:"",erros:0,incluidos:0,listaErros:[],mensagem:"",mensagemFinal:"",modalResultado:!1},k={components:{lista:h.Z,VendaCard:v.Z},data(){let e=new Date(new Date($utils.dataAtual()).toDateString());return{tabSelecionada:{valor:"Todas"},importar:$utils.clonarV2(y),opcoesStatus:[{rotulo:"Faturado",valor:"Faturado"},{rotulo:"Em Separação",valor:"Em Separação"},{rotulo:"Aguardando Separação",valor:"Aguardando Separação"},{rotulo:"Orçamento",valor:"Orçamento"},{rotulo:"Aguardando Estoque",valor:"Aguardando Estoque"},{rotulo:"Não Aprovado",valor:"Não Aprovado"}],tabs:[{rotulo:"Aguardando Faturamento",value:"Aguardando Faturamento"},{rotulo:"Faturado",value:"Faturado"},{rotulo:"Orçamento",value:"Orçamento"},{rotulo:"Aguardando Liberação",value:"Aguardando Liberação"},{rotulo:"Não Aprovado",value:"Não Aprovado"},{rotulo:"Todas",value:"Todas"}],page:{digitacao:{current:1,min:0,max:0},finalizado:{current:1,min:0,max:0},ativa:"Digitação"},entregueInicio:new Date(new Date($utils.dataAtual()).toDateString()),entregueFim:new Date(new Date($utils.dataAtual()).toDateString()),status:[],operacoes:[],pageSize:10,grupos:[],buscaCampo:"",empresas:[],empresa:{},contatosModal:!1,vendedorModal:!1,digitadorModal:!1,filtro:{status:"Faturado",operacao:"",grupos:[],empresa:{id:""},cliente:{id:""},vendedor:{id:""},digitador:{id:""},periodo:{emissao:{ini:e,fim:e},finalizado:{ini:"",fim:""}}},paginacao:{atual:1,maximo:1,total:1,limite:25},dbContato:x.db.contato,documentos:null,showFilters:!1,itens:[],documentoItens:[],vendedorDigitadorSelecionado:null,vendedoresDigitadoresOpcoes:[],diretivaContatosAcessaTodosContatos:!1,showAllPreviewDetail:!1,lista:[]}},methods:{async prepareFile(e){try{const t=await(o=e[0],new Promise(((e,t)=>{const a=new FileReader;a.readAsBinaryString(o),a.onload=()=>e(a.result),a.onerror=e=>t(e)})));return console.log("binaryString => ",t),await this.importarArquivo(t),this.$q.notify({type:"positive",message:"Importação realizada com sucesso"}),!0}catch(e){this.importar.erro="Ocorreu erro ao importar roterização",this.$q.notifyError(this.importar.erro,e)}var o},async importarArquivo(e){try{this.importar.modalResultado=!0,this.importar.mensagem="Carregando o arquivo .xlsx";let o=w().read(e,{type:"binary"}),t=w().utils.sheet_to_json(o.Sheets[Object.keys(o.Sheets)[0]],{header:1});console.log("arrData => ",t)}catch(e){e.name&&"ErroValidacao"===e.name?(this.importar.erro=e.message,this.$q.notifyError(e.message,e)):(this.importar.erro="Ocorreu erro ao importar roterização xlsx",this.$q.notifyError(this.importar.erro,e))}},async importarCallbackErro(e,o){this.importar.erros++,this.importar.listaErros.push({linha:e,mensagem:o})},async importarCallbackFinal(e){this.importar.incluidos+this.importar.alterados>0?this.importar.erros>0?(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importação realizada parcialmente!"):(this.importar.corFinal="bg-positive text-white",this.importar.mensagemFinal="Importação concluída com sucesso!"):this.importar.erros>0?(this.importar.corFinal="text-negative",this.importar.mensagemFinal="Importação não realizada!"):(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importação não realizada!")},limparFiltros_click(){},getInfosFromRouteEasy(){const e=window.location.search,o=new URLSearchParams(e);o.get("resultadoRoteirizacao"),o.get("coletorPedidos"),console.log(o.entries(),e)},async getGeoCordenadas(e){const o=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${e.municipio}+${e.uf}+${e.logradouro}+${e.cep}&key=AIzaSyDXlwwrHCnEP50L1rFQvrYq9XAzpU_hZvA`,{method:"GET"});return(await o.json()).results[0].geometry},async calcularPesoTotal(e,o){if(!e||!o)return!1;const t=await $erp().documento.where({idFatura:e}).toArray(),a=[],i={};let r=0,l=0;for(const e of t){const e=await $erp().documentoItem.where({idDocumento:o}).toArray();for(const o of e)a.push(o)}for(const e of a)if(-1===e.operacaoFator){if(e.idItem&&!i[e.idItem]){const o=await $erp().item.get(e.idItem);o&&(i[e.idItem]=o)}r+=(i[e.idItem]?.peso||0)*(e.quantidade||0),l+=(i[e.idItem]?.pesoBruto||0)*(e.quantidade||0)}return r=$utils.arredondar(r,4),l=$utils.arredondar(l,4),{pesoTotal:r,pesoBrutoTotal:l}},async calcularMetroCubicoTotal(e,o){if(!e||!o)return!1;const t=await $erp().documento.where({idFatura:e}).toArray(),a=[],i={};let r=0;for(const e of t){const e=await $erp().documentoItem.where({idDocumento:o}).toArray();for(const o of e)a.push(o)}for(const e of a){if(-1!==e.operacaoFator||"Produto"!==e.tipoItem)continue;if(e.idItem&&!i[e.idItem]){const o=await $erp().item.get(e.idItem);o&&(i[e.idItem]=o)}const o=i[e.idItem]?.altura*i[e.idItem]?.largura*i[e.idItem]?.comprimento||0,t=e.quantidade||0;r+=o>0?o*t:0}return r=$utils.arredondar(r,4),{metroCubicoTotal:r}},async sendRouteEasyAll(){$q.loading.show();try{await this.sendRouteEasy(this.documentos,!0),$q.notify({message:"Sincronismo efetuado com sucesso!",type:"positive"})}catch(e){console.log(e)}finally{$q.loading.hide()}},async sendRouteEasy(e,o=!1){o||$q.loading.show();let t={deliveries:[]},a=[];try{for(let o=0;o<e.length;o++){const i=e[o],r=i.venda;let l=await $db.contatoEndereco.le({idContato:r.idContato});if(0===l.length&&($q.notify(`Não foi possivel envia venda #ID[${r.id}], pois não foi vinculado um endereço.`),console.log(`Não foi possivel envia venda #ID[${r.id}], pois não foi vinculado um endereço.`)),!i.rota&&r&&r.idContato&&l.length>0){let e=await $db.contato.le({id:r.idContato}),d=await $db.contatoTelefone.le({idContato:e.id}),n=i.fatura,s=await x.db.documentoFiscalEletronico.le({idDocumento:r.idFatura});await $db.documento.le({id:this.idDocumentoCaixa}),$utils.dataAtual(),l=l[0];let c=await this.getGeoCordenadas(l),m=await this.calcularPesoTotal(n.id,r.id),u=await this.calcularMetroCubicoTotal(n.id,r.id),p=m.pesoTotal?m.pesoTotal:"",f=u.metroCubicoTotal?u.metroCubicoTotal:"",h={code:r.idContato,name:r.descricaoContato,order_number:r.numero,invoice_number:s.length>0?s[0].chNFe:"",loads:[p,f],email:e.email,customer_profile:e.id,phone:d.length>0?d[0].telefone:"",address:{route:l.logradouro,street_number:l.numero?l.numero:"",neighborhood:l.bairro,city:l.municipio,state:l.uf,postal_code:l.cep,country:l.pais,geocode:{lat:c.location.lat,lng:c.location.lng}}};t.deliveries.push(h),a[t.deliveries.length-1]=o}}if(t.deliveries.length>0){const o=await V()({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},baseURL:"https://company.routeasy.com.br",url:"/group?api_key=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxNDIwYWQ2YzRiNTYzMWEyMmQwYTZhZSIsInRpbWVzdGFtcCI6MTYzMjQ5NTY1ODE1OH0.Nodh7i5OjMak8PQaavO8yComhN6BJa7bPs37SKfe4rE",validateStatus:e=>e>=200&&e<=500,timeout:3e4,data:t});for(let t=0;t<o.data.deliveries.length;t++){const i=o.data.deliveries[t];let r=$utils.dataAtual(),l=r.split("T")[0].split("-"),d=`Rota do dia ${l[2]}/${l[1]}/${l[0]}`,n={id:$utils.uuid(),documentoId:e[a[t]].venda.id,tipo:"ROTARE",statusOriginal:e[a[t]].fatura.status,dataHoraEmissao:r,idUsuarioAlterou:$db.usuario.logado.id,rotaJson:JSON.stringify({envio:i}),rotaStatus:"Enviado",rotaNome:d};1===e.length&&(e[t].rota=n),await $db.documento.grava({atual:n})}e.length>1&&await this.atualizar(),$q.notify({message:"Rota(s) enviada(s) com sucesso!",type:"positive"})}else $q.notify("Rota(s) já enviadas ou nao tem informações suficientes.")}catch(e){$q.notify(e.message),console.log("[ERROR][SINCRONSMO][ROUTEASY] => ",e)}finally{o||$q.loading.hide()}},async filtrar(){try{this.empresas=await x.db.empresa.le();let e=[];const o=await x.db.venda.leRefatorado({filtros:{periodoEmissao:{ini:this.filtro.periodo.emissao.ini,fim:this.filtro.periodo.emissao.fim},periodoFinalizado:{ini:this.filtro.periodo.finalizado.ini,fim:this.filtro.periodo.finalizado.fim},status:this.filtro.status,operacao:this.filtro.operacao,idEmpresa:this.filtro.empresa.id,idContato:this.filtro.cliente.id,idContatoVendedor:this.filtro.vendedor.id,idContatoDigitador:this.filtro.digitador.id},termoBusca:this.buscaCampo,limit:this.paginacao.limite,page:this.paginacao.atual,sort:""});e=o.data,this.paginacao.total=o.total,this.paginacao.maximo=o.totalPages;let t=[];for(const o of e){const e=await x.db.documentoItem.leNew({idDocumento:o.id});o.fatura=await $db.fatura.leCompleto(o.idFatura)||null,o.rota=await $db.documento.le({documentoId:o.id,tipo:"ROTARE"})||null,o.rota=o.rota[0]?o.rota[0]:null,o.rota&&(o.rota.rotaObj=JSON.parse(o.rota.RotaJson)),o.venda={...o},t=[...t,...e.filter((e=>e.idItem))]}let a=[];for(const e of t)if(e.idItem&&!a.filter((o=>o.id===e.idItem)).length){const o=await x.db.item.leNew({id:e.idItem});a.push(o)}this.documentos=e}catch(e){console.log(e),this.$q.notify("Erro ao filtrar")}},acessarPainel(){window.open("https://company.routeasy.com.br/#!/routings/create","_blank").focus()},aoSelecionarEmpresa(){this.filtro.empresa=this.empresas.filter((e=>e.id===this.empresa.id))[0]},aoSelecionarCliente(e,o){e&&(this.filtro.cliente=(0,N.clonarV2)(o),this.contatosModal=!1)},adicionarVenda(){this.$refs.modalVenda.mostrar()},async buscar(){let e=await x.db.venda.leNew(),o=[];for(const t of e){const e=await x.db.documentoItem.leNew({idDocumento:t.id});o=[...o,...e.filter((e=>e.idItem))]}let t=[],a={};for(const e of o)if(e.idItem&&!t.filter((o=>o.id===e.idItem)).length){const o=await x.db.item.leNew({id:e.idItem});t.push(o)}const i=[(0,N.removerAcentos)(this.buscaCampo)];let r=e.filter((e=>{if(!e.numero)return!1;const o=String(e.numero);for(const e of i){const t=new RegExp(e,"gi");if(o.match(t))return!0}})),l=[],d=o.filter((e=>{if(!e.idItem&&!e.descricaoItem)return!1;const o=(0,N.removerAcentos)(e.descricaoItem);for(const t of i){const a=new RegExp(t,"gi");if(o.match(a))return l.push(e.id),!0}}));a=t.filter((e=>{const o=e.marca||"",t=e.referencia||"",a=e.codigoItem?String(e.codigoItem):"",r=e.codigoBarras||"",l=(0,N.removerAcentos)(o+t+a+r);for(const e of i){const o=new RegExp(e,"gi");if(l.match(o))return!0}}));for(const e of r){const t=o.filter((o=>{if(o.idItem&&o.idDocumento===e.id&&!l.includes(o.id))return l.push(o.id),!0}));d=[...d,...t]}for(const e of a){const t=o.filter((o=>{if(o.idItem===e.id&&!l.includes(o.id))return l.push(o.id),!0}));d=[...d,...t]}d=d.filter((o=>{let a=(0,N.clonarV2)(i),r=e.filter((e=>e.id===o.idDocumento)),l=t.filter((e=>e.id===o.idItem));r=r.length?r[0]:{},l=l.length?l[0]:{};let d=r.numero?String(r.numero):"";if(d+=o.descricaoItem||"",d+=l.marca||"",d+=l.referencia||"",d+=l.codigoItem?String(l.codigoItem):"",d+=l.codigoBarras||"",d)for(const e of i){const o=new RegExp(e,"gi");d.match(o)&&(a=a.filter((o=>o!==e)))}if(!a.length)return!0}));let n=[];r=[],a={};for(const o of d)if(n.includes(o.idDocumento)||(n.push(o.idDocumento),r=[...r,...e.filter((e=>e.id===o.idDocumento))]),!a[o.idItem]){const e=t.filter((e=>e.id===o.idItem));e.length&&(a[o.idItem]=e[0])}e=(0,b.orderBy)(r,["dataHoraFinalizado","dataHoraEmissao"],["desc","desc"]),this.documentos=r.reduce(((e,o)=>(e[o.id]||(e[o.id]=o),e)),{}),this.itens=a,this.documentosItens=(0,b.orderBy)(d,["dataHoraFinalizado","dataHoraEmissao"],["desc","desc"])},async abrirEdicao(e){console.log(e);let o=await x.db.venda.leCompleto({codigoDocumento:e.codigoDocumento});console.log({leCompleto:o})},filtraDebounce(){(0,b.debounce)(this.refazFiltro,700)()},refazFiltro(){N.gconsole.log("FunilVendas","refazFiltro()",this.fraseFiltro,this.empresaSelecionada);const e=(0,N.removerAcentos)((this.fraseFiltro||"").toUpperCase()).split(" ").filter((e=>""!==e)),o={};for(const t in this.listas)for(const a of this.listas[t]){const t=(0,N.removerAcentos)((a.id||"").toUpperCase()+(a.nomeCliente||"").toUpperCase()+(a.nomeDigitador||"").toUpperCase()+(a.nomeVendedor||"").toUpperCase()+" "+String(a.numeroVenda||"")+" ");let i=!0;for(const o of e)i=isNaN(Number(o))?i&&t.includes(o):i&&t.includes(" "+o+" ");this.empresaSelecionada&&(i=i&&this.empresaSelecionada===a.codigoEmpresa),this.vendedorDigitadorSelecionado&&(i=i&&(this.vendedorDigitadorSelecionado.value===a.codigoContatoDigitador||this.vendedorDigitadorSelecionado.value===a.codigoContatoVendedor)),a.mostra=i,a.mostra&&(o[a.crmFunilStatus]=(o[a.crmFunilStatus]||0)+(a.totalDocumento||0))}this.total=o},async atualizar(){try{$q.loading.show(),null!==this.vendedorDigitadorSelecionado&&(this.filtro.vendedor.id=this.vendedorDigitadorSelecionado.value),await this.filtrar()}catch(e){$q.notifyError("Erro iniciar",e)}finally{$q.loading.hide()}},abrirTodosPreview(){this.showAllPreviewDetail=!this.showAllPreviewDetail;for(let e of this.documentos)this.$refs[e.id].detalhesVisivel=this.showAllPreviewDetail},debug(e){console.log(e)}},watch:{},created(){N.gconsole.log("FunilVendas","created()"),$db.permissao.objeto("Diretiva_RelatorioVenda_VerTodos").then((e=>{this.diretivaContatosAcessaTodosContatos=e,this.diretivaContatosAcessaTodosContatos&&(this.vendedoresDigitadoresOpcoes=[],$db.crm.leOnlineVendedoresDigitadores({entregueInicio:this.entregueInicio,entregueFim:this.entregueFim}).then((e=>{e.forEach((e=>{e.codigo&&this.vendedoresDigitadoresOpcoes.push({label:e.nome,value:e.codigo})}))})))})),this.atualizar()},refazFiltro(){$utils.gconsole.log("FunilVendas","refazFiltro()",this.fraseFiltro,this.empresaSelecionada);const e=$utils.removerAcentos((this.fraseFiltro||"").toUpperCase()).split(" ").filter((e=>""!==e)),o={};for(const t in this.listas)for(const a of this.listas[t]){const t=$utils.removerAcentos((a.id||"").toUpperCase()+(a.nomeCliente||"").toUpperCase()+(a.nomeDigitador||"").toUpperCase()+(a.nomeVendedor||"").toUpperCase()+" "+String(a.numeroVenda||"")+" ");let i=!0;for(const o of e)i=isNaN(Number(o))?i&&t.includes(o):i&&t.includes(" "+o+" ");this.empresaSelecionada&&(i=i&&this.empresaSelecionada.value===a.codigoEmpresa),this.vendedorDigitadorSelecionado&&(i=i&&(this.vendedorDigitadorSelecionado.value===a.codigoContatoDigitador||this.vendedorDigitadorSelecionado.value===a.codigoContatoVendedor)),a.mostra=i,a.mostra&&(o[a.crmFunilStatus]=(o[a.crmFunilStatus]||0)+(a.totalDocumento||0))}const t={};for(const e in this.listas)this.tamanhoLista[e]=10,t[e]=this.listas[e].filter((e=>e.mostra)).slice(0,this.tamanhoLista[e]),document.getElementById(e);this.listasFiltradas=t,this.$nextTick((()=>{for(const e in this.listasFiltradas)document.getElementById(e).removeEventListener("scroll",this.scrollHandler),document.getElementById(e).addEventListener("scroll",this.scrollHandler)})),this.total=o},mounted(){this.getInfosFromRouteEasy()}};var D=t(74260),E=t(54707),S=t(25901),F=t(77953),_=t(60880),I=t(68900),T=t(83831),q=t(56673),$=t(67280),A=t(40320),B=t(98586),z=t(7518),R=t.n(z);const U=(0,D.Z)(k,[["render",function(e,o,t,h,v,g){const V=(0,a.resolveComponent)("q-icon"),C=(0,a.resolveComponent)("q-item-section"),w=(0,a.resolveComponent)("q-item"),N=(0,a.resolveComponent)("q-list"),x=(0,a.resolveComponent)("q-separator"),b=(0,a.resolveComponent)("q-uploader"),y=(0,a.resolveComponent)("q-menu"),k=(0,a.resolveComponent)("q-chips-input"),D=(0,a.resolveComponent)("campo"),E=(0,a.resolveComponent)("row"),S=(0,a.resolveComponent)("venda-card"),F=(0,a.resolveComponent)("lista"),_=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(F,{titulo:"Vendas",onCriar_click:g.adicionarVenda,icone:"mdi-cart-arrow-up",onFiltro_change:g.atualizar,onLimparFiltros_click:g.limparFiltros_click,onAbrirTodosPreview:g.abrirTodosPreview,tabSelecionada:v.tabSelecionada,tabs:v.tabs,lista:v.lista,paginacao:v.paginacao,permissaoExtrasV2:!0,permissaoExtras:!1,filtros:v.filtro,exportarXLSXVisible:!1,permissaoFicha:!1,buscaCampo:v.buscaCampo,"onUpdate:buscaCampo":o[12]||(o[12]=e=>v.buscaCampo=e)},{menuExtras:(0,a.withCtx)((()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("div",r,[l,(0,a.createVNode)(N,{link:"","no-border":"",separator:""},{default:(0,a.withCtx)((()=>["function"==typeof g.sendRouteEasyAll?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(w,{key:0,clickable:"",onClick:o[0]||(o[0]=e=>g.sendRouteEasyAll())},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{name:"upgrade"})])),_:1}),(0,a.createVNode)(C,null,{default:(0,a.withCtx)((()=>[d])),_:1})])),_:1},512)),[[_]]):(0,a.createCommentVNode)("",!0),"function"==typeof g.acessarPainel?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(w,{key:1,clickable:"",onClick:o[1]||(o[1]=e=>g.acessarPainel())},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{name:"insights"})])),_:1}),(0,a.createVNode)(C,null,{default:(0,a.withCtx)((()=>[n])),_:1})])),_:1},512)),[[_]]):(0,a.createCommentVNode)("",!0)])),_:1})]),(0,a.createVNode)(x,{vertical:"",inset:"",class:"q-mx-lg"}),(0,a.createElementVNode)("div",s,[c,(0,a.createElementVNode)("div",m,[(0,a.createVNode)(b,{style:{width:"100%"},label:"Selecione o arquivo (.xlsx)","hide-upload-btn":"","auto-upload":"",factory:g.prepareFile},null,8,["factory"])])])])])),_:1})])),filtroCampos:(0,a.withCtx)((()=>[(0,a.createVNode)(k,{modelValue:v.filtro.grupos,"onUpdate:modelValue":o[2]||(o[2]=e=>v.filtro.grupos=e),color:"tertiary",class:"col-12",placeholder:"Filtre por Produto, Marca, Número..."},null,8,["modelValue","placeholder"]),(0,a.createVNode)(D,{tipo:"seletor",modelValue:v.filtro.status,"onUpdate:modelValue":o[3]||(o[3]=e=>v.filtro.status=e),dense:"",opcoes:v.opcoesStatus,clearable:"",rotulo:"Status Venda"},null,8,["modelValue","opcoes"]),(0,a.createVNode)(D,{tipo:"seletor",dense:"",modelValue:v.empresa.id,"onUpdate:modelValue":[o[4]||(o[4]=e=>v.empresa.id=e),g.aoSelecionarEmpresa],options:v.empresas.map((e=>({label:e.nome,value:e.id}))),clearable:"",rotulo:"Por empresa"},null,8,["modelValue","options","onUpdate:modelValue"]),(0,a.createVNode)(D,{tipo:"seletor",dense:"",modelValue:v.filtro.operacao,"onUpdate:modelValue":o[5]||(o[5]=e=>v.filtro.operacao=e),options:v.operacoes.map((e=>({label:e,value:e}))),clearable:"",rotulo:"Operação"},null,8,["modelValue","options"]),(0,a.createVNode)(D,{rotulo:"Cliente",tipo:"texto",before:[{icon:"search"}],modelValue:v.filtro.cliente.nome,"onUpdate:modelValue":[o[6]||(o[6]=e=>v.filtro.cliente.nome=e),g.aoSelecionarCliente],onClick:o[7]||(o[7]=e=>v.contatosModal=!0),dense:""},null,8,["modelValue","onUpdate:modelValue"]),(0,a.createVNode)(E,{class:"q-col-gutter-md q-mt-md"},{default:(0,a.withCtx)((()=>[u,(0,a.createVNode)(D,{modelValue:v.filtro.periodo.emissao.ini,"onUpdate:modelValue":o[8]||(o[8]=e=>v.filtro.periodo.emissao.ini=e),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){v.filtro.periodo.emissao.ini=""}}],dense:""},null,8,["modelValue","after"]),(0,a.createVNode)(D,{modelValue:v.filtro.periodo.emissao.fim,"onUpdate:modelValue":o[9]||(o[9]=e=>v.filtro.periodo.emissao.fim=e),tipo:"data",class:"no-shadow full-width",rotulo:"até",col:"12",after:[{icon:"mdi-close-circle",handler(){v.filtro.periodo.emissao.fim=""}}],dense:""},null,8,["modelValue","after"])])),_:1}),(0,a.createVNode)(E,{class:"q-col-gutter-md q-mt-md"},{default:(0,a.withCtx)((()=>[p,(0,a.createVNode)(D,{modelValue:v.filtro.periodo.finalizado.ini,"onUpdate:modelValue":o[10]||(o[10]=e=>v.filtro.periodo.finalizado.ini=e),tipo:"data",class:"no-shadow full-width",rotulo:"De",col:"12",after:[{icon:"mdi-close-circle",handler(){v.filtro.periodo.finalizado.ini=""}}],dense:""},null,8,["modelValue","after"]),(0,a.createVNode)(D,{modelValue:v.filtro.periodo.finalizado.fim,"onUpdate:modelValue":o[11]||(o[11]=e=>v.filtro.periodo.finalizado.fim=e),tipo:"data",class:"no-shadow full-width",rotulo:"até",col:"12",after:[{icon:"mdi-close-circle",handler(){v.filtro.periodo.finalizado.fim=""}}],dense:""},null,8,["modelValue","after"])])),_:1})])),itemLista:(0,a.withCtx)((()=>[(0,a.createVNode)(N,{class:"rounded-borders"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(v.documentos,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:"itemHover fullWidth q-px-sm",onClick:o=>g.debug(e)},[(0,a.createVNode)(S,{sendRouteEasy:g.sendRouteEasy,id:e.id,ref:e.id,class:"q-mb-md"},null,8,["sendRouteEasy","id"])],8,f)))),128))])),_:1})])),_:1},8,["onCriar_click","onFiltro_change","onLimparFiltros_click","onAbrirTodosPreview","tabSelecionada","tabs","lista","paginacao","filtros","buscaCampo"])])}]]);R()(k,"components",{QMenu:E.Z,QList:S.Z,QItem:F.Z,QItemSection:_.Z,QIcon:I.Z,QSeparator:T.Z,QUploader:q.Z,QChip:$.Z,QSelect:A.Z}),R()(k,"directives",{ClosePopup:B.Z})}}]);