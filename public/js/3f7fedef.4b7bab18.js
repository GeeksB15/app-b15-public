(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["3f7fedef"],{"0dd6":function(t,e,o){"use strict";o("96cf");var a=o("c973"),s=o.n(a),i=o("ed08");e["a"]={methods:{desejaDescartar:function(){var t=s()(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i["gconsole"].log("beforeRouteLeave","desejaDescartar()"),!this.verificarSePodeAlterar||this.verificarSePodeAlterar()){t.next=3;break}return t.abrupt("return",!0);case 3:if(e="function"===typeof this.verificarSeAlterouCampos?this.verificarSeAlterouCampos():this.verificarSeAlterouCampos,e){t.next=6;break}return t.abrupt("return",!0);case 6:return t.prev=6,t.next=9,this.$q.dialog({cancel:!0,message:"Deseja descartar suas modificações?",ok:"Descartar",title:"Atenção!"});case 9:return t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t["catch"](6),t.abrupt("return",!1);case 15:case"end":return t.stop()}},t,this,[[6,12]])}));return function(){return t.apply(this,arguments)}}()},beforeRouteLeave:function(){var t=s()(regeneratorRuntime.mark(function t(e,o,a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i["gconsole"].log("beforeRouteLeave"),t.t0=a,t.next=4,this.desejaDescartar();case 4:t.t1=t.sent,(0,t.t0)(t.t1);case 6:case"end":return t.stop()}},t,this)}));return function(e,o,a){return t.apply(this,arguments)}}()}},2845:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("q-card",{staticClass:"no-shadow"},[t._l(t.estoquePorEmpresa,function(e){return o("div",{key:e.idEmpresa,staticClass:"row gutter-x-sm bg-white q-px-md q-py-lg"},[o("q-toolbar-title",{staticClass:"col-12"},[t._v(t._s(e.nomeEmpresa))]),o("q-list",{staticClass:"col-12 no-border q-ml-sm"},[o("q-item",{staticClass:"q-pl-none"},[o("q-item-main",[o("q-item-tile",{attrs:{sublabel:""}},[o("div",{staticClass:"row text-weight-bold text-right justify-around"},[o("div",{staticClass:"col-2 text-center"},[t._v("Tipo estoque")]),o("div",{staticClass:"col-2 text-center"},[t._v("Lote")]),o("div",{staticClass:"col-2"},[t._v("Saldo")]),o("div",{staticClass:"col-2"},[t._v("Custo Médio")]),o("div",{staticClass:"col-2"},[t._v("Custo Real")]),o("div",{staticClass:"col-2"},[t._v("Custo Anterior")])])]),o("q-item-separator",{staticClass:"q-my-xs"}),t._l(e.estoquePorLote,function(e,a){return o("div",{key:a},[o("q-item-tile",{attrs:{sublabel:""}},[o("div",{staticClass:"row text-right justify-around"},[o("div",{staticClass:"col-2 text-center"},[t._v(t._s(e.tipoEstoque||"-"))]),o("div",{staticClass:"col-2 text-center"},[t._v(t._s(e.loteEmpresa||"-"))]),o("div",{staticClass:"col-2"},[t._v(t._s(t._f("numero")(e.saldo,2)))]),o("div",{staticClass:"col-2"},[t._v(t._s(t._f("numero")(e.valorCustoMedio,2)))]),o("div",{staticClass:"col-2"},[t._v(t._s(t._f("numero")(e.valorCusto,2)))]),o("div",{staticClass:"col-2"},[t._v(t._s(t._f("numero")(e.valorCustoAnterior,2)))])])]),o("q-item-separator",{staticClass:"q-my-xs"}),o("q-item-tile",{attrs:{sublabel:""}})],1)})],2)],1)],1)],1)}),0===t.estoquePorEmpresa.length?o("div",{staticClass:"row gutter-x-sm bg-white q-px-md q-py-lg"},[o("q-toolbar-title",{staticClass:"col-12"},[t._v("Sem informações de estoque")]),o("q-list",{staticClass:"col-12 no-border q-ml-sm"},[o("q-item",{staticClass:"q-pl-none"},[o("q-item-main",[o("q-item-tile",{attrs:{sublabel:""}},[o("div",{staticClass:"row text-weight-bold text-right justify-around"},[o("div",{staticClass:"col-2 text-center"},[t._v("Tipo estoque")]),o("div",{staticClass:"col-2 text-center"},[t._v("Lote")]),o("div",{staticClass:"col-2"},[t._v("Saldo")]),o("div",{staticClass:"col-2"},[t._v("Custo Médio")]),o("div",{staticClass:"col-2"},[t._v("Custo Real")]),o("div",{staticClass:"col-2"},[t._v("Custo Anterior")])])]),o("q-item-separator",{staticClass:"q-my-xs"}),o("div",[o("q-item-tile",{attrs:{sublabel:""}},[o("div",{staticClass:"row text-right justify-around"},[o("div",{staticClass:"col-2 text-center"},[t._v("-")]),o("div",{staticClass:"col-2 text-center"},[t._v("-")]),o("div",{staticClass:"col-2"},[t._v("-")]),o("div",{staticClass:"col-2"},[t._v("-")]),o("div",{staticClass:"col-2"},[t._v("-")]),o("div",{staticClass:"col-2"},[t._v("-")])])]),o("q-item-separator",{staticClass:"q-my-xs"}),o("q-item-tile",{attrs:{sublabel:""}})],1)],1)],1)],1)],1):t._e()],2),t.campos.ativo&&t.permissaoFicha?o("q-card",{staticClass:"bg-white gutter-x-md q-my-md q-px-md q-py-md no-shadow"},[o("q-toolbar-title",{staticClass:"row q-mb-sm"},[t._v("Parâmetros")]),o("form",{on:{submit:function(e){return e.preventDefault(),t.salvarItem(e)}}},[o("div",{staticClass:"row gutter-x-md q-mb-sm q-ml-sm"},[o("campo",t._b({staticClass:"col-6 col-md-3",attrs:{opcoes:{decimalPlaces:4}},model:{value:t.campos.quantidadeMinimaEstoque,callback:function(e){t.$set(t.campos,"quantidadeMinimaEstoque",e)},expression:"campos.quantidadeMinimaEstoque"}},"campo",t.meta.quantidadeMinimaEstoque,!1)),o("campo",t._b({staticClass:"col-6 col-md-3",attrs:{opcoes:{decimalPlaces:4}},model:{value:t.campos.quantidadeMinimaCompra,callback:function(e){t.$set(t.campos,"quantidadeMinimaCompra",e)},expression:"campos.quantidadeMinimaCompra"}},"campo",t.meta.quantidadeMinimaCompra,!1)),o("campo",t._b({staticClass:"col-6 col-md-3",model:{value:t.campos.tempoMedioReposicao,callback:function(e){t.$set(t.campos,"tempoMedioReposicao",e)},expression:"campos.tempoMedioReposicao"}},"campo",t.meta.tempoMedioReposicao,!1)),o("campo",t._b({staticClass:"col-6 col-md-3",model:{value:t.campos.consumoMedio,callback:function(e){t.$set(t.campos,"consumoMedio",e)},expression:"campos.consumoMedio"}},"campo",t.meta.consumoMedio,!1)),o("campo",t._b({staticClass:"col-6 col-md-3",model:{value:t.campos.local,callback:function(e){t.$set(t.campos,"local",e)},expression:"campos.local"}},"campo",t.meta.local,!1))],1),o("div",{staticClass:"row justify-end"},[o("q-btn",{staticClass:"no-shadow",attrs:{color:"primary",label:"Salvar",type:"submit"}})],1)])],1):t._e(),t.campos.ativo&&t.permissaoAjusteEstoque?o("q-card",{staticClass:"bg-white gutter-x-md q-my-md q-px-md q-py-md no-shadow"},[o("q-toolbar-title",{staticClass:"row q-mb-sm"},[t._v("Ajuste")]),o("form",{on:{submit:function(e){return e.preventDefault(),t.ajustarEstoque(e)}}},[o("div",{staticClass:"row gutter-x-md q-mb-sm q-ml-sm items-baseline"},[o("campo",t._b({staticClass:"col-12",attrs:{opcoes:t.opcoesEmpresa},model:{value:t.codigoEmpresaSelecionada,callback:function(e){t.codigoEmpresaSelecionada=e},expression:"codigoEmpresaSelecionada"}},"campo",t.meta.nomeEmpresa,!1))],1),o("div",{staticClass:"row gutter-x-md q-mb-sm q-ml-sm items-baseline"},[o("campo",t._b({staticClass:"col-6 col-md-3",model:{value:t.ajuste.lote,callback:function(e){t.$set(t.ajuste,"lote","string"===typeof e?e.trim():e)},expression:"ajuste.lote"}},"campo",t.meta.lote,!1)),o("campo",{staticClass:"col-6 col-md-3",attrs:{format:"DD/MM/YYYY HH:mm",rotulo:"Data",tipo:"dataHora",disable:t.ajusteDataSomenteLeitura},model:{value:t.ajuste.data,callback:function(e){t.$set(t.ajuste,"data",e)},expression:"ajuste.data"}}),o("campo",t._b({staticClass:"col-6 col-md-3",attrs:{erro:t.$v.ajuste.custoDesejado.$error},on:{blur:t.$v.ajuste.custoDesejado.$touch},model:{value:t.ajuste.custoDesejado,callback:function(e){t.$set(t.ajuste,"custoDesejado",e)},expression:"ajuste.custoDesejado"}},"campo",t.meta.custoDesejado,!1))],1),o("div",{staticClass:"row gutter-x-md q-mb-sm q-ml-sm items-baseline"},[o("campo",t._b({staticClass:"col-12 col-md-3",attrs:{opcoes:t.opcoesPlanoConta,erro:t.$v.ajuste.planoConta.$error},on:{blur:t.$v.ajuste.planoConta.$touch},model:{value:t.ajuste.planoConta,callback:function(e){t.$set(t.ajuste,"planoConta",e)},expression:"ajuste.planoConta"}},"campo",t.meta.planoConta,!1)),"0"===t.ajuste.planoConta?[o("campo",{staticClass:"col-12 col-md-3",attrs:{filter:"",erroRotulo:"Obrigatório",rotuloFixo:"Conta estoque",tipo:"seletor",opcoes:t.opcoesConta,erro:t.$v.ajuste.planoContaEstoque.$error},on:{blur:t.$v.ajuste.planoContaEstoque.$touch},model:{value:t.ajuste.planoContaEstoque,callback:function(e){t.$set(t.ajuste,"planoContaEstoque",e)},expression:"ajuste.planoContaEstoque"}}),o("campo",{staticClass:"col-12 col-md-3",attrs:{filter:"",erroRotulo:"Obrigatório",rotuloFixo:"Conta movimento",tipo:"seletor",opcoes:t.opcoesConta,erro:t.$v.ajuste.planoContaMovimento.$error},on:{blur:t.$v.ajuste.planoContaMovimento.$touch},model:{value:t.ajuste.planoContaMovimento,callback:function(e){t.$set(t.ajuste,"planoContaMovimento",e)},expression:"ajuste.planoContaMovimento"}})]:t._e()],2),o("div",{staticClass:"row items-center gutter-x-md q-mb-sm q-ml-sm"},[o("div",{staticClass:"col-6 col-md-3"},[o("div",{staticClass:"row q-caption text-faded"},[t._v("Saldo atual")]),o("div",{staticClass:"row q-py-xs"},[o("div",{staticClass:"col-11 text-faded"},[t._v(t._s(t._f("numero")(t.ajuste.qtdeMomento,4)))]),o("div",{staticClass:"col-1"},[t._v("+")])])]),o("div",{staticClass:"col-6 col-md-3"},[o("div",{staticClass:"row q-caption text-faded"},[t._v("Diferença")]),o("div",{staticClass:"row q-py-xs"},[o("div",{staticClass:"col-11 text-faded"},[t._v(t._s(t._f("numero")(t.ajuste.qtdeDiferenca,4)))]),o("div",{staticClass:"col-1"},[t._v("=")])])]),o("campo",t._b({staticClass:"col-6 col-md-3",on:{input:t.atualizarDiferenca},model:{value:t.ajuste.qtdeDesejada,callback:function(e){t.$set(t.ajuste,"qtdeDesejada",e)},expression:"ajuste.qtdeDesejada"}},"campo",t.meta.qtdeDesejada,!1))],1),o("div",{staticClass:"row justify-between gutter-x-md q-ma-xm q-ml-sm"},[o("div",{class:["q-pa-sm",t.ajusteCor]},[t._v(t._s(t.ajusteMensagem))]),o("q-btn",{attrs:{color:"primary",label:"Ajustar",type:"submit"}})],1)])],1):t._e(),t.campos.ativo?o("q-card",{staticClass:"bg-white gutter-x-md q-my-md q-px-md q-py-md no-shadow"},[o("q-toolbar-title",{staticClass:"row q-mb-sm"},[t._v("Historico de Movimentações (Kardex)")]),t.mensagemKardex?[o("div",{staticClass:"q-ml-sm"},[t._v(t._s(t.mensagemKardex))])]:[o("div",{staticClass:"row"},[o("campo",t._b({staticClass:"col-12 col-md-6 q-pl-md",attrs:{opcoes:t.opcoesEmpresa},model:{value:t.codigoEmpresaKardex,callback:function(e){t.codigoEmpresaKardex=e},expression:"codigoEmpresaKardex"}},"campo",t.meta.nomeEmpresa,!1)),o("campo",{staticClass:"col-12 col-md-6 q-pl-md",attrs:{opcoes:t.opcoesTipoEstoque,"rotulo-fixo":"Tido de estoque",tipo:"seletor"},model:{value:t.tipoEstoqueSelecionado,callback:function(e){t.tipoEstoqueSelecionado=e},expression:"tipoEstoqueSelecionado"}})],1),o("q-table",{attrs:{title:"",data:t.tabelaKardex,columns:t.colunasKardex,"row-key":"name"},scopedSlots:t._u([{key:"body",fn:function(e){return o("q-tr",{attrs:{props:e}},t._l(e.cols,function(a){return o("q-td",{key:a.name,attrs:{props:e}},["acao"===a.field?o("div",{staticClass:"row items-center no-wrap"},[t.permissaoAjusteEstoque&&"Estoque"===(e.cols.find(function(t){return"documentoTipo"===t.field})||{}).value?o("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",round:"",dense:"",icon:"mdi-trash-can-outline"},on:{click:function(o){t.excluirAjuste((e.cols.find(function(t){return"codigoDocumento"===t.field})||{}).value)}}},[o("q-tooltip",{staticClass:"hideonmobile"},[t._v("\n                  Excluir ajuste\n                ")])],1):t._e()],1):o("div",[t._v(t._s(a.value))])])}))}}])})]],2):t._e()],1)},s=[];a._withStripped=!0;o("28a5");var i=o("278c"),r=o.n(i),l=o("448a"),n=o.n(l),c=(o("55dd"),o("7514"),o("96cf"),o("c973")),u=o.n(c),m=o("3156"),d=o.n(m),p=o("88db"),v=o("0dd6"),f={nomeEmpresa:{rotuloFixo:"Empresa",tipo:"seletor"}},h={custoDesejado:{rotulo:"Custo desejado",tipo:"decimal",decimals:"2"},custoMomento:{rotulo:"Custo atual",tipo:"decimal",decimals:"2"},data:{format:"DD/MM/YYYY HH:mm",rotulo:"Data",tipo:"dataHora"},lote:{maxlength:"50",rotulo:"Lote",tipo:"texto"},planoConta:{erroRotulo:"Obrigatório",rotuloFixo:"Plano de contas",tipo:"seletor"},planoContaEstoque:{erroRotulo:"Obrigatório",rotuloFixo:"Conta estoque",tipo:"seletor"},planoContaMovimento:{erroRotulo:"Obrigatório",rotuloFixo:"Conta movimento",tipo:"seletor"},qtdeDesejada:{rotulo:"Saldo desejado",tipo:"decimal",decimals:"4"},qtdeDiferenca:{rotulo:"Diferença",tipo:"decimal",decimals:"4"},qtdeMomento:{rotulo:"Saldo atual",tipo:"decimal",decimals:"4"}},q=d()({},f,h),x=q,g=o("7551"),C=o("afb5"),b=o("ed08"),j=o("8149"),E=o("b5ae"),_=function(t){return t>0},w={components:{Campo:p["a"]},computed:{colunasKardex:function(){return[{align:"left",name:"DataHoraFinalizado",field:"dataHoraFinalizado",label:"Data Finalizado",sortable:!0,format:this.$filters.dataHora},{align:"left",name:"DocumentoTipo",field:"documentoTipo",label:"Documento",sortable:!0},{align:"middle",name:"Acao",field:"acao",label:"Ação"},{align:"right",name:"Numero",field:"numero",label:"Número",format:function(t){return t||0}},{align:"right",name:"Quantidade",field:"quantidade",label:"Quantidade"},{align:"left",name:"Unidade",field:"unidade",label:"Unidade"},{align:"right",name:"Saldo",field:"saldo",label:"Saldo",sortable:!0},{align:"left",name:"DescricaoContato",field:"descricaoContato",label:"Contato",format:function(t){return t||""}},{align:"right",name:"CustoMedio",field:"custoMedio",label:"Custo Médio",format:this.$filters.dinheiro},{align:"right",name:"Custo",field:"custo",label:"Custo Real",format:this.$filters.dinheiro},{align:"right",name:"Ordem",field:"ordem",label:"Ordem",sortable:!0},{align:"right",name:"Fator",field:"fator",label:"Fator"},{align:"left",name:"DocumentoItemOperacao",field:"documentoItemOperacao",label:"Operação Item",sortable:!0},{align:"left",name:"DocumentoItemStatus",field:"documentoItemStatus",label:"Status Item",sortable:!0},{align:"right",name:"CodigoDocumento",field:"codigoDocumento",label:"Código Documento",sortable:!0}]},meta:function(){return d()({},g["a"],x)},opcoesEmpresa:function(){b["gconsole"].log("ItemEstoque","computed opcoesEmpresa");var t=this.empresasContato.map(function(t){return{rotulo:t.apelido+" - "+t.nome,valor:t.codigoContato}});return 0===t.length&&(t=[{rotulo:"-",valor:""}]),t}},data:function(){return{ajuste:{custoDesejado:0,data:new Date,lote:"",planoConta:"",planoContaEstoque:"",planoContaMovimento:"",qtdeDesejada:0,qtdeDiferenca:0,qtdeMomento:0},ajusteCor:"text-primary",ajusteMensagem:"",ajusteDataSomenteLeitura:!1,campos:{},codigoEmpresaKardex:0,codigoEmpresaSelecionada:0,empresasContato:[],estoquePorEmpresa:[],mensagemKardex:"",opcoesConta:[],opcoesPlanoConta:[{rotulo:"-",valor:""}],opcoesTipoEstoque:[{rotulo:"-",valor:""}],permissaoAjusteEstoque:!1,permissaoFicha:!1,tabelaKardex:[],tipoEstoqueSelecionado:""}},methods:{ajustarEstoque:function(){var t=u()(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(b["gconsole"].log("ItemEstoque","ajustarEstoque",d()({codigoEmpresa:this.codigoEmpresaSelecionada,codigoItem:this.campos.codigoItem},this.ajuste)),this.ajusteCor="text-primary",this.ajusteMensagem="Processando",this.$v.ajuste.$touch(),!this.$v.ajuste.$error){t.next=8;break}return this.ajusteCor="text-negative",this.ajusteMensagem="Há erros de validação no formulário.",t.abrupt("return",this.$q.notify(this.ajusteMensagem));case 8:return t.prev=8,t.next=11,C["a"].estoque.adicionarAjuste(d()({codigoEmpresa:this.codigoEmpresaSelecionada,codigoItem:+this.campos.codigoItem},this.ajuste));case 11:if(e=t.sent,b["gconsole"].log("ItemEstoque","ajustarEstoque retorno",e),e&&e.data&&e.data.estoqueAdicionarAjuste&&e.data.estoqueAdicionarAjuste.sucesso){t.next=15;break}throw new b["ErroValidacao"](e.data.estoqueAdicionarAjuste.mensagem);case 15:return this.ajusteCor="text-positive",this.ajusteMensagem=e.data.estoqueAdicionarAjuste.mensagem,this.$q.notifyPositive(this.ajusteMensagem),t.next=20,this.atualizar();case 20:t.next=27;break;case 22:t.prev=22,t.t0=t["catch"](8),this.ajusteCor="text-negative",this.ajusteMensagem="Ocorreu um erro ao ajustar o estoque online",this.$q.notifyError(this.ajusteMensagem,t.t0);case 27:case"end":return t.stop()}},t,this,[[8,22]])}));return function(){return t.apply(this,arguments)}}(),atualizarDiferenca:function(){b["gconsole"].log("ItemEstoque","atualizarDiferenca",this.ajuste.qtdeMomento,this.ajuste.qtdeDesejada),this.ajuste.qtdeDiferenca=this.ajuste.qtdeDesejada-this.ajuste.qtdeMomento},atualizarAjustePorLote:function(){var t=u()(regeneratorRuntime.mark(function t(){var e,o,a,s,i,r,l=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new Intl.DateTimeFormat("pt-BR",{dateStyle:"short",timeStyle:"short"}),o="\n        select top 1\n          custoMedio valorCustoMedio,\n          saldo\n        from kardex\n        where\n          codigoItem = ".concat(this.campos.codigoItem,"\n          and codigoEmpresa = ").concat(this.codigoEmpresaSelecionada,"\n          and datahorafinalizado <= '").concat(e.format(this.ajuste.data),"'\n          and tipoEstoque = 'Disponível'\n          and ").concat((this.ajuste.lote||"").trim()?"loteEmpresa = '"+(this.ajuste.lote||"").trim()+"'":"(ltrim(rtrim(loteEmpresa)) = '' or loteEmpresa is null)","\n        order by ordem desc"),a={},t.prev=3,t.next=6,Object(b["executarSql"])(o);case 6:if(t.t0=t.sent,t.t0){t.next=9;break}t.t0=[];case 9:s=t.t0,a=s[0]||{},t.next=20;break;case 13:t.prev=13,t.t1=t["catch"](3),this.ajusteDataSomenteLeitura=!0,b["gconsole"].log("ItemEstoque","atualizarAjustePorLote",this.codigoEmpresaSelecionada,this.ajuste.lote),i=this.estoquePorEmpresa||[],r=(i.find(function(t){return t.codigoEmpresa===l.codigoEmpresaSelecionada})||{}).estoquePorLote||[],a=r.find(function(t){return"Disponível"===t.tipoEstoque&&(t.loteEmpresa||"")===l.ajuste.lote})||{};case 20:this.ajuste.custoMomento=a.valorCustoMedio||0,this.ajuste.custoDesejado=this.ajuste.custoDesejado||a.valorCustoMedio||0,this.ajuste.qtdeMomento=a.saldo||0,this.ajuste.qtdeDesejada||(this.ajuste.qtdeDesejada=this.ajuste.qtdeMomento||0),this.atualizarDiferenca();case 25:case"end":return t.stop()}},t,this,[[3,13]])}));return function(){return t.apply(this,arguments)}}(),atualizar:function(){var t=u()(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return b["gconsole"].log("ItemEstoque","atualizar()"),t.next=3,j["a"].permissao.objeto("item//ficha");case 3:return this.permissaoFicha=t.sent,t.next=6,j["a"].permissao.objeto("item//estoque/ajuste_estoque");case 6:return this.permissaoAjusteEstoque=t.sent,t.prev=7,t.next=10,j["a"].item.leCompleto(this.$route.params.id);case 10:return this.itemCompleto=t.sent,j["a"].item.selecionado=this.itemCompleto.atual,this.campos=this.itemCompleto.atual,t.next=15,j["a"].empresa.le();case 15:return this.empresasContato=t.sent,t.next=18,j["a"].estoqueSaldoProdutoEmpresa.leEstoquePorEmpresa(this.campos.id);case 18:this.estoquePorEmpresa=t.sent,t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](7),this.$q.notifyError("Ocorreu erro ao consultar produto",t.t0);case 24:return t.prev=24,t.next=27,j["a"].configuracoes.le();case 27:return t.t1=function(t){return"item.estoque.ajuste"===t.nome},t.t2=function(t,e){return t.texto.localeCompare(e.texto)},e=t.sent.filter(t.t1).sort(t.t2),this.opcoesPlanoConta=[{rotulo:"-",valor:""}].concat(n()(e.map(function(t){return{rotulo:(t.texto||"").trim(),valor:t.valor}})),[{rotulo:"Especificar Contas",valor:"0"}]),t.next=33,j["a"].financeiroPlanoConta.le();case 33:t.t3=function(t){return t.ativo&&!!t.tradutor&&"00000"!==t.tradutor.substr(12,5)},t.t4=function(t,e){return t.tradutor.localeCompare(e.tradutor)},o=t.sent.filter(t.t3).sort(t.t4),this.opcoesConta=o.map(function(t){return{valor:t.codigoFinanceiroPlanoConta,rotulo:(t.descricao||"").trim(),sublabel:(t.caminho||"").trim()}}),t.next=43;break;case 39:t.prev=39,t.t5=t["catch"](24),this.$q.notifyError("Ocorreu erro ao consultar o plano de contas",t.t5),this.opcoesConta=[];case 43:this.atualizarKardex(),this.codigoEmpresaSelecionada||(this.codigoEmpresaSelecionada=this.opcoesEmpresa[0].valor),this.atualizarAjustePorLote();case 46:case"end":return t.stop()}},t,this,[[7,21],[24,39]])}));return function(){return t.apply(this,arguments)}}(),atualizarKardex:function(){var t=u()(regeneratorRuntime.mark(function t(){var e,o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return b["gconsole"].log("ItemEstoque","atualizarKardex()"),this.codigoEmpresaKardex||(this.codigoEmpresaKardex=this.opcoesEmpresa[0].valor),t.prev=2,t.next=5,C["a"].estoque.consultarKardex(this.campos.id,this.codigoEmpresaKardex);case 5:e=t.sent,this.opcoesTipoEstoque=Object(b["unicos"])(e.data.kardex||[],"tipoEstoque").map(function(t){return{rotulo:t,valor:t}}),this.tipoEstoqueSelecionado||(this.tipoEstoqueSelecionado=(this.opcoesTipoEstoque[0]||{}).valor||""),this.tabelaKardex=e.data.kardex.filter(function(t){return t.tipoEstoque===o.tipoEstoqueSelecionado}),this.mensagemKardex="",t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](2),this.mensagemKardex="É necessário estar com a internet ativa para acessar este serviço",console.error("Mensagem ao usuário: "+this.mensagemKardex),console.error(t.t0);case 17:case"end":return t.stop()}},t,this,[[2,12]])}));return function(){return t.apply(this,arguments)}}(),excluirAjuste:function(){var t=u()(regeneratorRuntime.mark(function t(e){var o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$q.dialog({cancel:"Cancelar",message:"Ao continuar o ajuste será excluído.",noRefocus:!0,ok:"Continuar",title:"Tem certeza?"}).then(u()(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o.$q.loading.show({message:"Excluindo ajuste"}),a="\n          exec Sp_Estoque_ExcluirAjuste ".concat(e,", ").concat(o.campos.codigoItem,"\n        "),t.prev=2,t.next=5,Object(b["executarSql"])(a);case 5:return t.next=7,o.atualizar();case 7:o.$q.notifyPositive("Ajuste excluído com sucesso"),t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](2);case 12:return t.prev=12,o.$q.loading.hide(),t.finish(12);case 15:case"end":return t.stop()}},t,null,[[2,10,12,15]])})));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),salvarItem:function(){var t=u()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(b["gconsole"].log("ItemEstoque","salvarItem",this.campos),this.verificarSeAlterouCampos(this.campos)){t.next=4;break}return this.$q.notifyPositive("Não há dados alterados."),t.abrupt("return");case 4:return t.prev=4,t.next=7,j["a"].item.grava(this.itemCompleto);case 7:return t.next=9,this.atualizar();case 9:this.$q.notifyPositive("Os dados foram salvos com sucesso."),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),this.$q.notifyError("Ocorreu um erro ao salvar",t.t0);case 15:case"end":return t.stop()}},t,this,[[4,12]])}));return function(){return t.apply(this,arguments)}}(),verificarSeAlterouCampos:function(){var t=Object(b["diferenca"])(this.itemCompleto.original,this.campos);return b["gconsole"].log("ItemEstoque","verificarSeAlterouCampos",null!==t,t),null!==t}},validations:{ajuste:{planoConta:{required:E["required"]},planoContaEstoque:{required:E["required"]},planoContaMovimento:{required:E["required"]},custoDesejado:{required:E["required"],gt0:_}}},mixins:[v["a"]],watch:{"ajuste.data":function(){this.atualizarAjustePorLote()},"ajuste.lote":function(){this.atualizarAjustePorLote()},codigoEmpresaSelecionada:function(){this.atualizarAjustePorLote()},codigoEmpresaKardex:function(){this.atualizarKardex()},tipoEstoqueSelecionado:function(){this.atualizarKardex()},"ajuste.planoConta":function(){if(b["gconsole"].log("ItemEstoque","watch ajuste.planoConta",this.ajuste.planoConta),"0"!==this.ajuste.planoConta){var t=this.ajuste.planoConta.split(","),e=r()(t,2),o=e[0],a=e[1];this.ajuste.planoContaEstoque=+o||0,this.ajuste.planoContaMovimento=+a||0}},"$route.params.id":function(){b["gconsole"].log("ItemEstoque","watch route id"),this.atualizar()}},created:function(){b["gconsole"].log("ItemEstoque","created()"),this.atualizar()}},M=w,D=o("2877"),y=Object(D["a"])(M,a,s,!1,null,null,null);y.options.__file="ItemEstoque.vue";e["default"]=y.exports},7551:function(t,e,o){"use strict";var a=o("3156"),s=o.n(a),i={descricao:{maxlength:"50",rotulo:"Descrição",tipo:"texto"},idContato:{rotulo:"Nome fornecedor",tipo:"texto"},referencia:{maxlength:"30",rotulo:"Referência",tipo:"texto"}},r={idItemUtilizado:{rotulo:"Produto para composição",tipo:"texto"},ordem:{max:"9999",min:"0",rotulo:"Ordem",tipo:"quantidade"},quantidade:{min:"0",rotulo:"Quantidade",tipo:"decimal",decimals:"4"},temporario:{total:{readonly:!0,rotulo:"Total",tipo:"decimal",decimals:"2"},unidade:{disable:!0,readonly:!0,rotuloFixo:"Unidade",tipo:"texto"},valor:{readonly:!0,rotulo:"Valor",tipo:"decimal",decimals:"2"}}},l={descricao:{maxlength:"8000",rotulo:"Descrição",tipo:"texto"},idItemEquipamento:{rotulo:"Equipamento",tipo:"texto"},idItemFerramenta:{rotulo:"Ferramenta",tipo:"texto"},idItemServico:{rotulo:"Servico",tipo:"texto"},ordem:{max:"9999",min:"0",rotulo:"Ordem",tipo:"quantidade"}},n={descricao:{maxlength:"150",rotulo:"Descrição"},especificacao:{maxlength:"150",rotulo:"Especificação"},limites:{maxlength:"150",rotulo:"Limites"}},c={altura:{rotulo:"Altura",tipo:"decimal",decimals:"0"},armacaoCor:{rotuloFixo:"Cor",tipo:"seletor"},armacaoMaterial:{rotuloFixo:"Material",tipo:"seletor"},diagonal:{rotulo:"Diagonal",tipo:"decimal",decimals:"0"},genero:{class:"col-12 col-md-6",rotuloFixo:"Gênero",tipo:"seletor"},haste:{rotulo:"Haste",tipo:"decimal",decimals:"0"},modelo:{maxlength:"100",rotulo:"Modelo",tipo:"texto"},ponte:{rotulo:"Ponte",tipo:"decimal",decimals:"0"},largura:{maxlength:"100",rotulo:"Largura",tipo:"texto"},tipoMontagem:{rotuloFixo:"Tipo de montagem",tipo:"seletor"}},u={aplicacao:{maxlength:"10000",rotulo:"Aplicação",rows:"2",tipo:"textoArea"},capacidade:{rotulo:"Capacidade",tipo:"decimal",decimals:"2"},capacidadeUnidade:{class:"col-12 col-md-3",maxlength:"20",rotulo:"Un. Capacidade",tipo:"texto"},codigoOrigem:{rotuloFixo:"Origem",tipo:"seletor",tipo2:"numerico"},comprimento:{rotulo:"Comprimento",tipo:"decimal",decimals:"2"},densidade:{rotulo:"Densidade",tipo:"decimal",decimals:"2"},embalagem:{class:"col-12 col-md-3",maxlength:"255",rotulo:"Embalagem",tipo:"texto"},garantiaDescricao:{maxlength:"255",rotulo:"Garantia descrição",tipo:"texto"},garantiaDias:{class:"col-12 col-md-4",min:"0",max:"9999",rotulo:"Garantia (dias)",tipo:"quantidade"},grupo:{rotuloFixo:"Grupo",tipo:"seletor"},idPerfilContabil:{class:"col-12 col-md-4",rotulo:"Perfil contábil",tipo:"seletor"},largura:{rotulo:"Largura",tipo:"decimal",decimals:"2"},observacao:{maxlength:"10000",rotulo:"Observação",rows:"4",tipo:"textoArea"},peso:{rotulo:"Peso",tipo:"decimal",decimals:"2"},subGrupo:{rotuloFixo:"SubGrupo",tipo:"seletor"},unidade:{rotuloFixo:"Unidade",tipo:"seletor"},unidade__:{valorInicial:"UN"},validadeMeses:{class:"col-12 col-md-3",min:"0",max:"9999",rotulo:"Validade (meses)",tipo:"decimal",decimals:"2"}},m={consumoMedio:{min:"0",rotulo:"Consumo médio",tipo:"decimal",decimals:"2"},local:{maxlength:"20",rotulo:"Local",tipo:"texto"},quantidadeMinimaCompra:{min:"0",rotulo:"Qtde compra reposição",tipo:"decimal",decimals:"2"},quantidadeMinimaEstoque:{min:"0",rotulo:"Estoque mínimo",tipo:"decimal",decimals:"2"},tempoMedioReposicao:{min:"0",rotulo:"Tempo médio reposição (dias)",tipo:"quantidade"}},d={codigoBarras:{erroRotulo:"Deve ter 12 ou 13 dígitos",maxlength:"13",rotulo:"Código de barras (GTIN ou EAN)",tipo:"texto"},descricao:{erroRotulo:"O nome deve ter pelo menos 2 caracteres",maxlength:"500",rotulo:"Nome do produto",tipo:"texto"},marca:{rotuloFixo:"Marca",tipo:"seletor"},fabricante:{rotuloFixo:"Fabricante",tipo:"seletor"},ncm:{maxlength:"8",rotulo:"NCM",tipo:"texto"},catalogo:{maxlength:"8",rotulo:"Catálogo Fabricante",tipo:"texto"},percentualMarkup:{rotulo:"Lucro",tipo:"decimal",decimals:"2"},referencia:{erroRotulo:"Referência deve ser única",maxlength:"30",rotulo:"Referência",tipo:"texto"},tipo:{rotuloFixo:"Tipo",tipo:"seletor"},utilizaComposicaoValorReposicao:{tipo:"logico"},utilizaMarkup:{tipo:"logico"},valorCustoReposicao:{rotulo:"Custo de reposição",tipo:"decimal",decimals:"2"},valorVenda:{rotulo:"Valor de venda",tipo:"decimal",decimals:"2"}},p={adicaoFinal:{rotulo:"até",tipo:"decimal",decimals:"2"},adicaoInicial:{rotulo:"Adição",tipo:"decimal",decimals:"2"},alturaMinima:{rotulo:"Altura mínima",tipo:"decimal",decimals:"0"},cilindrico:{rotulo:"Cilíndrico",tipo:"decimal",decimals:"2"},cor:{rotuloFixo:"Cor",tipo:"seletor"},diametro:{rotulo:"Diâmetro",tipo:"decimal",decimals:"0"},eixo:{rotulo:"Eixo",tipo:"decimal",decimals:"2"},eixoFinal:{rotulo:"até",tipo:"decimal",decimals:"2"},esfericoFinal:{rotulo:"até",tipo:"decimal",decimals:"2"},esfericoInicial:{rotulo:"Esférico",tipo:"decimal",decimals:"2"},geometria:{rotulo:"Geometria",tipo:"seletor"},indiceRefracao:{rotulo:"Índice refração",tipo:"decimal",decimals:"2"},lenteTipo:{rotulo:"Tipo de lente",tipo:"seletor"},material:{rotuloFixo:"Material",tipo:"seletor"},RB1:{rotulo:"RB1",tipo:"decimal",decimals:"2"},RB2:{rotulo:"RB2",tipo:"decimal",decimals:"2"},surfacada:{rotulo:"Pronta ou surfaçada",tipo:"seletor"}},v={procedimento:{maxlength:"10000",rotuloFixo:"Procedimento",rows:"3",tipo:"textoArea"},numeroPop:{maxlength:"50",rotulo:"Número Pop",tipo:"texto"}},f={ativo:{tipo:"logico"},consumoMedioReal:{tipo:"quantidade"},percentualMarkupReal:{tipo:"decimal",decimals:"2"},quantidadeDisponivel:{tipo:"quantidade"},tempoMedioReposicaoReal:{tipo:"quantidade"},utilizaComposicaoPedido:{tipo:"logico"},valorCusto:{tipo:"decimal",decimals:"2"},valorCustoMedio:{tipo:"decimal",decimals:"2"},valorCustoUltimo:{tipo:"decimal",decimals:"2"}},h=s()({composicao:{lista:r},fornecedor:{lista:i},producaoFase:{lista:l},qualidade:{lista:n}},c,u,m,d,p,f,v);e["a"]=h}}]);