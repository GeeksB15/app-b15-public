(self.webpackChunkb15=self.webpackChunkb15||[]).push([[919],{3459:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>We});var a=t(34182);const l=(0,a.withScopeId)("data-v-fcac7d8e");(0,a.pushScopeId)("data-v-fcac7d8e");const i=(0,a.createVNode)("span",{class:"text-subtitle1 text-weight-bold hideonmobile"},"Contratos",-1),r=(0,a.createTextVNode)("Criar Contrato"),d=(0,a.createTextVNode)("Abrir tudo"),n=(0,a.createTextVNode)("Download"),c=(0,a.createTextVNode)("Imprimir"),s=(0,a.createTextVNode)("Importar"),m=(0,a.createTextVNode)("Combinar"),u=(0,a.createTextVNode)("Editar Marca, Grupo, Subgrupo ou Unidade"),p={class:"row items-center"},V={key:0,class:"col-12"},h=(0,a.createTextVNode)("Data Emissão"),f={key:1,class:"col-12"},C=(0,a.createTextVNode)("Data Finalização"),N=(0,a.createTextVNode)("Data Emissão"),v=(0,a.createTextVNode)("Data Finalização"),k=(0,a.createTextVNode)("Valor do Contrato"),g={class:"text-tertiary q-col-gutter-xs"},y=(0,a.createTextVNode)(" Remover"),b=(0,a.createTextVNode)("Restaurar"),x=(0,a.createTextVNode)("Duplicar Produto/Serviço"),w=(0,a.createTextVNode)(" Estoque "),_=(0,a.createTextVNode)(" Fornecedor: "),I={class:"col-12 col-lg"},q={style:{"white-space":"pre-line"}},B={key:0,class:"col-10 col-lg"},D={key:1,class:"col-12 col-lg"},T={key:2,class:"col-10 col-lg"},S={key:3,class:"col-12 col-lg-auto q-pt-md",style:{"min-width":"115px !important"}},z=(0,a.createTextVNode)("Filtro Avançado"),A={class:"q-pa-md"},M={class:"row q-col-gutter-x-sm q-pa-md"};(0,a.popScopeId)();const Z=l(((e,o,t,Z,L,F)=>{const Q=(0,a.resolveComponent)("q-icon"),E=(0,a.resolveComponent)("q-input"),U=(0,a.resolveComponent)("q-toolbar-title"),$=(0,a.resolveComponent)("q-tooltip"),P=(0,a.resolveComponent)("q-btn"),H=(0,a.resolveComponent)("q-toolbar"),R=(0,a.resolveComponent)("q-checkbox"),j=(0,a.resolveComponent)("q-item-section"),G=(0,a.resolveComponent)("q-item"),O=(0,a.resolveComponent)("q-list"),X=(0,a.resolveComponent)("q-menu"),J=(0,a.resolveComponent)("q-tab"),K=(0,a.resolveComponent)("q-tabs"),W=(0,a.resolveComponent)("badge"),Y=(0,a.resolveComponent)("q-item-label"),ee=(0,a.resolveComponent)("row"),oe=(0,a.resolveComponent)("q-toggle"),te=(0,a.resolveComponent)("q-field"),ae=(0,a.resolveComponent)("campo"),le=(0,a.resolveComponent)("q-separator"),ie=(0,a.resolveComponent)("q-pagination"),re=(0,a.resolveComponent)("q-footer"),de=(0,a.resolveComponent)("q-header"),ne=(0,a.resolveComponent)("q-page-container"),ce=(0,a.resolveComponent)("q-layout"),se=(0,a.resolveComponent)("q-drawer"),me=(0,a.resolveComponent)("ContratoModal"),ue=(0,a.resolveComponent)("q-page"),pe=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createBlock)(ue,{id:"Modelo"},{default:l((()=>[(0,a.createVNode)(H,{class:"bg-gradiente text-white "},{default:l((()=>[(0,a.createVNode)(Q,{size:"sm",name:"mdi-gavel",class:"q-mr-sm"}),i,(0,a.createVNode)(U,{class:"q-py-sm"},{default:l((()=>[(0,a.createVNode)(E,{debounce:500,modelValue:L.buscaCampo,"onUpdate:modelValue":[o[3]||(o[3]=e=>L.buscaCampo=e),F.atualizar],ref:"buscaCampo",placeholder:"Filtrar",id:"busca",standout:"",filled:"",dark:"",dense:"",clearable:"","clear-icon":"close",style:{"max-width":"990px",margin:"0 auto"}},{prepend:l((()=>[(0,a.createVNode)(Q,{name:"mdi-filter",class:"cursor-pointer text-white float-right",onClick:o[1]||(o[1]=()=>{L.showFilters=!L.showFilters})})])),append:l((()=>[(0,a.createVNode)(Q,{name:"keyboard_arrow_down",onClick:o[2]||(o[2]=()=>{L.showFilters=!L.showFilters}),class:"cursor-pointer text-white"})])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.createVNode)(P,{dense:"",flat:"",icon:"add",round:"",onClick:F.criarContrato},{default:l((()=>[(0,a.createVNode)($,null,{default:l((()=>[r])),_:1})])),_:1},8,["onClick"])])),_:1}),(0,a.createVNode)(H,{class:"bg-transparent q-py-sm text-tertiary"},{default:l((()=>[(0,a.createVNode)(R,{modelValue:L.checkboxModel,"onUpdate:modelValue":[o[4]||(o[4]=e=>L.checkboxModel=e),e.checkBoxGeral_click],"text-color":"red-5"},null,8,["modelValue","onUpdate:modelValue"]),"Ativos"===e.tabSelecionada?((0,a.openBlock)(),(0,a.createBlock)(P,{key:0,dense:"",flat:"",icon:"delete",round:"",onClick:e.removerTodosItens},null,8,["onClick"])):(0,a.createCommentVNode)("",!0),"Excluidos"===e.tabSelecionada?((0,a.openBlock)(),(0,a.createBlock)(P,{key:1,dense:"",flat:"",icon:"restore_from_trash",round:"",onClick:e.restaurarTodosItens},null,8,["onClick"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(U),(0,a.createVNode)(P,{icon:L.showAllPreviewDetail?"keyboard_arrow_up":"keyboard_arrow_down",dense:"",flat:"",round:"",onClick:o[5]||(o[5]=e=>F.abrirTodosPreview())},{default:l((()=>[(0,a.createVNode)($,null,{default:l((()=>[d])),_:1})])),_:1},8,["icon"]),(0,a.createVNode)(P,{dense:"",flat:"",icon:"mdi-download",round:"",onClick:e.exportarXLSX_click},{default:l((()=>[(0,a.createVNode)($,null,{default:l((()=>[n])),_:1})])),_:1},8,["onClick"]),(0,a.createVNode)(P,{dense:"",flat:"",icon:"print",round:""},{default:l((()=>[(0,a.createVNode)($,null,{default:l((()=>[c])),_:1})])),_:1}),(0,a.withDirectives)((0,a.createVNode)(P,{dense:"",flat:"",icon:"more_vert",round:"",size:"md"},{default:l((()=>[(0,a.createVNode)(X,null,{default:l((()=>[(0,a.withDirectives)((0,a.createVNode)(O,{link:"","no-border":"",separator:""},{default:l((()=>[(0,a.createVNode)(G,{clickable:"",onClick:o[6]||(o[6]=()=>{(void 0).modalImportar=!0})},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"publish",size:"sm"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[s])),_:1})])),_:1}),(0,a.createVNode)(G,{clickable:"",onClick:o[7]||(o[7]=()=>{(void 0).modalCombinarItens=!0})},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"compare_arrows",size:"sm"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[m])),_:1})])),_:1}),(0,a.createVNode)(G,{clickable:"",onClick:e.editarMarca_click},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"edit",size:"sm"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[u])),_:1})])),_:1},8,["onClick"])])),_:1},512),[[pe]])])),_:1})])),_:1},512),[[a.vShow,e.permissaoFicha]])])),_:1}),(0,a.createVNode)(K,{modelValue:L.filtros.tab,"onUpdate:modelValue":o[8]||(o[8]=e=>L.filtros.tab=e),dense:"",class:"text-primary",align:"left",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},{default:l((()=>[((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(L.tabs,(e=>((0,a.openBlock)(),(0,a.createBlock)(J,{key:e.value,label:e.rotulo,name:e.value,onClick:o=>F.trocarTab(e.value)},null,8,["label","name","onClick"])))),128))])),_:1},8,["modelValue"]),(0,a.createVNode)(O,{class:"rounded-borders"},{default:l((()=>[((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(L.documentos,(o=>((0,a.openBlock)(),(0,a.createBlock)(a.Fragment,{key:o.id},[(0,a.createVNode)(G,{clickable:"",class:"items-center d-flex q-pa-xs"},{default:l((()=>[(0,a.createVNode)(j,{avatar:"",center:"",class:"mw120 hideonmobile"},{default:l((()=>[(0,a.createVNode)("div",p,[(0,a.createVNode)(R,{modelValue:L.listaItensLayout[o.id].remover,"onUpdate:modelValue":e=>L.listaItensLayout[o.id].remover=e},null,8,["modelValue","onUpdate:modelValue"]),"Cancelado"===o.status?((0,a.openBlock)(),(0,a.createBlock)(W,{key:0,class:"q-mr-sm hideonmobile",cor:"tertiary",escuro:""},{default:l((()=>[(0,a.createTextVNode)(" #"+(0,a.toDisplayString)((o.codigoDocumento||0).toString().padStart(3,"0")),1)])),_:2},1024)):((0,a.openBlock)(),(0,a.createBlock)(W,{key:1,class:"q-mr-sm hideonmobile",cor:"positive",escuro:""},{default:l((()=>[(0,a.createTextVNode)(" #"+(0,a.toDisplayString)((o.codigoDocumento||0).toString().padStart(3,"0")),1)])),_:2},1024))])])),_:2},1024),(0,a.createVNode)(j,{clickable:""},{default:l((()=>[(0,a.createVNode)(ee,{class:"items-center  q-col-gutter-x-sm"},{default:l((()=>[(0,a.createVNode)(R,{modelValue:L.listaItensLayout[o.id].remover,"onUpdate:modelValue":e=>L.listaItensLayout[o.id].remover=e,class:"q-ma-none q-pa-none hideondesktop"},null,8,["modelValue","onUpdate:modelValue"]),(0,a.createVNode)("div",{class:"col",onClick:e=>F.abrirItem(o.id)},[o.descricaoContato?((0,a.openBlock)(),(0,a.createBlock)(Y,{key:0,class:"text-tertiary text-weight-bold"},{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.descricaoContato),1)])),_:2},1024)):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(ee,{class:"hideondesktop items-center q-my-sm"},{default:l((()=>[o.dataHoraEmissao?((0,a.openBlock)(),(0,a.createBlock)("div",V,[(0,a.createVNode)(ee,null,{default:l((()=>[(0,a.createVNode)(Q,{class:"text-tertiary",name:"today"}),(0,a.createVNode)(Y,null,{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(o.dataHoraEmissao)),1)])),_:2},1024),(0,a.createVNode)($,null,{default:l((()=>[h])),_:1})])),_:2},1024)])):(0,a.createCommentVNode)("",!0),o.dataHoraFinalizado?((0,a.openBlock)(),(0,a.createBlock)("div",f,[(0,a.createVNode)(ee,null,{default:l((()=>[(0,a.createVNode)(Q,{class:"text-tertiary",name:"today"}),(0,a.createVNode)(Y,null,{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(o.dataHoraFinalizado)),1)])),_:2},1024),(0,a.createVNode)($,null,{default:l((()=>[C])),_:1})])),_:2},1024)])):(0,a.createCommentVNode)("",!0)])),_:2},1024)],8,["onClick"])])),_:2},1024)])),_:2},1024),(0,a.createVNode)(j,{onClick:e=>F.abrirItem(o.id),class:"hideonmobile"},{default:l((()=>[o.dataHoraEmissao?((0,a.openBlock)(),(0,a.createBlock)(ee,{key:0},{default:l((()=>[(0,a.createVNode)(Q,{class:"text-tertiary",name:"today"}),(0,a.createVNode)(Y,null,{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(o.dataHoraEmissao)),1)])),_:2},1024),(0,a.createVNode)($,null,{default:l((()=>[N])),_:1})])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:2},1032,["onClick"]),(0,a.createVNode)(j,{onClick:e=>F.abrirItem(o.id),class:"hideonmobile"},{default:l((()=>[o.dataHoraFinalizado?((0,a.openBlock)(),(0,a.createBlock)(ee,{key:0},{default:l((()=>[(0,a.createVNode)(Q,{class:"text-tertiary",name:"today"}),(0,a.createVNode)(Y,null,{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.data(o.dataHoraFinalizado)),1)])),_:2},1024),(0,a.createVNode)($,null,{default:l((()=>[v])),_:1})])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:2},1032,["onClick"]),(0,a.createVNode)(j,{onClick:e=>F.abrirItem(o.id)},{default:l((()=>[(0,a.createVNode)(Y,{caption:"",class:"text-right text-tertiary"},{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$filters.numero(o.totalContrato,2))+" ",1),(0,a.createVNode)($,null,{default:l((()=>[k])),_:1})])),_:2},1024)])),_:2},1032,["onClick"]),(0,a.createVNode)(j,{side:"",top:""},{default:l((()=>[(0,a.createVNode)("div",g,[(0,a.createVNode)(P,{icon:L.listaItensLayout[o.id].detalhes?"keyboard_arrow_up":"keyboard_arrow_down",class:"buttons",color:"tertiary",dense:"",flat:"",round:"",size:"md",onClick:e=>F.showDetails(o)},null,8,["icon","onClick"]),(0,a.createVNode)(P,{class:"buttons",color:"tertiary",dense:"",flat:"",icon:"edit",round:"",size:"md",onClick:e=>F.abrirItem(o.id)},null,8,["onClick"]),(0,a.createVNode)(P,{dense:"",flat:"",icon:"more_vert",round:"",size:"md"},{default:l((()=>[(0,a.createVNode)(X,null,{default:l((()=>[(0,a.withDirectives)((0,a.createVNode)(O,{class:"q-py-none",link:"","no-border":"",separator:""},{default:l((()=>["Excluidos"!==L.filtros.tab?((0,a.openBlock)(),(0,a.createBlock)(G,{key:0,onClick:t=>e.removerItem(o)},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"delete"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[y])),_:1})])),_:2},1032,["onClick"])):(0,a.createCommentVNode)("",!0),"Excluidos"===L.filtros.tab?((0,a.openBlock)(),(0,a.createBlock)(G,{key:1,onClick:t=>e.restaurarItem(o)},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"restore_from_trash"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[b])),_:1})])),_:2},1032,["onClick"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(G,{onClick:t=>e.duplicarItem(o.id)},{default:l((()=>[(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(Q,{name:"control_point_duplicate"})])),_:1}),(0,a.createVNode)(j,null,{default:l((()=>[x])),_:1})])),_:2},1032,["onClick"])])),_:2},1536),[[pe]])])),_:2},1024)])),_:2},1024)])])),_:2},1024)])),_:2},1024),L.listaItensLayout[o.id].detalhes?((0,a.openBlock)(),(0,a.createBlock)(G,{key:0,class:"collumnOnMobile q-px-md q-py-xs",onClick:e=>F.abrirItem(o.id)},{default:l((()=>[o.grupo?((0,a.openBlock)(),(0,a.createBlock)(j,{key:0,class:"row full-width"},{default:l((()=>[(0,a.createVNode)(Y,{caption:""},{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.grupo),1)])),_:2},1024),(0,a.createVNode)(Y,null,{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.subGrupo),1)])),_:2},1024)])),_:2},1024)):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(j,{avatar:""},{default:l((()=>[(0,a.createVNode)(W,{class:"q-mr-sm",cor:"primary",escuro:""},{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.tipo),1)])),_:2},1024)])),_:2},1024),(0,a.createVNode)(j,null,{default:l((()=>[o.quantidadeDisponivel?((0,a.openBlock)(),(0,a.createBlock)(Y,{key:0,stamp:""},{default:l((()=>[w,(0,a.createVNode)("strong",null,(0,a.toDisplayString)(o.quantidadeDisponivel),1),(0,a.createVNode)(W,{class:"q-ml-sm",cor:"tertiary",escuro:""},{default:l((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(o.unidade),1)])),_:2},1024)])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:2},1024),(0,a.createVNode)(j,null,{default:l((()=>[L.listaItensLayout[o.id].fornecedor?((0,a.openBlock)(),(0,a.createBlock)(Y,{key:0,stamp:""},{default:l((()=>[(0,a.createVNode)(Q,{class:"q-mr-xs",name:"business"}),_,((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(L.listaItensLayout[o.id].fornecedor,(e=>((0,a.openBlock)(),(0,a.createBlock)("div",{key:e.idContato},(0,a.toDisplayString)(e.contato.nome),1)))),128))])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:2},1024),(0,a.createVNode)("div",I,[o.codigoBarras?((0,a.openBlock)(),(0,a.createBlock)(j,{key:0,stamp:""},{default:l((()=>[(0,a.createVNode)(Q,{class:"q-mr-xs",name:"mdi-barcode"}),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(o.codigoBarras),1)])),_:2},1024)):(0,a.createCommentVNode)("",!0),o.address?((0,a.openBlock)(),(0,a.createBlock)(j,{key:1,stamp:""},{default:l((()=>[(0,a.createVNode)("span",q,(0,a.toDisplayString)(o.address),1)])),_:2},1024)):(0,a.createCommentVNode)("",!0)])])),_:2},1032,["onClick"])):(0,a.createCommentVNode)("",!0),L.listaItensLayout[o.id].detalhes?((0,a.openBlock)(),(0,a.createBlock)("div",{key:1,class:"row q-col-gutter-x-md q-pa-md pointer",onClick:e=>F.abrirItem(o.id)},[(0,a.createVNode)(te,{class:"col-2 col-lg-auto"},{default:l((()=>[(0,a.createVNode)(oe,{modelValue:L.listaItensLayout[o.id].utilizaComposicaoValorReposicaoInvertido,"onUpdate:modelValue":e=>L.listaItensLayout[o.id].utilizaComposicaoValorReposicaoInvertido=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),e.permissaoFicha?((0,a.openBlock)(),(0,a.createBlock)("div",B,[(0,a.createVNode)(ae,(0,a.mergeProps)({modelValue:o.valorCustoReposicao,"onUpdate:modelValue":e=>o.valorCustoReposicao=e},e.meta.valorCustoReposicao,{ajuda:L.listaItensLayout[o.id].utilizaComposicaoValorReposicaoInvertido?"":"Total da composição",disable:!L.listaItensLayout[o.id].utilizaComposicaoValorReposicaoInvertido,readonly:!L.listaItensLayout[o.id].utilizaComposicaoValorReposicaoInvertido,class:"no-shadow full-width "}),null,16,["modelValue","onUpdate:modelValue","ajuda","disable","readonly"])])):(0,a.createCommentVNode)("",!0),e.permissaoFicha?((0,a.openBlock)(),(0,a.createBlock)("div",D,[(0,a.createVNode)(ae,(0,a.mergeProps)({modelValue:L.listaItensLayout[o.id].percentualMarkup,"onUpdate:modelValue":e=>L.listaItensLayout[o.id].percentualMarkup=e},e.meta.percentualMarkup,{disable:L.listaItensLayout[o.id].utilizaMarkupInvertido,readonly:L.listaItensLayout[o.id].utilizaMarkupInvertido,class:"no-shadow full-width ",decimals:"2",rotulo:"Lucro",tipo:"decimal"}),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(te,{class:"col-2 col-lg-auto"},{default:l((()=>[(0,a.createVNode)(oe,{modelValue:L.listaItensLayout[o.id].utilizaMarkupInvertido,"onUpdate:modelValue":e=>L.listaItensLayout[o.id].utilizaMarkupInvertido=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),e.permissaoFicha?((0,a.openBlock)(),(0,a.createBlock)("div",T,[(0,a.createVNode)(ae,(0,a.mergeProps)({modelValue:o.valorVenda,"onUpdate:modelValue":e=>o.valorVenda=e},e.meta.valorVenda,{disable:!L.listaItensLayout[o.id].utilizaMarkupInvertido,readonly:!L.listaItensLayout[o.id].utilizaMarkupInvertido,class:"no-shadow full-width "}),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])])):(0,a.createCommentVNode)("",!0),e.permissaoFicha?((0,a.openBlock)(),(0,a.createBlock)("div",S,[(0,a.createVNode)(P,{class:"full-width no-shadow",color:"primary",label:"Salvar",size:"sm",onClick:t=>e.salvarItem(o)},null,8,["onClick"])])):(0,a.createCommentVNode)("",!0)],8,["onClick"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(le)],64)))),128))])),_:1}),(0,a.createVNode)(re,{class:"bg-grey-3 footerpaginacao "},{default:l((()=>[(0,a.createVNode)(ie,{input:"",modelValue:L.paginacao.atual,"onUpdate:modelValue":[o[9]||(o[9]=e=>L.paginacao.atual=e),F.atualizar],max:L.paginacao.maximo,class:"justify-center",color:"tertiary"},null,8,["modelValue","max","onUpdate:modelValue"])])),_:1}),(0,a.createVNode)(se,{modelValue:L.showFilters,"onUpdate:modelValue":o[14]||(o[14]=e=>L.showFilters=e),bordered:"",side:"right"},{default:l((()=>[(0,a.createVNode)(ce,{view:"hHh lpR lFr"},{default:l((()=>[(0,a.createVNode)(de,{class:"bg-white","height-hint":"98"},{default:l((()=>[(0,a.createVNode)(H,{color:"white",class:"text-tertiary"},{default:l((()=>[(0,a.createVNode)(Q,{class:"text-h5",name:"mdi-filter"}),(0,a.createVNode)(U,null,{default:l((()=>[z])),_:1}),(0,a.createVNode)(P,{dense:"",flat:"",icon:"close",round:"",onClick:o[10]||(o[10]=e=>L.showFilters=!L.showFilters)})])),_:1})])),_:1}),(0,a.createVNode)(ne,null,{default:l((()=>[(0,a.createVNode)("div",A,[(0,a.createVNode)(ae,{modelValue:L.filtrosDrawer.descricaoAplicacao,"onUpdate:modelValue":o[11]||(o[11]=e=>L.filtrosDrawer.descricaoAplicacao=e),rotulo:"Descrição/Aplicação",dense:""},null,8,["modelValue"]),(0,a.createVNode)(ae,{modelValue:L.filtrosDrawer.codIdRef,"onUpdate:modelValue":o[12]||(o[12]=e=>L.filtrosDrawer.codIdRef=e),rotulo:"Código/ID/Referência",dense:""},null,8,["modelValue"]),(0,a.createVNode)(ae,{modelValue:L.filtrosDrawer.codigoBarras,"onUpdate:modelValue":o[13]||(o[13]=e=>L.filtrosDrawer.codigoBarras=e),rotulo:"Cód. Barras",dense:""},null,8,["modelValue"])])])),_:1}),(0,a.createVNode)(re,{class:"bg-white"},{default:l((()=>[(0,a.createVNode)("div",M,[(0,a.createVNode)(P,{class:"col-6",color:"tertiary",flat:"",label:"Limpar",unelevated:"",onClick:e.limparFiltros_click},null,8,["onClick"]),(0,a.createVNode)(P,{class:"col-6 no-shadow",color:"primary",label:"Aplicar",unelevated:"",onClick:F.atualizar},null,8,["onClick"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(me,{ref:"contratoModal",onAtualizar:F.atualizar},null,8,["onAtualizar"])])),_:1})}));var L=t(25592),F=t(75173);t(26173);const Q=(0,a.createTextVNode)("Contrato"),E={class:"u-container q-py-sm"},U={key:0},$={key:3},P={ref:"form"},H={class:"row q-col-gutter-sm"},R={class:"col-12 col-md-4"},j={class:"col-12 col-md-4"},G={class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}},O=(0,a.createTextVNode)(" Itens "),X=(0,a.createTextVNode)("Adicionar Item"),J=(0,a.createVNode)("div",{class:"row text-weight-bold text-left justify-around"},[(0,a.createVNode)("div",{class:"col-2 col-lg-1"},"Código"),(0,a.createVNode)("div",{class:"col-10 col-lg-3 "},"Descrição"),(0,a.createVNode)("div",{class:"col-3 col-lg-2 text-right"},"Quantidade"),(0,a.createVNode)("div",{class:"col-3 col-lg-2 text-right"},"Valor Item"),(0,a.createVNode)("div",{class:"col-3 col-lg-2 text-right"},"Total"),(0,a.createVNode)("div",{class:"col-3 col-lg"})],-1),K={class:"row text-left justify-around"},W={class:"col-2 col-lg-1 "},Y={class:"col-10 col-lg-3 "},ee={class:"col-3 col-lg-2 text-right row"},oe={class:"col-2"},te={class:"col-3 col-lg-2 text-right"},ae={class:"col-3 col-lg-2 text-right"},le={class:"col-3 col-lg text-right"},ie=(0,a.createTextVNode)("Editar"),re=(0,a.createTextVNode)("Excluir"),de={class:"row text-weight-bold text-left justify-around"},ne=(0,a.createVNode)("div",{class:"col-2 col-lg-1 q-pr-md "},null,-1),ce=(0,a.createVNode)("div",{class:"col-10 col-lg-3 "},null,-1),se=(0,a.createVNode)("div",{class:"col-3 col-lg-2 text-right"},null,-1),me=(0,a.createVNode)("div",{class:"col-3 col-lg-2 text-right "},null,-1),ue={class:"col-3 col-lg-2 text-right"},pe=(0,a.createVNode)("div",{class:"col-3 col-lg"},null,-1);var Ve=t(48409),he=t(96986),fe=t(26891),Ce=t(12799),Ne=t(60357),ve=t(15358);const ke={components:{Badge:F.Z,Campo:fe.Z,PromptItemNovo:Ce.Z,Avatar:ve.Z,PromptContatoNovo:Ne.Z},data:()=>({cliente:{},emitente:{},diaVencimento:"",documentoAnterior:{},documentoItensAnterior:[],documento:{id:(0,he.uuid)(),dataHoraEmissao:(0,he.dataAtual)(),numero:"",descricaoContato:"",idContato:"",descricaoEmpresa:"",idEmpresa:"",numeroVolumeTransporte:"",status:"Ativo",tipo:"Contrato"},documentoItens:[],totalItens:0,visibilidade:{modal:!1},itensModal:!1,carregando:!0,contatosModal:!1,emitenteModal:!1,empresas:[],configImpressaoContrato:[]}),emits:["atualizar"],methods:{async atualizar(e){e?(this.documentoAnterior=await L.db.contrato.le({id:e}),this.documento=(0,he.clonarV2)(this.documentoAnterior),this.documentoItensAnterior=await L.db.itemManipulacao.leItens({idDocumento:e}),this.documentoItens=(0,he.clonarV2)(this.documentoItensAnterior),this.cliente.id=this.documento.idContato,this.cliente.nome=this.documento.descricaoContato,this.emitente.id=this.documento.idEmpresa,this.emitente.nome=this.documento.descricaoEmpresa,this.diaVencimento=this.documento.numeroVolumeTransporte):(this.limparCampos(),this.emitenteModal=!0);const o=await L.db.itemBusca.filtrar({limit:0});this.itens=o.data,this.empresas=await L.db.empresa.le(),this.somarValorTotal(),this.configuraImpressaoContrato(this.documento.idEmpresa)},async mostrar(){await(0,he.dormir)(500),this.carregando=!1},async configuraImpressaoContrato(e){const o=await L.db.configuracoes.porNome("impressao.contrato",e);this.configImpressaoContrato=o},fechar(){this.carregando=!0},limparCampos(){this.documentoAnterior={},this.documento={id:(0,he.uuid)(),dataHoraEmissao:(0,he.dataAtual)(),numero:"",descricaoContato:"",idContato:"",descricaoEmpresa:"",idEmpresa:"",numeroVolumeTransporte:"",status:"Ativo",tipo:"Contrato"},this.documentoItensAnterior=[],this.documentoItens=[],this.cliente.id="",this.cliente.nome="",this.emitente.id="",this.emitente.nome="",this.diaVencimento=""},async abrirModal(e=""){let o={},t=[];t=e?this.documentoItens.filter((o=>o.idItem===e)):this.documentoItens;for(const e of t)o[e.idItem]={item:await(0,Ve.X)().item.get(e.idItem)||{},quantidade:e.quantidade};this.$refs.promptItem.itensSelecionados=o,this.$refs.promptItem.termo=e,this.$refs.promptItem.atualizar(),this.itensModal=!0},recalcularTotal(e){e.subTotal=(0,he.arredondar)(e.quantidade*e.valorItem),e.total=(0,he.arredondar)(e.quantidade*e.valorItem),this.somarValorTotal()},aoSelecionarCliente(e,o){this.cliente=(0,he.clonarV2)(o),this.contatosModal=!1,this.documento.idContato=this.cliente.id,this.documento.descricaoContato=this.cliente.nome},async selecionarEmitente(e,o){e?(this.emitente=(0,he.clonarV2)(o),this.emitenteModal=!1,this.documento.idEmpresa=this.emitente.id,this.documento.descricaoEmpresa=this.emitente.nome):this.emitenteModal=!1},aoSelecionarVencimento(){this.documento.numeroVolumeTransporte=this.diaVencimento},selecionarItens:function(e){for(const o in e){const t=e[o].item||{},a=e[o].quantidade||0;let l=this.documentoItens.find((e=>e.idItem===o));l?(l.quantidade=a,l.quantidadeRealizado=a,l.total=(0,he.arredondar)(a*t.valorVenda)):this.documentoItens.push({dataHoraEmissao:(0,he.dataAtual)(),descricaoItem:t.descricao,id:(0,he.uuid)(),idDocumento:this.documento.id,idItem:t.id,operacao:"-",quantidade:a,unidade:t.unidade,quantidadeRealizado:a,tipoItem:t.tipo,total:(0,he.arredondar)(a*t.valorVenda),valorItem:t.valorVenda})}this.somarValorTotal()},somarValorTotal(){this.totalItens=this.documentoItens.reduce(((e,o)=>e+o.total),0)},excluirItem(e){this.documentoItens=this.documentoItens.filter((o=>o.id!==e)),this.somarValorTotal()},validaDia(){if(this.diaVencimento<1||this.diaVencimento>28)return this.$q.notifyAlert("O dia deve ser um valor entre 1 e 28"),void(this.diaVencimento="");this.aoSelecionarVencimento()},async gravar(e=!1){if(this.cliente.id)if(this.emitente.id)if(this.diaVencimento)if(this.totalItens)try{await L.db.contrato.grava({documentoAnterior:this.documentoAnterior,documento:this.documento,documentoItensAnterior:this.documentoItensAnterior,documentoItens:this.documentoItens}),this.visibilidade.modal=e,this.atualizar(this.documento.id),this.$emit("atualizar")}catch(e){this.$q.notifyError("Erro ao salvar",e)}else this.$q.notifyAlert("Adicione alguns itens ao contrato");else this.$q.notifyAlert("Selecione um dia de Vencimento");else this.$q.notifyAlert("Selecione um Emitente");else this.$q.notifyAlert("Selecione um Cliente")},cancelar(){this.documento.status="Cancelado",this.documento.dataHoraFinalizado=(0,he.dataAtual)(),this.gravar(!1)},ativar(){this.documento.status="Ativo",this.documento.dataHoraFinalizado="",this.gravar(!0)}},async created(){console.log("created")}};var ge=t(39341),ye=t(63626),be=t(54553),xe=t(47266),we=t(76210),_e=t(48761),Ie=t(4957),qe=t(54707),Be=t(25901),De=t(77953),Te=t(60880),Se=t(31106),ze=t(83054),Ae=t(68900),Me=t(83831),Ze=t(83671),Le=t(98586),Fe=t(7518),Qe=t.n(Fe);ke.render=function(e,o,t,l,i,r){const d=(0,a.resolveComponent)("q-btn"),n=(0,a.resolveComponent)("q-toolbar-title"),c=(0,a.resolveComponent)("q-toolbar"),s=(0,a.resolveComponent)("q-header"),m=(0,a.resolveComponent)("badge"),u=(0,a.resolveComponent)("q-tooltip"),p=(0,a.resolveComponent)("q-item-section"),V=(0,a.resolveComponent)("q-item-label"),h=(0,a.resolveComponent)("q-item"),f=(0,a.resolveComponent)("q-list"),C=(0,a.resolveComponent)("q-menu"),N=(0,a.resolveComponent)("avatar"),v=(0,a.resolveComponent)("campo"),k=(0,a.resolveComponent)("q-card"),g=(0,a.resolveComponent)("q-icon"),y=(0,a.resolveComponent)("q-separator"),b=(0,a.resolveComponent)("prompt-item-novo"),x=(0,a.resolveComponent)("prompt-contato-novo"),w=(0,a.resolveComponent)("q-footer"),_=(0,a.resolveComponent)("q-layout"),I=(0,a.resolveComponent)("q-dialog"),q=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createBlock)(I,{modelValue:i.visibilidade.modal,"onUpdate:modelValue":o[12]||(o[12]=e=>i.visibilidade.modal=e),maximized:"",onShow:r.mostrar,onHide:r.fechar},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{container:"",class:"bg-grey-4"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(s,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.withDirectives)((0,a.createVNode)(d,{dense:"",flat:"",icon:"arrow_back",round:""},null,512),[[q]]),(0,a.createVNode)(n,null,{default:(0,a.withCtx)((()=>[Q])),_:1}),(0,a.createVNode)(d,{class:"q-ml-sm no-shadow",color:"white","text-color":"primary",label:"Salvar",onClick:o[1]||(o[1]=e=>r.gravar(!1))})])),_:1})])),_:1}),(0,a.createVNode)("div",E,[(0,a.createVNode)(c,{class:"q-pa-none q-ma-none q-mb-md ",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(n,{class:"text-black q-px-none text-body2 "},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("Emissão: "+(0,a.toDisplayString)(e.$filters.data(i.documento.dataHoraEmissao))+" ",1),i.documento.dataHoraFinalizado?((0,a.openBlock)(),(0,a.createBlock)("span",U,"Cancelamento: "+(0,a.toDisplayString)(e.$filters.data(i.documento.dataHoraFinalizado)),1)):(0,a.createCommentVNode)("",!0)])),_:1}),"Ativo"===i.documento.status?((0,a.openBlock)(),(0,a.createBlock)(m,{key:0,cor:"positive",class:"q-mx-sm ",icone:"flag",escuro:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(i.documento.status),1)])),_:1})):(0,a.createCommentVNode)("",!0),"Cancelado"===i.documento.status?((0,a.openBlock)(),(0,a.createBlock)(m,{key:1,cor:"negative",class:"q-mx-xs ",icone:"flag",escuro:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(i.documento.status),1)])),_:1})):(0,a.createCommentVNode)("",!0),i.documento.numero?((0,a.openBlock)(),(0,a.createBlock)(m,{key:2,cor:"tertiary",escuro:"",icone:"playlist_add_check",class:"q-mx-xs "},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" #"+(0,a.toDisplayString)(i.documento.numero)+" ",1),i.documento.codigoDocumento?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("Código: "+(0,a.toDisplayString)(i.documento.codigoDocumento),1)])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})):(0,a.createCommentVNode)("",!0),i.documento.numero?((0,a.openBlock)(),(0,a.createBlock)("div",$,[i.configImpressaoContrato.length>1?((0,a.openBlock)(),(0,a.createBlock)(d,{key:0,class:"q-ml-xs",color:"primary",icon:"print",flat:"",dense:"",round:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{self:"top middle",anchor:"bottom middle"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(f,{link:"",separator:""},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(i.configImpressaoContrato.filter((e=>e.valor)),(o=>((0,a.openBlock)(),(0,a.createBlock)(h,{key:o.valor,onClick:t=>e.$imprimir(o.valor,{id:(i.documento||{}).id||"0",Oculto:"0"})},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{icon:"print"}),(0,a.createVNode)(V,{label:o.texto},null,8,["label"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})):((0,a.openBlock)(),(0,a.createBlock)(d,{key:1,class:"q-ml-xs",color:"primary",icon:"print",flat:"",dense:"",round:"",onClick:o[2]||(o[2]=o=>e.$imprimir(i.configImpressaoContrato[0].valor,{id:(i.documento||{}).id||"0",Oculto:"0"}))}))])):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(k,{class:"bg-white q-pa-md  q-mt-md no-shadow"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)("form",P,[(0,a.createVNode)("div",H,[(0,a.createVNode)("div",R,[(0,a.createVNode)(N,{imagem:i.emitente.imagem,rotulo:i.emitente.nome,tamanho:"30",style:{float:"left"},class:"q-mr-sm"},null,8,["imagem","rotulo"]),(0,a.createVNode)(v,{rotulo:"Emitente",tipo:"texto",class:"col-10",modelValue:i.emitente.nome,"onUpdate:modelValue":o[3]||(o[3]=e=>i.emitente.nome=e),disable:""},null,8,["modelValue"])]),(0,a.createVNode)("div",j,[(0,a.createVNode)(N,{imagem:i.cliente.imagem,rotulo:i.cliente.nome,tamanho:"30",style:{float:"left"},class:"q-mr-sm"},null,8,["imagem","rotulo"]),(0,a.createVNode)(v,{placeholder:"Cliente",rotulo:"Cliente",tipo:"texto",after:[{icon:"edit",handler(){i.contatosModal=!0}}],modelValue:i.cliente.nome,"onUpdate:modelValue":[o[4]||(o[4]=e=>i.cliente.nome=e),r.aoSelecionarCliente],onClick:o[5]||(o[5]=e=>i.contatosModal="Cancelado"!==i.documento.status),disabled:"Cancelado"===i.documento.status,somenteLeitura:"Cancelado"===i.documento.status},null,8,["after","modelValue","onUpdate:modelValue","disabled","somenteLeitura"])]),(0,a.createVNode)(v,{class:"col-12 col-md-4 ",rotulo:"Dia de Vencimento",modelValue:i.diaVencimento,"onUpdate:modelValue":o[6]||(o[6]=e=>i.diaVencimento=e),opcoes:{minimumValue:1,maximumValue:28},placeholder:"Dia Vencimento",tipo:"numero",onBlur:r.validaDia,erroRotulo:"Dia entre 1 e 28",erro:i.diaVencimento>28||i.diaVencimento<1},null,8,["modelValue","onBlur","erro"])])],512)])),_:1}),(0,a.createVNode)(k,{class:"bg-white q-pa-md  q-mt-md no-shadow"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,{class:"q-pa-none q-ma-none q-mb-md",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)("p",G,[(0,a.createVNode)(g,{name:"shopping_cart",class:"q-mr-md",size:"24px",style:{color:"#737373"}}),O]),(0,a.createVNode)(n,{class:"q-pa-none q-ma-none",style:{height:"0 !important","min-height":"auto"}}),"Cancelado"!==i.documento.status?((0,a.openBlock)(),(0,a.createBlock)(d,{key:0,color:"positive",flat:"",dense:"",icon:"add",round:"",size:"md",onClick:o[7]||(o[7]=e=>r.abrirModal())},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,null,{default:(0,a.withCtx)((()=>[X])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(f,{class:"col-12 no-border q-mx-none q-pa-none"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,{class:"q-pa-none"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{caption:""},{default:(0,a.withCtx)((()=>[J])),_:1}),(0,a.createVNode)(y,{class:"q-my-xs"}),((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(i.documentoItens,((o,t)=>((0,a.openBlock)(),(0,a.createBlock)("div",{key:t},[(0,a.createVNode)(V,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)("div",K,[(0,a.createVNode)("div",W,(0,a.toDisplayString)(o.codigoItem||"-"),1),(0,a.createVNode)("div",Y,(0,a.toDisplayString)(o.descricaoItem||"-"),1),(0,a.createVNode)("div",ee,[(0,a.createVNode)(v,{class:"col-10",modelValue:o.quantidade,"onUpdate:modelValue":e=>o.quantidade=e,tipo:"decimal",decimals:"4",onBlur:e=>r.recalcularTotal(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),(0,a.createVNode)("span",oe,(0,a.toDisplayString)(o.unidade||"-"),1)]),(0,a.createVNode)("div",te,[(0,a.createVNode)(v,{class:"col-10",modelValue:o.valorItem,"onUpdate:modelValue":e=>o.valorItem=e,tipo:"decimal",decimals:"4",onBlur:e=>r.recalcularTotal(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),(0,a.createVNode)("div",ae,(0,a.toDisplayString)(e.$filters.numero(o.total,2)),1),(0,a.createVNode)("div",le,[(0,a.createVNode)(d,{flat:"",dense:"",icon:"edit",round:"",size:"md",onClick:e=>r.abrirModal(o.idItem)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,null,{default:(0,a.withCtx)((()=>[ie])),_:1})])),_:2},1032,["onClick"]),(0,a.createVNode)(d,{flat:"",dense:"",icon:"delete",round:"",size:"md",onClick:e=>r.excluirItem(o.id)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,null,{default:(0,a.withCtx)((()=>[re])),_:1})])),_:2},1032,["onClick"])])])])),_:2},1024),(0,a.createVNode)(y,{class:"q-my-xs"}),(0,a.createVNode)(V,{caption:""})])))),128))])),_:1})])),_:1}),(0,a.createVNode)(V,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)("div",de,[ne,ce,se,me,(0,a.createVNode)("div",ue,(0,a.toDisplayString)(e.$filters.numero(i.totalItens,2)),1),pe])])),_:1}),(0,a.createVNode)(h,{class:"text-center"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{color:"positive",icon:"add",class:"q-mx-auto",label:"Adicionar item",outline:"",size:"xs",onClick:o[8]||(o[8]=e=>r.abrirModal())})])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(b,{modelValue:i.itensModal,"onUpdate:modelValue":o[9]||(o[9]=e=>i.itensModal=e),filtro:{ativo:!0,idEmpresa:i.documento.idEmpresa},onSelecionarItens:r.selecionarItens,habilitarQuantidade:!0,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"]),(0,a.createVNode)(x,{modelValue:i.contatosModal,"onUpdate:modelValue":o[10]||(o[10]=e=>i.contatosModal=e),filtro:{ativo:!0},placeholder:"Seleciona o Cliente",onSelecionar:r.aoSelecionarCliente},null,8,["modelValue","onSelecionar"]),(0,a.createVNode)(x,{modelValue:i.emitenteModal,"onUpdate:modelValue":o[11]||(o[11]=e=>i.emitenteModal=e),filtro:{ativo:!0,empresas:!0},placeholder:"Seleciona a empresa emitente",onSelecionar:r.selecionarEmitente},null,8,["modelValue","onSelecionar"])]),(0,a.createVNode)(w,null,{default:(0,a.withCtx)((()=>[i.documento.numero?((0,a.openBlock)(),(0,a.createBlock)(c,{key:0,class:"footer",style:{background:"#eeeeee !important"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(n,{class:"text-right"},{default:(0,a.withCtx)((()=>["Ativo"===i.documento.status?((0,a.openBlock)(),(0,a.createBlock)(d,{key:0,class:"q-mx-md",color:"negative",flat:"",label:"Cancelar",onClick:r.cancelar},null,8,["onClick"])):(0,a.createCommentVNode)("",!0),"Cancelado"===i.documento.status?((0,a.openBlock)(),(0,a.createBlock)(d,{key:1,color:"primary",label:"Ativar",unelevated:"",onClick:r.ativar},null,8,["onClick"])):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","onShow","onHide"])};const Ee=ke;Qe()(ke,"components",{QDialog:ge.Z,QLayout:ye.Z,QHeader:be.Z,QToolbar:xe.Z,QBtn:we.Z,QToolbarTitle:_e.Z,QTooltip:Ie.Z,QMenu:qe.Z,QList:Be.Z,QItem:De.Z,QItemSection:Te.Z,QItemLabel:Se.Z,QCard:ze.Z,QIcon:Ae.Z,QSeparator:Me.Z,QFooter:Ze.Z}),Qe()(ke,"directives",{ClosePopup:Le.Z});const Ue={components:{Badge:F.Z,ContratoModal:Ee},data:()=>({paginacao:{atual:1,minimo:1,maximo:1,total:1,limite:25},filtros:{tab:"Ativo",empresa:{selecionada:"",opcoes:[]},periodo:{emissao:{ini:"",fim:""},finalizado:{ini:"",fim:""}}},documentos:[],tabs:[{rotulo:"Ativos",value:"Ativo"},{rotulo:"Cancelados",value:"Cancelado"},{rotulo:"Todos",value:"Todos"}],checkboxModel:!1,showAllPreviewDetail:!1,listaItensLayout:{},showFilters:!1,filtrosDrawer:{ativo:null,descricaoAplicacao:null,codIdRef:null,codigoBarras:null,marca:null,fornecedor:null,grupo:null,subGrupo:null,estoque:null,tipo:null,codigoCompra:null},buscaCampo:"",opcoesMarca:[],opcoesGrupo:[],opcoesSubGrupo:[],opcoesTipo:["Produto"]}),methods:{async criarContrato(){this.$refs.contratoModal.visibilidade.modal=!0,await this.$refs.contratoModal.atualizar()},selecionarTodosXCheckBox(){for(let e of this.listaItens)this.listaItensLayout[e.id].remover=this.checkboxModel},trocarTab(e){this.paginacao.atual=1,this.filtros.tab=e,this.atualizar()},async cancelarTodosContratos(){},async ativarTodosContratos(){},gerarListaItensLayout(e){console.log({lista:e});for(let o of e)this.listaItensLayout[o.id]={detalhes:!1,remover:!1};this.documentos=(0,he.clonarV2)(e)},async abrirItem(e){this.$refs.contratoModal.visibilidade=!0,await this.$refs.contratoModal.atualizar(e)},abrirTodosPreview(){if(this.showAllPreviewDetail=!this.showAllPreviewDetail,this.showAllPreviewDetail)for(let e in this.documentos)this.documentos[e].showPreviewDetail=!0;else for(let e in this.documentos)this.documentos[e].showPreviewDetail=!1},async adicionarContrato(){this.$refs.contrato.visibilidade.modal=!0,await this.$refs.contrato.atualizar()},async buscar(){if(""!==this.buscaCampo){let e=[],o=[],t=(await L.db.itemBusca.filtrar({termoBusca:this.buscaCampo,limit:0})).data;if(t){for(let o of t){let t=await L.db.contrato.leItens({idItem:o.id});e.push(t)}e=e.flat(),console.log({documentosItem:e});for(let t of e){let e=await L.db.contrato.le({id:t.idDocumento});o.push({...e})}}console.log({documentosFiltrados:o});let a=await L.db.contatoBusca.filtrar(this.buscaCampo,{},0);if(a)for(let e of a){let t=await L.db.contrato.le({idContato:e.id});o.push(...t[0])}o=o.flat(),this.documentos=o.map((e=>({...e,showPreviewDetail:!1,documentoItens:[]}))),console.log(o,this.documentos)}},limparBusca(){this.buscaCampo||this.atualizar()},abrirFiltro(){!0===this.section||!0===this.kanban||!0===this.gantt?this.left=!0:this.left=!1,this.showFilters=!this.showFilters},getPage(e){this.page.ativa=e,this.filtrar()},async editar(e){await this.$refs.contrato.atualizar(e),this.$refs.contrato.visibilidade.modal=!0},async excluir(e){await this.$q.dialog({message:"Deseja mesmo cancelar esse Constrato?",title:"Cancelar Contrato?",cancel:{label:"Não",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).then((async()=>{let o=(0,he.clonarV2)(e);o.status="Cancelado",o.dataHoraFinalizado=(0,he.dataAtual)(),console.log({documentoOriginal:e,documentoAtualizado:o}),await L.db.contrato.grava({documentoAnterior:e,documento:o}),this.atualizar()}))},async showDetails(e){let o=await L.db.contrato.leItens({idDocumento:e.id});e.documentoItens=o,e.showPreviewDetail=!e.showPreviewDetail},async atualizar(){try{this.$q.loading.show();const e=this.paginacao.limite,o=this.paginacao.atual,t="descricao";let a="";"Ativo"===this.filtros.tab?a="Ativo":"Cancelado"===this.filtros.tab&&(a="Cancelado");let l=this.filtros.empresa.selecionada.value||"";this.filtros.idEmpresa=l;let i={};if(this.buscaCampo);else{let l=this.$utils.eliminarVazios(this.filtros);l.status=a,i=await this.filtrarCampos(l,e,o,t)}this.gerarListaItensLayout(i.data),this.paginacao.total=i.total,this.paginacao.maximo=i.totalPages}catch(e){this.$q.notifyError("Erro iniciar",e)}finally{this.$q.loading.hide()}},filtrarCampos:async(e,o,t,a)=>L.db.contrato.leRefatorado({filtros:e,limit:o,page:t,sort:a}),async filtrar(e=1){this.buscaCampo="";const o=(e-1)*this.pageSize;let t=await L.db.contrato.le({periodoEmissao:{ini:this.filtro.periodo.emissao.ini,fim:this.filtro.periodo.emissao.fim},diaVencimento:{ini:this.filtro.periodo.cancelado.ini,fim:this.filtro.periodo.cancelado.fim},status:this.page.ativa,idEmpresa:this.filtro.empresas.selected,offset:o,limit:this.pageSize});this.documentos=t[0].map((e=>({...e,showPreviewDetail:!1,documentoItens:[]})));let a=t[1];this.page.ativo.max=Math.ceil(a/this.pageSize),this.page.cancelado.max=Math.ceil(a/this.pageSize)},async empresaOpcoesCarregar(){this.filtro.empresas.options=(await L.db.empresa.le()).map((e=>({label:e.nome,value:e.idContato})))}},created(){this.atualizar()}};var $e=t(24515),Pe=t(86952),He=t(46924),Re=t(16078),je=t(38837),Ge=t(15031),Oe=t(81312),Xe=t(6427),Je=t(95277),Ke=t(7112);Ue.render=Z,Ue.__scopeId="data-v-fcac7d8e";const We=Ue;Qe()(Ue,"components",{QPage:$e.Z,QToolbar:xe.Z,QIcon:Ae.Z,QToolbarTitle:_e.Z,QInput:Pe.Z,QBtn:we.Z,QTooltip:Ie.Z,QCheckbox:He.Z,QMenu:qe.Z,QList:Be.Z,QItem:De.Z,QItemSection:Te.Z,QTabs:Re.Z,QTab:je.Z,QItemLabel:Se.Z,QField:Ge.Z,QToggle:Oe.Z,QSeparator:Me.Z,QFooter:Ze.Z,QPagination:Xe.Z,QDrawer:Je.Z,QLayout:ye.Z,QHeader:be.Z,QPageContainer:Ke.Z}),Qe()(Ue,"directives",{ClosePopup:Le.Z})}}]);