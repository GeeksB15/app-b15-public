(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["488c5524"],{"01f4":function(e,t,n){},2400:function(e,t,n){"use strict";var o=n("5a09"),a=n.n(o);a.a},"57da":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{class:e.classes,style:e.estilos},[n("use",{attrs:{"xlink:href":e.iconeComposto}})])},a=[];o._withStripped=!0;n("c5f6");var r={computed:{classes:function(){return["Icone",!!this.cor&&"text-".concat(this.cor)]},estilos:function(){return{height:"".concat(this.tamanho,"px"),width:"".concat(this.tamanho,"px")}},iconeComposto:function(){return"statics/icones.svg#"+this.nome}},props:{cor:{type:[Boolean,String],default:!1},nome:{type:String,required:!0},tamanho:{type:[Number,String],default:24}}},i=r,s=(n("e25e"),n("2877")),c=Object(s["a"])(i,o,a,!1,null,null,null);c.options.__file="Icone.vue";t["a"]=c.exports},"5a09":function(e,t,n){},"96a1":function(e,t,n){"use strict";var o=n("a60d");t["a"]=function(e,t){if(o["a"].is.cordova&&navigator&&navigator.app)return navigator.app.loadUrl(e,{openExternal:!0});var n=window.open(e,"_blank");if(n)return n.focus(),n;t&&t()}},e25e:function(e,t,n){"use strict";var o=n("01f4"),a=n.n(o);a.a},e5e4:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-card",{staticClass:"shadow-3 filters row no-shadow"},[n("div",{staticClass:"col-12"},[n("q-toolbar",{staticClass:"no-shadow q-pa-none",attrs:{"text-color":"black",color:"transparent"}},[n("q-toolbar-title",{staticClass:"q-pa-none"},[n("div",{staticClass:"filters row content-stretch justify-between q-pt-sm q-pr-sm q-mt-md q-mb-md gutter-x-sm bg-white",staticStyle:{"border-radius":"5px","min-height":"50px"}},[n("div",{staticClass:"col-11"},[n("div",{staticClass:"row q-mb-sm"},[n("q-chips-input",{staticClass:"col q-mx-md",attrs:{color:"faded",placeholder:"Filtre por Empresa"},on:{remove:e.removerEmpresa},model:{value:e.nomesEmpresasSelecionadas,callback:function(t){e.nomesEmpresasSelecionadas=t},expression:"nomesEmpresasSelecionadas"}},[n("q-autocomplete",{attrs:{"value-field":"value"},on:{search:e.buscarEmpresas,selected:e.selecionarEmpresa}})],1)],1)]),n("q-btn",{staticClass:"no-shadow",attrs:{icon:"mdi-refresh",round:"",dense:"",flat:"",color:"faded"},nativeOn:{click:function(t){return e.filtrar(t)}}})],1)])],1)],1)]),n("div",{staticClass:"row gutter-sm q-pb-md"},[n("div",{staticClass:"col-12",staticStyle:{float:"right"}},[n("span",{staticStyle:{"font-size":"70%"}},[e._v("\n        Atualizado em: "+e._s(e._f("dataHora")(this.filtro.dataConsulta))+"\n        "),n("q-spinner",{directives:[{name:"show",rawName:"v-show",value:e.carregando,expression:"carregando"}],attrs:{color:"primary",size:20}})],1)]),n("div",{staticClass:"col-12"},[n("q-card",{staticClass:"fit no-shadow",attrs:{inline:"",color:"white"}},[n("q-card-title",{staticClass:"text-tertiary q-title q-pb-sm"},[e._v("\n          Atrasados\n        ")]),n("q-card-main",[n("q-table",{directives:[{name:"show",rawName:"v-show",value:!e.carregando,expression:"!carregando"}],staticClass:"no-shadow text-left",attrs:{data:e.cockpit.envelopesAtrasados,columns:e.colunas.envelopes},scopedSlots:e._u([{key:"body",fn:function(t){return n("q-tr",{staticStyle:{cursor:"pointer"},attrs:{props:t}},[n("q-td",{key:"nroVenda",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroVenda)+"\n              ")]),n("q-td",{key:"nroEnvelope",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroEnvelope)+"\n              ")]),n("q-td",{key:"status",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.status)+"\n              ")]),n("q-td",{key:"dataHoraPrevisto",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(e._f("data")(t.row.dataHoraPrevisto))+"\n              ")]),n("q-td",{key:"nome",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("avatar",{staticClass:"q-mr-sm",attrs:{imagem:(e.contato[t.row.idContato]||{}).imagem,rotulo:t.row.nome,tamanho:"40"}}),e._v("\n                  "+e._s(t.row.nome)+"\n                ")],1)]),n("q-td",{key:"telefone",attrs:{props:t},nativeOn:{click:function(n){e.abrirTelefone(t.row)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{attrs:{color:"none",dense:"",flat:"",round:""}},[n("WhatsApp"===t.row.tipoTelefone?"icone":"q-icon",e._b({tag:"component"},"component",e.telefoneIcone(t.row.tipoTelefone),!1))],1),e._v("\n\n                  "+e._s(t.row.telefone)+"\n                ")],1)]),n("q-td",{key:"valor",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"q-mx-xs",attrs:{color:"none",dense:"",flat:"",round:"",icon:"shopping_cart"}}),e._v("\n                  "+e._s(e._f("numero")(t.row.valor||0,2))+"\n                ")],1)]),n("q-td",{key:"imprimir",attrs:{props:t}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"no-shadow q-ma-xs",staticStyle:{float:"right"},attrs:{rounded:"",dense:"",flat:"",icon:"print",color:"primary",size:"md"}},[n("q-popover",[n("q-list",{attrs:{link:"",separator:""}},e._l(e.configImpressaoEnvelope[t.row.idEmpresa],function(o){return n("q-item",{key:o.valor,nativeOn:{click:function(n){e.imprimir(o.valor,t.row.idVenda||"0")}}},[n("q-item-side",{attrs:{icon:"print"}}),n("q-item-main",{attrs:{label:o.texto}})],1)}))],1)],1)],1)])],1)}}])})],1)],1)],1),n("div",{staticClass:"col-12"},[n("q-card",{staticClass:"fit no-shadow",attrs:{inline:"",color:"white"}},[n("q-card-title",{staticClass:"text-tertiary q-title q-pb-sm"},[e._v("\n          Para hoje\n        ")]),n("q-card-main",[n("q-table",{directives:[{name:"show",rawName:"v-show",value:!e.carregando,expression:"!carregando"}],staticClass:"no-shadow text-left",attrs:{data:e.cockpit.envelopesHoje,columns:e.colunas.envelopes},scopedSlots:e._u([{key:"body",fn:function(t){return n("q-tr",{staticStyle:{cursor:"pointer"},attrs:{props:t}},[n("q-td",{key:"nroVenda",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroVenda)+"\n              ")]),n("q-td",{key:"nroEnvelope",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroEnvelope)+"\n              ")]),n("q-td",{key:"status",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.status)+"\n              ")]),n("q-td",{key:"dataHoraPrevisto",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(e._f("data")(t.row.dataHoraPrevisto))+"\n              ")]),n("q-td",{key:"nome",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("avatar",{staticClass:"q-mr-sm",attrs:{imagem:(e.contato[t.row.idContato]||{}).imagem,rotulo:t.row.nome,tamanho:"40"}}),e._v("\n                  "+e._s(t.row.nome)+"\n                ")],1)]),n("q-td",{key:"telefone",attrs:{props:t},nativeOn:{click:function(n){e.abrirTelefone(t.row)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{attrs:{color:"none",dense:"",flat:"",round:""}},[n("WhatsApp"===t.row.tipoTelefone?"icone":"q-icon",e._b({tag:"component"},"component",e.telefoneIcone(t.row.tipoTelefone),!1))],1),e._v("\n\n                  "+e._s(t.row.telefone)+"\n                ")],1)]),n("q-td",{key:"valor",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"q-mx-xs",attrs:{color:"none",dense:"",flat:"",round:"",icon:"shopping_cart"}}),e._v("\n                  "+e._s(e._f("numero")(t.row.valor||0,2))+"\n                ")],1)]),n("q-td",{key:"imprimir",attrs:{props:t}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"no-shadow q-ma-xs",staticStyle:{float:"right"},attrs:{rounded:"",dense:"",flat:"",icon:"print",color:"primary",size:"md"}},[n("q-popover",[n("q-list",{attrs:{link:"",separator:""}},e._l(e.configImpressaoEnvelope[t.row.idEmpresa],function(o){return n("q-item",{key:o.valor,nativeOn:{click:function(n){e.imprimir(o.valor,t.row.idVenda||"0")}}},[n("q-item-side",{attrs:{icon:"print"}}),n("q-item-main",{attrs:{label:o.texto}})],1)}))],1)],1)],1)])],1)}}])})],1)],1)],1),n("div",{staticClass:"col-12"},[n("q-card",{staticClass:"fit no-shadow",attrs:{inline:"",color:"white"}},[n("q-card-title",{staticClass:"text-tertiary q-title q-pb-sm"},[e._v("\n          A Entregar\n        ")]),n("q-card-main",[n("q-table",{directives:[{name:"show",rawName:"v-show",value:!e.carregando,expression:"!carregando"}],staticClass:"no-shadow text-left",attrs:{data:e.cockpit.envelopesAEntregar,columns:e.colunas.envelopes},scopedSlots:e._u([{key:"body",fn:function(t){return n("q-tr",{staticStyle:{cursor:"pointer"},attrs:{props:t}},[n("q-td",{key:"nroVenda",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroVenda)+"\n              ")]),n("q-td",{key:"nroEnvelope",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.nroEnvelope)+"\n              ")]),n("q-td",{key:"status",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(t.row.status)+"\n              ")]),n("q-td",{key:"dataHoraPrevisto",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[e._v("\n                "+e._s(e._f("data")(t.row.dataHoraPrevisto))+"\n              ")]),n("q-td",{key:"nome",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("avatar",{staticClass:"q-mr-sm",attrs:{imagem:(e.contato[t.row.idContato]||{}).imagem,rotulo:t.row.nome,tamanho:"40"}}),e._v("\n                  "+e._s(t.row.nome)+"\n                ")],1)]),n("q-td",{key:"telefone",attrs:{props:t},nativeOn:{click:function(n){e.abrirTelefone(t.row)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{attrs:{color:"none",dense:"",flat:"",round:""}},[n("WhatsApp"===t.row.tipoTelefone?"icone":"q-icon",e._b({tag:"component"},"component",e.telefoneIcone(t.row.tipoTelefone),!1))],1),e._v("\n\n                  "+e._s(t.row.telefone)+"\n                ")],1)]),n("q-td",{key:"valor",attrs:{props:t},nativeOn:{click:function(n){e.irParaAtendimentoVenda(t.row.idContato)}}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"q-mx-xs",attrs:{color:"none",dense:"",flat:"",round:"",icon:"shopping_cart"}}),e._v("\n                  "+e._s(e._f("numero")(t.row.valor||0,2))+"\n                ")],1)]),n("q-td",{key:"imprimir",attrs:{props:t}},[n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"no-shadow q-ma-xs",staticStyle:{float:"right"},attrs:{rounded:"",dense:"",flat:"",icon:"print",color:"primary",size:"md"}},[n("q-popover",[n("q-list",{attrs:{link:"",separator:""}},e._l(e.configImpressaoEnvelope[t.row.idEmpresa],function(o){return n("q-item",{key:o.valor,nativeOn:{click:function(n){e.imprimir(o.valor,t.row.idVenda||"0")}}},[n("q-item-side",{attrs:{icon:"print"}}),n("q-item-main",{attrs:{label:o.texto}})],1)}))],1)],1)],1)])],1)}}])})],1)],1)],1)])],1)},a=[];o._withStripped=!0;n("551c"),n("6762"),n("2fdb"),n("7514"),n("386d"),n("a481");var r=n("3156"),i=n.n(r),s=n("448a"),c=n.n(s),l=(n("ac4d"),n("8a81"),n("ac6a"),n("96cf"),n("c973")),p=n.n(l),d=n("df3a"),u=n("88db"),m=n("57da"),f=n("8149"),v=n("3e8a"),h=n("ffe7"),w=n.n(h),g=n("96a1"),b=n("ed08"),C={components:{Avatar:d["a"],Campo:u["a"],Icone:m["a"]},computed:{colunas:function(){return{envelopes:[{name:"nroVenda",label:"N.° Venda",field:"numero",align:"left"},{name:"nroEnvelope",label:"N.° Envelope",field:"numero",align:"left"},{name:"status",label:"Status",field:"status",sortable:!0,align:"left"},{name:"dataHoraPrevisto",label:"Previsão de Entrega",field:"dataHoraPrevisto",sortable:!0,align:"center"},{name:"nome",label:"Cliente",field:"nome",sortable:!0,align:"left"},{name:"telefone",label:"Telefone",field:"telefone",align:"left"},{name:"valor",label:"Valor",field:"valor",align:"left"},{name:"imprimir",field:"idVenda",align:"center"}]}}},data:function(){return{carregando:!0,cockpit:{envelopesAtrasados:[],envelopesHoje:[],envelopesAEntregar:[]},contato:{},empresas:[],nomesEmpresasSelecionadas:[],configImpressaoEnvelope:{},filtro:{codigoClienteSistema:"",codigoContatoUsuario:"",empresas:[],periodo:{ini:"",fim:""}}}},watch:{"$route.params.id":function(){this.atualizar()}},methods:{irParaAtendimentoVenda:function(e){this.$router.push({name:"AtendimentoVenda",params:{id:e}})},abrirTelefone:function(e){if(e.telefone){var t="WhatsApp"===e.tipoTelefone?"https://api.whatsapp.com/send?"+(e.aniversario?"text=Parabéns, "+e.nome+"&":"")+"phone=":"tel:+";Object(g["a"])(t+this.formatarTelefone(e.telefone))}},configuraImpressaoEnvelope:function(){var e=p()(regeneratorRuntime.mark(function e(t){var n,o,a,r,s,l,p,d;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=!0,o=!1,a=void 0,e.prev=3,r=t[Symbol.iterator]();case 5:if(n=(s=r.next()).done){e.next=16;break}if(l=s.value,this.configImpressaoEnvelope[l.idEmpresa]){e.next=13;break}return e.next=10,f["a"].configuracoes.porNome("impressao.envelope",l.idEmpresa);case 10:p=e.sent,d=c()(p.length?p.map(function(e){return i()({texto:"Imprimir Envelope"},e)}):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]),this.configImpressaoEnvelope[l.idEmpresa]=d;case 13:n=!0,e.next=5;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](3),o=!0,a=e.t0;case 22:e.prev=22,e.prev=23,n||null==r.return||r.return();case 25:if(e.prev=25,!o){e.next=28;break}throw a;case 28:return e.finish(25);case 29:return e.finish(22);case 30:case"end":return e.stop()}},e,this,[[3,18,22,30],[23,,25,29]])}));return function(t){return e.apply(this,arguments)}}(),formatarTelefone:function(e){return e||"string"===typeof e?"55"+e.replace(/\D/g,"").replace(/^55/,""):e},telefoneIcone:function(e){return{Celular:{color:"dark",name:"phone_iphone",size:"18px"},Comercial:{color:"dark",name:"phone",size:"18px"},Fixo:{color:"dark",name:"phone",size:"18px"},Principal:{color:"orange",name:"star",size:"18px"},WhatsApp:{cor:"whatsapp",nome:"whatsapp",tamanho:18}}[e]||{color:"dark",name:"phone",size:"18px"}},buscarEmpresas:function(e,t){if(e=(e||"").trim(),e){var n=!!e.replace(/[^\d]/g,""),o=new w.a(this.empresas,{keys:[{name:"nome",weight:.9},{name:"apelido",weight:.9},n?{name:"numeroDocumentoNacional"}:{}]});t(o.search(e).map(function(e){return{value:e.codigoContato,label:e.nome,sublabel:e.numeroDocumentoNacional}}))}else t(this.empresas.map(function(e){return{value:e.codigoContato,label:e.nome,sublabel:e.numeroDocumentoNacional}}))},removerEmpresa:function(e){var t=this.empresas.find(function(t){return t.nome===e.value[0]});t&&(this.filtro.empresas=this.filtro.empresas.filter(function(e){return e!==t.codigoContato}),this.filtrar())},selecionarEmpresa:function(e){this.filtro.empresas.includes(e.value)?this.nomesEmpresasSelecionadas=this.nomesEmpresasSelecionadas.slice(0,this.nomesEmpresasSelecionadas.length-1):(this.filtro.empresas.push(e.value),this.nomesEmpresasSelecionadas.splice(this.nomesEmpresasSelecionadas.length-1,1,e.label),this.filtrar())},obterContatos:function(){var e=p()(regeneratorRuntime.mark(function e(t){var n,o,a,r,i,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n={},o=!0,a=!1,r=void 0,e.prev=4,i=t[Symbol.iterator]();case 6:if(o=(s=i.next()).done){e.next=16;break}if(c=s.value,!c.idContato||n[c.idContato]){e.next=13;break}return e.next=11,Object(v["a"])().contato.get(c.idContato);case 11:l=e.sent,l&&l.id&&(n[c.idContato]={imagem:l.imagem||""});case 13:o=!0,e.next=6;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](4),a=!0,r=e.t0;case 22:e.prev=22,e.prev=23,o||null==i.return||i.return();case 25:if(e.prev=25,!a){e.next=28;break}throw r;case 28:return e.finish(25);case 29:return e.finish(22);case 30:this.contato=n;case 31:case"end":return e.stop()}},e,this,[[4,18,22,30],[23,,25,29]])}));return function(t){return e.apply(this,arguments)}}(),obterConsultaRecente:function(){var e=p()(regeneratorRuntime.mark(function e(){var t,n,o,a,r,i,s,l,p,d=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.criarObjStoreIDB();case 2:return t=String(this.codigoClienteSistema)+"_"+String(this.codigoContatoUsuario)+"/envelopes",e.next=5,this.obterObjIDb(t);case 5:if(n=e.sent,!n){e.next=37;break}for(this.filtro={codigoClienteSistema:this.codigoClienteSistema,codigoContatoUsuario:this.codigoContatoUsuario,empresas:n.empresas,dataConsulta:new Date(n.dataConsulta),periodo:n.periodo},this.nomesEmpresasSelecionadas=[],o=!0,a=!1,r=void 0,e.prev=12,i=function(){var e=l.value,t=d.empresas.find(function(t){return t.codigoContato===e});t&&d.nomesEmpresasSelecionadas.push(t.nome)},s=this.filtro.empresas[Symbol.iterator]();!(o=(l=s.next()).done);o=!0)i();e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](12),a=!0,r=e.t0;case 21:e.prev=21,e.prev=22,o||null==s.return||s.return();case 24:if(e.prev=24,!a){e.next=27;break}throw r;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return p=n.dados,e.next=32,this.obterContatos(c()(p.envelopesAtrasados).concat(c()(p.envelopesHoje),c()(p.envelopesAEntregar)));case 32:return e.next=34,this.configuraImpressaoEnvelope(c()(p.envelopesAtrasados).concat(c()(p.envelopesHoje),c()(p.envelopesAEntregar)));case 34:return this.acertarDatas(p),this.cockpit=p,e.abrupt("return",!0);case 37:return e.abrupt("return",!1);case 38:case"end":return e.stop()}},e,this,[[12,17,21,29],[22,,24,28]])}));return function(){return e.apply(this,arguments)}}(),acertarDatas:function(e){var t=new Date((new Date).setHours(0,0,0,0)).toISOString().replace(/\d{4}-\d{2}-\d{2}/g,"");e.envelopesAtrasados.forEach(function(e){e.dataHoraPrevisto=(e.dataHoraPrevisto||"").replace(/T.+$/g,t)}),e.envelopesHoje.forEach(function(e){e.dataHoraPrevisto=(e.dataHoraPrevisto||"").replace(/T.+$/g,t)}),e.envelopesAEntregar.forEach(function(e){e.dataHoraPrevisto=(e.dataHoraPrevisto||"").replace(/T.+$/g,t)})},salvarConsultaRecente:function(){var e=p()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.criarObjStoreIDB();case 2:this.salvarObjIDb({id:String(this.filtro.codigoClienteSistema)+"_"+String(this.filtro.codigoContatoUsuario)+"/envelopes",periodo:this.filtro.periodo,dataConsulta:this.filtro.dataConsulta.toISOString(),empresas:this.filtro.empresas,dados:this.cockpit});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),criarObjStoreIDB:function(){var e=p()(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("indexedDB"in window){e.next=3;break}return console.log("Navegador sem suporte ao IndexedDB"),e.abrupt("return");case 3:return t=indexedDB.open("cockpit",1),t.onupgradeneeded=function(e){var t=e.target.result,n=t.createObjectStore("consultasRecentes",{keyPath:"id"});n.createIndex("id","id",{unique:!0})},e.abrupt("return",new Promise(function(e,n){t.onsuccess=function(t){e()},t.onerror=function(t){e()}}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),salvarObjIDb:function(e){var t,n,o;if("indexedDB"in window)return t=new Promise(function(e,t){o=e}),n=indexedDB.open("cockpit",1),n.onsuccess=function(){var t=n.result.transaction(["consultasRecentes"],"readwrite"),a=t.objectStore("consultasRecentes");n=a.put(e),n.onsuccess=function(e){o()},n.onerror=function(e){o()}},t},obterObjIDb:function(e){var t,n,o;if("indexedDB"in window)return t=new Promise(function(e,t){o=e}),n=indexedDB.open("cockpit",1),n.onsuccess=function(){var t=n.result.transaction(["consultasRecentes"],"readwrite"),a=t.objectStore("consultasRecentes");n=a.get(e),n.onsuccess=function(e){o(e.target.result)},n.onerror=function(e){o()}},t},filtrar:function(){var e=p()(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.carregando=!0,this.contato={},this.filtro.periodo.ini=new Date(this.filtro.periodo.ini).toISOString(),this.filtro.periodo.fim=new Date(this.filtro.periodo.fim).toISOString(),this.filtro.dataConsulta=new Date,e.next=7,this.$utils.geeksApi({"cockpit-envelopes":{funcao:"1A2281A1-795D-4ACE-8A8B-DFFE2CAEE2CA",codigoClienteSistema:this.filtro.codigoClienteSistema,codigoContatoUsuario:this.filtro.codigoContatoUsuario,empresas:this.filtro.empresas,periodo:this.filtro.periodo}});case 7:return t=e.sent,t=t.data["cockpit-envelopes"],e.next=11,this.obterContatos(c()(t.envelopesAtrasados).concat(c()(t.envelopesHoje),c()(t.envelopesAEntregar)));case 11:return e.next=13,this.configuraImpressaoEnvelope(c()(t.envelopesAtrasados).concat(c()(t.envelopesHoje),c()(t.envelopesAEntregar)));case 13:this.acertarDatas(t),this.cockpit=t,this.salvarConsultaRecente(),this.carregando=!1;case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),atualizar:function(){var e=p()(regeneratorRuntime.mark(function e(){var t,n,o,a,r,i,s,c,l,p,d,u,m,f,h=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=this.$route.params.id,Object(b["verificarErro"])(!a,"Id do contato não encontrado"),e.next=5,Object(v["a"])().contato.get(a);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:return r=e.t0,o=r.codigoContato,Object(b["verificarErro"])(!o,"Contato não encontrado"),t=JSON.parse(localStorage.getItem("clienteSistema"))||{},n=t.codigoClienteSistema,Object(b["verificarErro"])(!n,"Cliente Sistema não encontrado"),this.codigoClienteSistema=n,this.codigoContatoUsuario=o,e.next=18,Object(v["a"])().empresa.toArray();case 18:for(i=e.sent,this.empresas=i.map(function(e){return{codigoContato:e.codigoContato,nome:e.nome,apelido:e.apelido,numeroDocumentoNacional:e.numeroDocumentoNacional}}),s=new Date(new Date((new Date).setDate(1)).setHours(0,0,0,0)),c=new Date(new Date(new Date(s).setMonth(s.getMonth()+1)).setDate(0)),this.nomesEmpresasSelecionadas=[],this.filtro=this.filtroT||{codigoClienteSistema:this.codigoClienteSistema,codigoContatoUsuario:this.codigoContatoUsuario,empresas:[],dataConsulta:new Date,periodo:{ini:s,fim:c}},this.nomesEmpresasSelecionadas=[],l=!0,p=!1,d=void 0,e.prev=28,u=function(){var e=f.value,t=h.empresas.find(function(t){return t.codigoContato===e});t&&h.nomesEmpresasSelecionadas.push(t.nome)},m=this.filtro.empresas[Symbol.iterator]();!(l=(f=m.next()).done);l=!0)u();e.next=37;break;case 33:e.prev=33,e.t1=e["catch"](28),p=!0,d=e.t1;case 37:e.prev=37,e.prev=38,l||null==m.return||m.return();case 40:if(e.prev=40,!p){e.next=43;break}throw d;case 43:return e.finish(40);case 44:return e.finish(37);case 45:if(e.t2=!this.filtroT,!e.t2){e.next=50;break}return e.next=49,this.obterConsultaRecente();case 49:e.t2=e.sent;case 50:if(!e.t2){e.next=54;break}if(this.carregando=!1,new Date-new Date(this.filtro.dataConsulta)>3e5){e.next=54;break}return e.abrupt("return");case 54:this.filtrar(),e.next=60;break;case 57:e.prev=57,e.t3=e["catch"](0),this.$q.notifyError("Não foi possível carregar os dados do cockpit",e.t3);case 60:case"end":return e.stop()}},e,this,[[0,57],[28,33,37,45],[38,,40,44]])}));return function(){return e.apply(this,arguments)}}()},props:{filtroT:Object},mounted:function(){this.atualizar()}},k=C,q=(n("2400"),n("2877")),x=Object(q["a"])(k,o,a,!1,null,"10763c99",null);x.options.__file="CockpitEnvelopes.vue";t["default"]=x.exports}}]);