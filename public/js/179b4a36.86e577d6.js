(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["179b4a36"],{"64ad":function(t,o,a){"use strict";var e=a("afd8"),r=a.n(e);r.a},"81da":function(t,o,a){"use strict";a.r(o);var e=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("q-layout",{staticClass:"Atendimento Layout"},[a("barra-topo"),a("q-page-container",[a("q-page",{staticClass:"u-container"},[a("q-toolbar",{staticClass:"q-py-sm",attrs:{color:"none"}},[a("avatar",{attrs:{imagem:t.contato.imagem,rotulo:!!t.podeAcessar&&t.contato.apelido,tamanho:"40"}}),a("q-toolbar-title",[t._v("\n          "+t._s(t.dbContato.selecionado.apelido)+"\n\n          "),t.badge?a("badge",t._b({staticClass:"q-ml-sm",attrs:{denso:"",escuro:""}},"badge",t.badge,!1),[t.badgeDetalhes?a("q-tooltip",{staticClass:"Atendimento-badgeDetalhes"},[t._v(t._s(t.badgeDetalhes))]):t._e()],1):t._e(),t.telefone?a("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v(t._s(t.telefone))]):t._e()],1),a("q-btn",{attrs:{flat:"",dense:"",icon:"search",round:"",size:"lg"},on:{click:t.buscarContato}},[a("q-tooltip",[t._v("Buscar contato")])],1),a("q-btn",{attrs:{flat:"",dense:"",icon:"person_add",round:"",size:"lg"},on:{click:t.adicionarContato}},[a("q-tooltip",[t._v("Criar contato")])],1),"optisoul"===t.sistemaPai?a("q-btn",{attrs:{icon:"help_outline",flat:"",dense:"",round:"",size:"lg"}},[a("q-popover",[a("q-list",{attrs:{link:"","no-border":"",separator:""}},[a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Vendas"},nativeOn:{click:function(o){t.showHelp("vendas")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Pupilômetro"},nativeOn:{click:function(o){t.showHelp("pupilometro")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Fatura - completa"},nativeOn:{click:function(o){t.showHelp("faturaCompleta")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Fatura (com sinal)"},nativeOn:{click:function(o){t.showHelp("faturaComSinal")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Cadastro de Fornecedores"},nativeOn:{click:function(o){t.showHelp("cadastroFornecedores")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Cadastro de Médicos"},nativeOn:{click:function(o){t.showHelp("cadastroMedicos")}}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}]},[a("q-item-side",{attrs:{icon:"mdi-youtube"}}),a("q-item-main",{attrs:{label:"Videoaula Cadastro de Clientes"},nativeOn:{click:function(o){t.showHelp("cadastroClientes")}}})],1)],1)],1)],1):t._e(),a("q-btn",{attrs:{flat:"",dense:"",icon:"more_vert",round:"",size:"lg"}},[a("q-popover",[a("q-list",{attrs:{link:"","no-border":"",separator:""}},[a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(o){return t.buscarContatoExcluido(o)}}},[a("q-item-side",{attrs:{icon:"search"}}),a("q-item-main",{attrs:{label:"Buscar excluídos"}})],1),a("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(o){t.modalImportar=!0}}},[a("q-item-side",{attrs:{icon:"import_export"}}),a("q-item-main",{attrs:{label:"Importar contatos"}})],1),a("q-item",{nativeOn:{click:function(o){t.combinarContatosModal=!0}}},[a("q-item-side",{attrs:{icon:"compare_arrows"}}),a("q-item-main",{attrs:{label:"Combinar contatos duplicados"}})],1),a("q-item",{nativeOn:{click:function(o){return t.copiarUid(o)}}},[a("q-item-side",{attrs:{icon:"file_copy"}}),a("q-item-main",{attrs:{label:"Copiar código do contato"}}),a("input",{ref:"uid",attrs:{type:"hidden"},domProps:{value:t.contato.id}})],1)],1)],1)],1)],1),a("MenuAbas",{attrs:{objetoPai:"atendimento"}},[t.podeAcessar||["AtendimentoVenda","AtendimentoFatura"].includes(t.$route.name)?a("router-view",{ref:"componentefilho"}):a("div",{staticClass:"bg-white q-pa-xl text-center"},[t._v("\n          Não é possível acessar este recurso como "),a("strong",[t._v("consumidor")]),t._v(". Por favor, cadastre ou selecione um\n          contato.\n\n          "),a("div",{staticClass:"text-center q-mt-sm"},[a("q-btn",{staticClass:"q-ma-sm no-shadow",attrs:{color:"primary",icon:"person_add",label:"Novo contato"},on:{click:t.adicionarContato}}),a("q-btn",{staticClass:"q-ma-sm no-shadow",attrs:{color:"primary",icon:"search",label:"Buscar contato"},on:{click:t.buscarContato}})],1)])],1),a("prompt-contato-novo",{attrs:{filtro:{ativo:!1,somenteCarteira:!0}},on:{selecionar:t.abrirContato},model:{value:t.contatosInativosModal,callback:function(o){t.contatosInativosModal=o},expression:"contatosInativosModal"}}),a("prompt-contato-novo",{attrs:{filtro:{ativo:!0,somenteCarteira:!0}},on:{selecionar:t.abrirContato},model:{value:t.contatosModal,callback:function(o){t.contatosModal=o},expression:"contatosModal"}}),a("prompt-contato-novo",{attrs:{filtro:{ativo:!0,somenteCarteira:!0}},on:{selecionar:t.selecionarCombinarContatos},model:{value:t.combinarContatosModal,callback:function(o){t.combinarContatosModal=o},expression:"combinarContatosModal"}}),a("importar-contatos",{model:{value:t.modalImportar,callback:function(o){t.modalImportar=o},expression:"modalImportar"}})],1)],1),a("q-modal",{attrs:{"content-css":{minWidth:"100vw",minHeight:"100vh"}},model:{value:t.help.show,callback:function(o){t.$set(t.help,"show",o)},expression:"help.show"}},[a("q-modal-layout",{staticStyle:{height:"100vh",width:"100vw"}},[a("iframe",{staticStyle:{height:"100%",width:"100%"},attrs:{src:t.help.src,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}}),a("q-toolbar",{attrs:{slot:"header"},slot:"header"},[a("q-toolbar-title",[t._v(t._s(t.help.title))]),a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{dense:"",flat:"",icon:"close",round:""}})],1)],1)],1)],1)},r=[];e._withStripped=!0;a("96cf");var i=a("c973"),n=a.n(i),s=(a("7f7f"),a("7514"),a("df3a")),c=a("a0fd"),l=a("01f0"),d=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("div",[a("q-modal",{attrs:{value:t.value},on:{input:t.eventoInput}},[a("div",{staticClass:"q-ma-sm"},[a("form",{on:{submit:function(o){return o.preventDefault(),t.importarContatos(o)}}},[a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"row q-mb-md q-headline text-weight-bold"},[t._v("Importar contatos")]),a("q-uploader",{ref:"campoArquivoImportar",attrs:{"auto-expand":"",color:"none",extensions:".xlsx","float-label":"Selecione o arquivo (.xlsx)","hide-upload-button":"","hide-upload-progress":"","inverted-light":"",url:""},on:{add:t.importarAdicionarArquivo}}),t.importar.erro?a("div",{class:["row","q-pa-sm",t.importar.cor]},[t._v(t._s(t.importar.erro))]):a("div",{staticClass:"row q-mt-md justify-start"},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"cloud_download",label:"Baixar arquivo modelo (.xlsx)"},on:{click:t.importarBaixarArquivo}})],1)],1),a("div",{staticClass:"row justify-end"},[a("q-btn",{attrs:{flat:"",color:"primary",label:"Cancelar"},on:{click:function(o){t.eventoInput(!1)}}}),a("q-btn",{attrs:{flat:"",color:"primary",label:"Importar",type:"submit"}})],1)])])]),a("q-modal",{model:{value:t.importar.modalResultado,callback:function(o){t.$set(t.importar,"modalResultado",o)},expression:"importar.modalResultado"}},[a("div",{staticClass:"q-ma-sm"},[a("div",{staticClass:"q-mx-sm q-my-md"},[a("div",{staticClass:"row q-my-md q-headline text-weight-bold"},[t._v("Importar contatos")]),a("div",{staticClass:"row q-my-md"},[t._v(t._s(t.importar.mensagem))]),a("div",{staticClass:"row items-center q-my-md"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"row q-caption flex-center text-faded"},[t._v("Incluídos")]),a("div",{staticClass:"row q-py-xs flex-center text-positive"},[t._v(t._s(t._f("numero")(t.importar.incluidos,0)))])]),a("div",{staticClass:"col-4"},[a("div",{staticClass:"row q-caption flex-center text-faded"},[t._v("Atualizados")]),a("div",{staticClass:"row q-py-xs flex-center text-positive"},[t._v(t._s(t._f("numero")(t.importar.alterados,0)))])]),a("div",{staticClass:"col-4"},[a("div",{staticClass:"row q-caption flex-center text-faded"},[t._v("Erros")]),a("div",{staticClass:"row q-py-xs flex-center text-negative"},[t._v(t._s(t._f("numero")(t.importar.erros,0)))])])]),a("div",{class:["row","q-pa-sm",t.importar.corFinal]},[t._v(t._s(t.importar.mensagemFinal))]),a("div"),t.importar.listaErros.length?a("q-list",{staticClass:"row no-border"},[a("q-item",{staticClass:"col-12 q-px-none"},[a("q-item-main",[a("q-item-tile",{attrs:{sublabel:""}},[a("div",{staticClass:"row justify-around"},[a("div",{staticClass:"col-2 q-caption text-center"},[t._v("Linha")]),a("div",{staticClass:"col-10 q-caption"},[t._v("Erro")])])]),a("q-item-separator",{staticClass:"q-my-xs"}),t._l(t.importar.listaErros,function(o,e){return a("div",{key:e},[a("q-item-tile",{attrs:{sublabel:""}},[a("div",{staticClass:"row justify-around"},[a("div",{staticClass:"col-2 text-center"},[t._v(t._s(t._f("numero")(o.linha,0)))]),a("div",{staticClass:"col-10"},[t._v(t._s(o.mensagem))])])]),a("q-item-separator",{staticClass:"q-my-xs"}),a("q-item-tile",{attrs:{sublabel:""}})],1)})],2)],1)],1):t._e()],1),a("div",{staticClass:"row justify-end"},[a("q-btn",{attrs:{flat:"",color:"primary",label:"Fechar"},on:{click:function(o){t.importar.modalResultado=!1}}})],1)])])],1)},u=[];d._withStripped=!0;a("f751");var m=a("3156"),p=a.n(m),v=(a("cadf"),a("456d"),a("a481"),a("ac4d"),a("8a81"),a("ac6a"),a("478f")),h={id:{tipo:"id"},idContato:{tipo:"id"},logradouro:{tipo:"texto"},numero:{tipo:"texto"},complemento:{tipo:"texto"},condominio:{tipo:"texto"},bairro:{tipo:"texto"},cep:{tipo:"texto"},ibgeCod:{tipo:"texto"},municipio:{tipo:"texto"},uf:{tipo:"texto"},pais:{tipo:"texto"},grupo:{tipo:"texto"},cidadeCodChave:{tipo:"texto"},observacao:{tipo:"texto"},idCidade:{tipo:"id"}},f={id:{tipo:"id"},tipoTelefone:{tipo:"texto"},telefone:{tipo:"texto"},observacao:{tipo:"texto"},idContato:{tipo:"id"}},b={endereco:{lista:h},telefone:{lista:f},id:{tipo:"id"},codigoContato:{tipo:"numerico"},nome:{tipo:"texto"},apelido:{tipo:"texto"},numeroDocumentoNacional:{tipo:"texto"},idContatoAssistente:{tipo:"id"},idContatoIndicacao:{tipo:"id"},idContatoMatriz:{tipo:"id"},idContatoTransportadora:{tipo:"id"},idContatoVendedor:{tipo:"id"},idFormaPagamento:{tipo:"id"},idItemTabelaPreco:{tipo:"id"},tipoDocumentoNacional:{tipo:"texto"},numeroDocumentoEstadual:{tipo:"texto"},numeroDocumentoMunicipal:{tipo:"texto"},site:{tipo:"texto"},email:{tipo:"texto"},emailNfe:{tipo:"texto"},sexo:{tipo:"texto"},segmento:{tipo:"texto"},condutaObservacao:{tipo:"texto"},condutaRestricao:{tipo:"texto"},observacao:{tipo:"texto"},observacaoConsulta:{tipo:"texto"},dataAbertura:{tipo:"dataHora"},dataCadastro:{tipo:"dataHora"},dataAlteracao:{tipo:"dataHora"},dataConsulta:{tipo:"dataHora"},codigoContatoVendedor:{tipo:"numerico"},codigoContatoAssistente:{tipo:"numerico"},codigoContatoIndicacao:{tipo:"numerico"},codigoContatoTransportadora:{tipo:"numerico"},codigoItemTabelaPreco:{tipo:"numerico"},codigoFormaPagamento:{tipo:"numerico"},condicaoPagamento:{tipo:"texto"},codigoAntigo:{tipo:"texto"},imagem:{tipo:"texto"},codigoGrupo:{tipo:"numerico"},ativo:{tipo:"logico"},excluido:{tipo:"logico"},codigoContatoPlataforma:{tipo:"numerico"},regime:{tipo:"texto"},observacaoNFE:{tipo:"texto"},limiteCredito:{tipo:"texto"},nSerieCert:{tipo:"texto"},codigoUsuario:{tipo:"texto"},crmCurvaABC:{tipo:"texto"},crmValorTotalVendasPeriodo:{tipo:"texto"},crmValorTotalOrcamentos:{tipo:"texto"},crmDataUltimoOrcamento:{tipo:"dataHora"},crmValorTotalVendasMesAtual:{tipo:"texto"},crmMetaProximaVenda:{tipo:"texto"},crmMargem:{tipo:"texto"},crmDataPrimeraVenda:{tipo:"dataHora"},crmDiasUltimaVenda:{tipo:"texto"},crmFrequenciaVenda:{tipo:"texto"},crmFrequenciaStatus:{tipo:"texto"},crmStatusFinanceiro:{tipo:"texto"},crmAcao:{tipo:"texto"},crmDataUltimoContato:{tipo:"dataHora"},cobrancaDataPrevisao:{tipo:"dataHora"},creditoUtilizado:{tipo:"decimal"},creditoDevolucao:{tipo:"decimal"},creditoDisponivel:{tipo:"decimal"},idUsuario:{tipo:"id"}},C=b,x=a("3e8a"),g=a("8149"),q=a("ed08"),w={alterados:0,arquivo:null,cor:"text-negative",corFinal:"",erro:"",erros:0,incluidos:0,listaErros:[],mensagem:"",mensagemFinal:"",modalResultado:!1},y={data:function(){return{importar:Object(q["clonarV2"])(w)}},watch:{value:function(){this.value&&(this.importar=Object(q["clonarV2"])(w),this.$refs.campoArquivoImportar.reset())}},methods:{eventoInput:function(t){this.$emit("input",t)},importarAdicionarArquivo:function(t){q["gconsole"].log("ImportarContatos","importarAdicionarArquivo"),this.importar.erro="",this.importar.arquivo=t[0]},importarArquivoXlsx:function(){var t=n()(regeneratorRuntime.mark(function t(o){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,q["gconsole"].log("ImportarContatos","importarArquivoXlsx",this.importar.arquivo.name),this.importar.modalResultado=!0,this.eventoInput(!1),this.importar.mensagem="Carregando o arquivo .xlsx",t.next=7,Object(x["a"])().contato.toArray();case 7:return this.importarLista=t.sent,a={Contato:C,ContatoTelefone:C.telefone.lista,ContatoEndereco:C.endereco.lista},t.next=11,Object(v["a"])(o.target.result,a,this.importarCallbackParcial,this.importarCallbackErro,this.importarCallbackFinal);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),t.t0.name&&"ErroValidacao"===t.t0.name?(this.importar.erro=t.t0.message,this.$q.notifyError(t.t0.message,t.t0)):(this.importar.erro="Ocorreu erro ao importar arquivo xlsx",this.$q.notifyError(this.importar.erro,t.t0));case 16:case"end":return t.stop()}},t,this,[[0,13]])}));return function(o){return t.apply(this,arguments)}}(),importarBaixarArquivo:function(){q["gconsole"].log("ImportarContatos","importarBaixarArquivo"),window.open("statics/downloads/B15-Importar-ou-Atualizar-Contatos.xlsx","_self")},importarCallbackErro:function(){var t=n()(regeneratorRuntime.mark(function t(o,a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.importar.erros++,q["gconsole"].log("ImportarContatos","importarCallbackErro2",a),this.importar.listaErros.length<20&&this.importar.listaErros.push({linha:o,mensagem:a});case 3:case"end":return t.stop()}},t,this)}));return function(o,a){return t.apply(this,arguments)}}(),importarCallbackFinal:function(){var t=n()(regeneratorRuntime.mark(function t(o){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:q["gconsole"].log("ImportarContatos","Importação concluida"),this.importar.incluidos+this.importar.alterados>0?this.importar.erros>0?(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importação realizada parcialmente!"):(this.importar.corFinal="bg-positive text-white",this.importar.mensagemFinal="Importação concluída com sucesso!"):this.importar.erros>0?(this.importar.corFinal="text-negative",this.importar.mensagemFinal="Importação não realizada!"):(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importação não realizada!");case 2:case"end":return t.stop()}},t,this)}));return function(o){return t.apply(this,arguments)}}(),acertarEnderecos:function(t){var o=!0,a=!1,e=void 0;try{for(var r,i=t.atual.endereco[Symbol.iterator]();!(o=(r=i.next()).done);o=!0){var n=r.value;n.id=Object(q["uuid"])(),n.idContato=t.atual.id;var s=(n.cep||"").replace(/[^0-9]/g,"");8===s.length&&(n.cep=s.substr(0,5)+"-"+s.substr(5,3)),n.pais||(n.pais="Brasil")}}catch(t){a=!0,e=t}finally{try{o||null==i.return||i.return()}finally{if(a)throw e}}var c=!0,l=!1,d=void 0;try{for(var u,m=function(){var o=u.value,a=t.atual.endereco.find(function(t){var a=Object(q["diferencaNivel1"])(t,o);return delete a.id,0===Object.keys(a).length});a?a.id=o.id:t.atual.endereco.push(o)},p=(t.original.endereco||[])[Symbol.iterator]();!(c=(u=p.next()).done);c=!0)m()}catch(t){l=!0,d=t}finally{try{c||null==p.return||p.return()}finally{if(l)throw d}}},acertarTelefones:function(t){var o=!0,a=!1,e=void 0;try{for(var r,i=t.atual.telefone[Symbol.iterator]();!(o=(r=i.next()).done);o=!0){var n=r.value;n.id=Object(q["uuid"])(),n.idContato=t.atual.id}}catch(t){a=!0,e=t}finally{try{o||null==i.return||i.return()}finally{if(a)throw e}}var s=!0,c=!1,l=void 0;try{for(var d,u=function(){var o=d.value,a=t.atual.telefone.find(function(t){var a=Object(q["diferencaNivel1"])(t,o);return delete a.id,0===Object.keys(a).length});a?a.id=o.id:t.atual.telefone.push(o)},m=(t.original.telefone||[])[Symbol.iterator]();!(s=(d=m.next()).done);s=!0)u()}catch(t){c=!0,l=t}finally{try{s||null==m.return||m.return()}finally{if(c)throw l}}},importarCallbackParcial:function(){var t=n()(regeneratorRuntime.mark(function t(o){var a,e,r,i,n,s,c,l,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(q["gconsole"].log("ImportarContatos","importarCallbackParcial",o),a=o.Contato[0],o.ContatoEndereco&&(a.endereco=o.ContatoEndereco),o.ContatoTelefone&&(a.telefone=o.ContatoTelefone),e=o.chaves.length>0?function(t){return o.chaves.reduce(function(o,e){return o&&t[e]===a[e]},!0)}:function(t){return!1},r=this.importarLista.filter(e),!a.numeroDocumentoNacional){t.next=19;break}if(i=this.importarLista.filter(function(t){return t.numeroDocumentoNacional===a.numeroDocumentoNacional}),!(i.length>1)){t.next=12;break}throw new q["ErroValidacao"]("NumeroDocumentoNacional deve ser único (".concat(a.numeroDocumentoNacional,")"));case 12:if(1!==i.length){t.next=19;break}if(0!==r.length){t.next=17;break}throw new q["ErroValidacao"]("NumeroDocumentoNacional deve ser único (".concat(a.numeroDocumentoNacional,")"));case 17:if(i[0].id===r[0].id){t.next=19;break}throw new q["ErroValidacao"]("NumeroDocumentoNacional deve ser único (".concat(a.numeroDocumentoNacional,")"));case 19:if(n=Object(q["dataAtual"])(),0!==r.length){t.next=31;break}return s=p()({},g["a"].contato.vazio,{dataCadastro:n,dataAlteracao:n},a,{id:Object(q["uuid"])()}),c={atual:s,original:{}},this.acertarEnderecos(c),this.acertarTelefones(c),t.next=27,g["a"].contato.grava(c);case 27:this.importarLista.push(s),this.importar.incluidos++,t.next=46;break;case 31:if(1!==r.length){t.next=44;break}return t.next=34,g["a"].contato.leCompletoV2(r[0].id);case 34:return l=t.sent,a.id=l.atual.id,Object.assign(l.atual,a),this.acertarEnderecos(l),this.acertarTelefones(l),t.next=41,g["a"].contato.grava(l);case 41:this.importar.alterados++,t.next=46;break;case 44:throw d=o.chaves.map(function(t){return t+": "+a[t]}).join(", "),new q["ErroValidacao"]("Existem ".concat(r.length," contatos no banco com a chave (").concat(d,")"));case 46:case"end":return t.stop()}},t,this)}));return function(o){return t.apply(this,arguments)}}(),importarContatos:function(){var t=this;q["gconsole"].log("ImportarContatos","importarContatos");try{if(this.importar.arquivo){var o=new FileReader;o.onload=this.importarArquivoXlsx,o.onerror=function(){t.importar.erro="Falha na leitura do arquivo",t.$q.notifyError(t.importar.erro)},o.readAsBinaryString(this.importar.arquivo)}else this.importar.erro="Favor selecionar o arquivo para importação"}catch(t){this.importar.erro="Ocorreu erro ao importar contatos",this.$q.notifyError(this.importar.erro,t)}}},props:{value:{required:!0,type:Boolean}},created:function(){q["gconsole"].log("ImportarContatos","created()")}},k=y,_=a("2877"),O=Object(_["a"])(k,d,u,!1,null,null,null);O.options.__file="ImportarContatos.vue";var $=O.exports,A=a("41ff"),I=a("dc06"),E=a("9408"),D={components:{Avatar:s["a"],Badge:c["a"],BarraTopo:l["a"],ImportarContatos:$,PromptContatoNovo:A["a"],MenuAbas:I["a"]},computed:{badge:function(){return this.dbContato.selecionado.ativo?this.dbContato.selecionado.condutaRestricao?{cor:"negative",rotulo:"Restrição"}:!!this.dbContato.selecionado.condutaObservacao&&{cor:"warning",rotulo:"Observação"}:{cor:"faded",rotulo:"Excluído"}},badgeDetalhes:function(){var t=this.contato,o=t.ativo,a=t.condutaRestricao,e=t.condutaObservacao;return o&&(a||e)||!1},podeAcessar:function(){return!this.contatoConsumidor&&!!this.contato},telefone:function(){var t=this.contato.telefone;return!(!t||!t.length)&&(t=t.find(function(t){return"Principal"===t.tipo})||t[0],t.telefone)},usuario:function(){return g["a"].usuario.logado}},data:function(){return{dbContato:g["a"].contato,contato:g["a"].contato.vazio,carregando:!1,combinarContatosModal:!1,contatosAtivos:[],contatosInativos:[],contatosInativosModal:!1,contatosModal:!1,modalImportar:!1,contatoConsumidor:!1,sistemaPai:"",sincronismoStatus:E["a"].status,help:{show:!1,src:"",title:"",map:{cadastroFornecedores:{src:"https://www.youtube.com/embed/oZkaV8OlJmE",title:"Videoaula OptiSoul: Cadastro de Fornecedores"},cadastroMedicos:{src:"https://www.youtube.com/embed/FY91zACYQVc",title:"Videoaula OptiSoul: Cadastro de Médicos"},cadastroClientes:{src:"https://www.youtube.com/embed/Zr1Xc4BQJNU",title:"Videoaula OptiSoul: Cadastro de Clientes"},vendas:{src:"https://www.youtube.com/embed/kYy9IE16bkA",title:"Videoaula OptiSoul: Vendas (com Medidas de DNP e Altura)"},faturaCompleta:{src:"https://www.youtube.com/embed/M3QSCSH4SWc",title:"Videoaula OptiSoul: Fatura completa"},faturaComSinal:{src:"https://www.youtube.com/embed/_w6OivCnwv4",title:"Videoaula OptiSoul: Fatura (com sinal)"},pupilometro:{src:this.$q.platform.is.mobile?"https://www.youtube.com/embed/kYy9IE16bkA?start=2661":"https://www.youtube.com/embed/kYy9IE16bkA?start=1214",title:this.$q.platform.is.mobile?"Videoaula OptiSoul: Pupilômetro - Celular":"Videoaula OptiSoul: Pupilômetro - Desktop"}}}}},methods:{showHelp:function(t){this.help.src=this.help.map[t].src,this.help.title=this.help.map[t].title,this.help.show=!0},refresher:function(){this.$router.go()},abrirContato:function(t){t&&this.$router.push({name:this.$route.name,params:{id:t}}),this.contatosInativosModal=!1,this.contatosModal=!1},adicionarContato:function(){var t=n()(regeneratorRuntime.mark(function t(){var o,a,e,r,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=!!this.$refs.componentefilho&&!!this.$refs.componentefilho.desejaDescartar,!t.t0){t.next=5;break}return t.next=4,this.$refs.componentefilho.desejaDescartar();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}return t.abrupt("return");case 7:return t.prev=7,t.next=10,this.$q.dialog({cancel:!0,message:"Qual é o nome completo?",ok:"Criar",preventClose:!0,prompt:{type:"text"},title:"Cadastrar contato"});case 10:if(o=t.sent,o){t.next=13;break}return t.abrupt("return");case 13:t.next=19;break;case 15:return t.prev=15,t.t1=t["catch"](7),this.$q.notifyPositive("Operação cancelada."),t.abrupt("return");case 19:if(this.$q.loading.show(),t.prev=20,a="",t.t3=!g["a"].usuario.logado.administrador,!t.t3){t.next=27;break}return t.next=26,g["a"].permissao.objetoClienteSistema("Diretiva_Contatos_AcessaTodosContatos");case 26:t.t3=t.sent;case 27:if(t.t2=t.t3,!t.t2){t.next=32;break}return t.next=31,g["a"].permissao.objeto("Diretiva_Contatos_AcessaTodosContatos");case 31:t.t2=!t.sent;case 32:if(!t.t2){t.next=40;break}if(e=g["a"].usuario.logado.codigoContato,!e){t.next=40;break}return t.next=37,Object(x["a"])().contato.where({codigoContato:e}).toArray();case 37:t.t4=function(t){return t.id},r=t.sent.find(t.t4),r&&(a=r.id);case 40:return i={id:Object(q["uuid"])(),nome:o,ativo:!0,idContatoVendedor:a},t.next=43,this.$store.dispatch("salvarContato",i);case 43:return t.next=45,this.$store.dispatch("carregarContato",i.id);case 45:this.contato=g["a"].contato.selecionado=i,this.$router.push({name:"Atendimento",params:{id:i.id}}),t.next=52;break;case 49:t.prev=49,t.t5=t["catch"](20),this.$q.notifyError("Erro ao cadastrar contato.",t.t5);case 52:return t.prev=52,this.$q.loading.hide(),t.finish(52);case 55:case"end":return t.stop()}},t,this,[[7,15],[20,49,52,55]])}));return function(){return t.apply(this,arguments)}}(),buscarContato:function(){var t=n()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=!!this.$refs.componentefilho&&!!this.$refs.componentefilho.desejaDescartar,!t.t0){t.next=5;break}return t.next=4,this.$refs.componentefilho.desejaDescartar();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}return t.abrupt("return");case 7:this.contatosModal=!0;case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),buscarContatoExcluido:function(){var t=n()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=!!this.$refs.componentefilho&&!!this.$refs.componentefilho.desejaDescartar,!t.t0){t.next=5;break}return t.next=4,this.$refs.componentefilho.desejaDescartar();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}return t.abrupt("return");case 7:this.contatosInativosModal=!0;case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),carregarContato:function(){var t=n()(regeneratorRuntime.mark(function t(){var o,a,e,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.carregando){t.next=2;break}return t.abrupt("return");case 2:if(this.carregando=!0,t.prev=3,o=this.$route.params.id,o="0"===o?null:o,a={},this.contatoConsumidor=!1,!o){t.next=13;break}return t.next=11,g["a"].contato.le({id:o});case 11:a=t.sent,o=(a||{}).id;case 13:return t.next=15,g["a"].configuracoes.leValorNumerico("venda.codigoconsumidor");case 15:if(e=t.sent,a.codigoContato!==e){t.next=20;break}this.contatoConsumidor=!0,t.next=28;break;case 20:if(o||!e){t.next=28;break}return t.next=23,Object(x["a"])().contato.where({codigoContato:e}).toArray();case 23:r=t.sent,Object(q["verificarErro"])(!r.length||!r[0].id,"Contato consumidor não encontrado."),a=r[0],o=a.id,this.contatoConsumidor=!0;case 28:if(o){t.next=30;break}return t.abrupt("return");case 30:return t.next=32,this.$store.dispatch("carregarContato",o);case 32:this.contato=g["a"].contato.selecionado=a,localStorage.setItem("contatoSelecionado",o),t.next=39;break;case 36:t.prev=36,t.t0=t["catch"](3),this.$q.notifyError("Erro ao carregar contato",t.t0);case 39:return t.prev=39,this.carregando=!1,t.finish(39);case 42:case"end":return t.stop()}},t,this,[[3,36,39,42]])}));return function(){return t.apply(this,arguments)}}(),copiarUid:function(){var t=this.$refs.uid;t.type="text";try{t.select(),document.execCommand("copy"),this.$q.notify({message:"Copiado!",type:"info"})}catch(t){this.$q.notify("Erro ao copiar.")}t.type="hidden",window.getSelection().removeAllRanges()},selecionarCombinarContatos:function(){var t=n()(regeneratorRuntime.mark(function t(o){var a,e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.combinarContatosModal=!1,t.prev=1,t.next=4,this.$q.dialog({cancel:!0,color:"negative",message:"Ao continuar você irá combinar todas as informações dos dois contatos em apenas um contato.",ok:"Combinar",title:"Tem certeza?"});case 4:t.next=9;break;case 6:return t.prev=6,t.t0=t["catch"](1),t.abrupt("return");case 9:return this.$q.loading.show(),t.prev=10,a="\n        mutation contatoCombinar(\n          $bancoDeDados: String!,\n          $token: String,\n          $idContatoCombinar: ID!,\n          $idContatoRemover: ID!\n        ) {\n          contatoCombinar(\n            bancoDeDados: $bancoDeDados,\n            token: $token,\n            idContatoCombinar: $idContatoCombinar,\n            idContatoRemover: $idContatoRemover\n          ) {\n            sucesso\n            mensagem\n            codigo\n          }\n        }",t.next=14,Object(q["executarGraphql"])(a,{idContatoCombinar:this.contato.id,idContatoRemover:o});case 14:e=t.sent,Object(q["tratarErroGraphql"])(e,"contatoCombinar"),this.$q.notifyPositive("Os contatos foram combinados com sucesso."),t.next=22;break;case 19:t.prev=19,t.t1=t["catch"](10),this.$q.notifyError("Ocorreu um erro ao combinar contatos",t.t1);case 22:return t.prev=22,this.$q.loading.hide(),t.finish(22);case 25:case"end":return t.stop()}},t,this,[[1,6],[10,19,22,25]])}));return function(o){return t.apply(this,arguments)}}()},watch:{"$route.params.id":function(t){this.carregarContato()},"sincronismoStatus.concluidoErp":function(){this.carregarContato()}},created:function(){this.sistemaPai=Object(q["sistemaPai"])(),this.carregarContato()}},V=D,j=(a("64ad"),Object(_["a"])(V,e,r,!1,null,null,null));j.options.__file="Atendimento.vue";o["default"]=j.exports},afd8:function(t,o,a){}}]);