(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["717b94fd"],{"01ea":function(e,a,t){"use strict";var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-modal",{attrs:{value:e.value},on:{input:e.eventoInput}},[t("q-modal-layout",[t("q-toolbar",{attrs:{slot:"header"},slot:"header"},[t("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{dense:"",flat:"",icon:"arrow_back",round:""}}),t("q-toolbar-title",[e._v("Trocar status da OS")])],1),t("form",{on:{submit:function(a){return a.preventDefault(),e.eventoConfirmar(a)}}},[t("div",{staticClass:"layout-padding"},[t("div",{staticClass:"row gutter-x-sm"},[t("campo",{staticClass:"col-12",attrs:{somenteLeitura:"",rotulo:"Cliente"},model:{value:e.dados.nomeCliente,callback:function(a){e.$set(e.dados,"nomeCliente",a)},expression:"dados.nomeCliente"}})],1),t("div",{staticClass:"row gutter-x-sm"},[t("campo",{staticClass:"col-12",attrs:{somenteLeitura:"",rotulo:"De"},model:{value:e.dados.statusAtual,callback:function(a){e.$set(e.dados,"statusAtual",a)},expression:"dados.statusAtual"}})],1),t("div",{staticClass:"row gutter-x-sm"},[t("campo",{staticClass:"col-12",attrs:{somenteLeitura:"",rotulo:"Para"},model:{value:e.dados.statusNovo,callback:function(a){e.$set(e.dados,"statusNovo",a)},expression:"dados.statusNovo"}})],1),t("div",{staticClass:"row gutter-x-sm"},[t("campo",{staticClass:"col-12",attrs:{maxlength:"50",rotulo:"Observação"},model:{value:e.dados.observacao,callback:function(a){e.$set(e.dados,"observacao","string"===typeof a?a.trim():a)},expression:"dados.observacao"}})],1)]),t("q-toolbar",{attrs:{slot:"footer",color:"light"},slot:"footer"},[t("q-toolbar-title",[t("div",{staticClass:"row justify-end"},[t("q-btn",{attrs:{flat:"",color:"primary",label:"Cancelar"},on:{click:e.eventoCancelar}}),t("q-btn",{attrs:{flat:"",color:"primary",type:"submit",label:"Trocar"}})],1)])],1)],1)],1)],1)},r=[];o._withStripped=!0;var s=t("88db"),n=t("ed08"),i={components:{Campo:s["a"]},data:function(){return{confirmado:!1}},methods:{eventoConfirmar:function(){n["gconsole"].log("OSTrocarStatus","eventoConfirmar",this.dados),this.confirmado=!0,this.eventoInput(!1),this.$emit("confirmar",this.dados)},eventoCancelar:function(){n["gconsole"].log("OSTrocarStatus","eventoCancelar",this.dados),this.confirmado=!1,this.eventoInput(!1)},eventoInput:function(e){this.$emit("input",e)}},props:{value:{required:!0,type:Boolean},dados:{required:!0,type:Object}},watch:{value:function(e){e?this.confirmado=!1:this.confirmado||this.$emit("cancelar",this.dados)}}},l=i,c=t("2877"),u=Object(c["a"])(l,o,r,!1,null,null,null);u.options.__file="OSTrocarStatus.vue";a["a"]=u.exports},4984:function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-layout",{staticClass:"AdmOS"},[t("barra-topo"),t("q-page-container",[t("q-page",[t("q-toolbar",{staticClass:"q-py-sm q-my-sm",attrs:{color:"none"}},[t("q-toolbar-title",[e._v("Kanban")])],1),t("q-card",{staticClass:"row no-shadow"},[t("q-toolbar",{staticClass:"no-shadow q-pa-none",attrs:{"text-color":"black",color:"transparent"}},[t("q-toolbar-title",{staticClass:"q-pa-none"},[t("div",{staticClass:"filters row q-pa-sm q-ma-md bg-white",staticStyle:{"border-radius":"5px","min-height":"50px"}},[t("div",{staticClass:"col-auto"},[t("q-btn",{staticClass:"no-shadow u-semClique",attrs:{icon:"filter_list",round:"",color:"faded"}})],1),t("div",{staticClass:"col-10 col-md-5 q-ml-sm"},[t("q-search",{attrs:{placeholder:"Filtrar cliente ou responsável"},on:{input:e.filtraDebounce},model:{value:e.fraseFiltro,callback:function(a){e.fraseFiltro=a},expression:"fraseFiltro"}})],1),t("div",{staticClass:"col-6 col-md q-pl-none"},[t("q-select",{staticClass:"q-mx-sm",attrs:{options:e.prazoOpcoes,clearable:"",placeholder:"Filtrar por prazo"},model:{value:e.prazoSelecionado,callback:function(a){e.prazoSelecionado=a},expression:"prazoSelecionado"}})],1),t("div",{staticClass:"col-6 col-md q-pl-none"},[t("q-select",{staticClass:"q-mx-sm",attrs:{options:e.empresaOpcoes,clearable:"",placeholder:"Filtrar por empresa"},on:{input:e.refazFiltro},nativeOn:{click:function(a){return e.empresaOpcoesCarregar(a)}},model:{value:e.empresaSelecionada,callback:function(a){e.empresaSelecionada=a},expression:"empresaSelecionada"}})],1)])])],1)],1),t("div",{staticClass:"row overflowXOS"},e._l(e.listas,function(a,o){return t("div",{key:o,staticClass:"no-shadow q-pa-sm col"},[t("div",{staticClass:"bg-white q-pa-xs"},[t("q-toolbar",{staticClass:"no-shadow q-pa-none",attrs:{"text-color":"black",color:"transparent"}},[t("q-toolbar-title",{staticClass:"q-py-none"},[e._v("\n                "+e._s(o)+"\n              ")])],1),"Entregue"===o?t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 q-pl-none"},[t("campo",{staticClass:"q-mx-sm",attrs:{rotulo:"Início",tipo:"data"},model:{value:e.entregueInicio,callback:function(a){e.entregueInicio=a},expression:"entregueInicio"}}),t("campo",{staticClass:"q-mx-sm",attrs:{rotulo:"Fim",tipo:"data"},model:{value:e.entregueFim,callback:function(a){e.entregueFim=a},expression:"entregueFim"}})],1)]):e._e(),t("draggable",{staticClass:"dragAreaOS bg-white",attrs:{delay:"400",list:a,group:"osGroup",draggable:".extratoOS"},on:{end:e.eventoEnd}},e._l(a,function(a){return!a.mostra||null!==e.prazoSelecionado&&e.prazoSelecionado!==a.corBorda?e._e():t("q-card",{key:a.codigoDocumento,staticClass:"q-pa-sm q-mb-md shadow-2 extratoOS",class:a.corBorda},[t("q-card-title",{staticClass:"q-py-none"},[e._v("\n                  "+e._s(a.nomeCliente)+"\n                  "),t("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v("\n                    Empresa: "+e._s(a.descricaoEmpresa)+"\n                  ")]),t("div",{attrs:{slot:"right"},slot:"right"},[t("small",{staticStyle:{display:"block"}},[e._v("Venda: "+e._s(a.numeroVenda))]),t("small",{staticStyle:{display:"block"}},[e._v("OS: "+e._s(a.numeroOS))])])]),t("q-card-separator",{staticClass:"q-my-sm"}),t("q-card-main",{staticClass:"row q-py-none"},[e._v("\n                  Técnico: "+e._s(a.nomeResponsavel)),t("br"),e._v("\n                  Data de Emissao: "+e._s(e._f("data")(a.dataHoraEmissao))),t("br"),a.dataHoraRetorno?[e._v("Data de Retorno:\n                    "+e._s(e._f("data")(a.dataHoraRetorno))),t("br")]:e._e(),e._v("\n                  Previsão de Entrega: "+e._s(e._f("data")(a.dataHoraPrevisto))),t("br")],2)],1)}))],1)])})),t("OS-trocar-status",{attrs:{dados:e.trocarStatusDados},on:{confirmar:e.eventoConfirmarTroca,cancelar:e.eventoCancelarTroca},model:{value:e.trocarStatusModal,callback:function(a){e.trocarStatusModal=a},expression:"trocarStatusModal"}})],1)],1)],1)},r=[];o._withStripped=!0;t("6762"),t("2fdb"),t("c5f6"),t("28a5");var s=t("3156"),n=t.n(s),i=(t("cadf"),t("ac4d"),t("8a81"),t("ac6a"),t("96cf"),t("c973")),l=t.n(i),c=t("01f0"),u=t("88db"),d=t("01ea"),m=t("310e"),p=t.n(m),v=t("ed08"),f=t("8149"),g=t("2ef0"),b={components:{BarraTopo:c["a"],Campo:u["a"],OSTrocarStatus:d["a"],draggable:p.a},data:function(){return{empresaOpcoes:[],empresaSelecionada:null,entregueInicio:new Date(new Date(Object(v["dataAtual"])()).toDateString()),entregueFim:new Date(new Date(Object(v["dataAtual"])()).toDateString()),fraseFiltro:"",listas:{Processando:[],Entregue:[]},trocarStatusDados:{},trocarStatusModal:!1,periodoOpcoes:[{label:"Hoje",value:0},{label:"Uma semana",value:7},{label:"Um mês",value:30}],prazoSelecionado:null,prazoOpcoes:[{label:"Em dia",value:"bordaVerdeOS"},{label:"Entrega para esta semana",value:"bordaAmarelaOS"},{label:"Entrega atrasada",value:"bordaVermelhaOS"}]}},methods:{eventoEnd:function(){var e=l()(regeneratorRuntime.mark(function e(){var a,t,o,r,s,n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(this.listas);case 1:if((e.t1=e.t0()).done){e.next=34;break}a=e.t1.value,t=!0,o=!1,r=void 0,e.prev=6,s=this.listas[a][Symbol.iterator]();case 8:if(t=(n=s.next()).done){e.next=18;break}if(i=n.value,i.status===a){e.next=15;break}return v["gconsole"].log("AdmOS","eventoEnd De:",i.status,"Para:",a,"codigo:",i.codigoDocumento),this.trocarStatusDados={codigoContatoResponsavel:i.codigoContatoResponsavel,codigoDocumento:i.codigoDocumento,codigoUsuario:null,nomeCliente:i.nomeCliente,observacao:"",statusAtual:i.status,statusNovo:a},this.trocarStatusModal=!0,e.abrupt("return");case 15:t=!0,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t2=e["catch"](6),o=!0,r=e.t2;case 24:e.prev=24,e.prev=25,t||null==s.return||s.return();case 27:if(e.prev=27,!o){e.next=30;break}throw r;case 30:return e.finish(27);case 31:return e.finish(24);case 32:e.next=1;break;case 34:case"end":return e.stop()}},e,this,[[6,20,24,32],[25,,27,31]])}));return function(){return e.apply(this,arguments)}}(),eventoConfirmarTroca:function(){var e=l()(regeneratorRuntime.mark(function e(a){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return v["gconsole"].log("AdmOS","eventoConfirmaTroca",n()({},a)),this.$q.loading.show(),e.prev=2,e.next=5,f["a"].usuario.leOnline(f["a"].usuario.logado.id);case 5:if(e.t1=e.sent,e.t1){e.next=8;break}e.t1=[];case 8:if(e.t0=e.t1[0],e.t0){e.next=11;break}e.t0={};case 11:return t=e.t0,a.codigoUsuario=t.codigoUsuario,e.next=15,f["a"].os.trocaStatusOnline(a);case 15:this.$q.notifyPositive("Status trocado com sucesso"),this.atualiza(),e.next=22;break;case 19:e.prev=19,e.t2=e["catch"](2),this.$q.notifyError("Erro na troca de status",e.t2);case 22:return e.prev=22,this.$q.loading.hide(),e.finish(22);case 25:case"end":return e.stop()}},e,this,[[2,19,22,25]])}));return function(a){return e.apply(this,arguments)}}(),eventoCancelarTroca:function(e){v["gconsole"].log("AdmOS","eventoCancelarTroca",e),this.atualiza()},empresaOpcoesCarregar:function(){var e=l()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return v["gconsole"].log("AdmOS","empresaOpcoesCarregar()"),e.next=3,f["a"].empresa.leOnline();case 3:e.t0=function(e){return{label:e.nome,value:e.codigoContato}},this.empresaOpcoes=e.sent.map(e.t0);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),filtraDebounce:function(){Object(g["debounce"])(this.refazFiltro,700)()},refazFiltro:function(){v["gconsole"].log("AdmOSs","refazFiltro()",this.fraseFiltro,this.empresaSelecionada);var e=Object(v["removerAcentos"])(this.fraseFiltro.toUpperCase()).split(" ").filter(function(e){return""!==e});for(var a in this.listas){var t=!0,o=!1,r=void 0;try{for(var s,n=this.listas[a][Symbol.iterator]();!(t=(s=n.next()).done);t=!0){var i=s.value,l=Object(v["removerAcentos"])(i.id.toUpperCase()+i.nomeCliente.toUpperCase()+i.nomeResponsavel.toUpperCase()+" "+String(i.numeroVenda)+"  "+String(i.numeroOS)+" "),c=!0,u=!0,d=!1,m=void 0;try{for(var p,f=e[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;c=isNaN(Number(g))?c&&l.includes(g):c&&l.includes(" "+g+" ")}}catch(e){d=!0,m=e}finally{try{u||null==f.return||f.return()}finally{if(d)throw m}}this.empresaSelecionada&&(c=c&&this.empresaSelecionada===i.codigoEmpresa),i.mostra=c}}catch(e){o=!0,r=e}finally{try{t||null==n.return||n.return()}finally{if(o)throw r}}}},atualiza:function(){var e=l()(regeneratorRuntime.mark(function e(){var a,t,o,r,s,n,i,l,c,u,d,m,p,b,h,S,C,w,O,x,q,y,k;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f["a"].os.leAdmOSOnline({entregueInicio:this.entregueInicio,entregueFim:this.entregueFim});case 3:return a=e.sent,v["gconsole"].log("AdmOS","atualiza()",a.length),Object(v["verificarAlerta"])(!a||!a.length,"Não há ordens de serviço"),e.next=8,f["a"].configuracoes.le({nome:"vendas.os.status"});case 8:for(t=e.sent,t=t.filter(function(e){return!["Processando","Entregue"].includes(e.texto)}),o={Processando:[]},r=!0,s=!1,n=void 0,e.prev=14,i=Object(g["orderBy"])(t,"valor","asc").map(function(e){return e.texto})[Symbol.iterator]();!(r=(l=i.next()).done);r=!0)c=l.value,o[c]=[];e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](14),s=!0,n=e.t0;case 22:e.prev=22,e.prev=23,r||null==i.return||i.return();case 25:if(e.prev=25,!s){e.next=28;break}throw n;case 28:return e.finish(25);case 29:return e.finish(22);case 30:for(o["Entregue"]=[],u=!0,d=!1,m=void 0,e.prev=34,p=a[Symbol.iterator]();!(u=(b=p.next()).done);u=!0)h=b.value,S="bordaVerdeOS","Entregue"===h.status?h.dataHoraPrevisto&&h.dataHoraFinalizado&&(C=new Date(new Date(h.dataHoraPrevisto).toDateString()),w=new Date(new Date(h.dataHoraFinalizado).toDateString()),O=(w-C)/864e5,S=O>=0?"bordaVermelhaOS":O>-7?"bordaAmarelaOS":"bordaVerdeOS"):h.dataHoraPrevisto&&(x=new Date(new Date(h.dataHoraPrevisto).toDateString()),q=new Date((new Date).toDateString()),y=(q-x)/864e5,S=y>=0?"bordaVermelhaOS":y>-7?"bordaAmarelaOS":"bordaVerdeOS"),k={id:h.id,codigoCompra:h.codigoCompra||"-",codigoContatoResponsavel:h.codigoContatoResponsavel,codigoDocumento:h.codigoDocumento,codigoEmpresa:h.codigoEmpresa,descricaoEmpresa:h.descricaoEmpresa,corBorda:S,dataHoraEmissao:new Date(h.dataHoraEmissao),dataHoraFinalizado:new Date(h.dataHoraFinalizado),dataHoraRetorno:new Date(h.dataHoraRetorno),dataHoraPrevisto:new Date(h.dataHoraPrevisto),mostra:!0,nomeCliente:h.nomeCliente||"-",nomeResponsavel:h.nomeResponsavel||"-",numeroVenda:h.numeroVenda||"-",numeroOS:h.numeroOS||"-",status:h.status},o[h.status]&&o[h.status].push(k);e.next=42;break;case 38:e.prev=38,e.t1=e["catch"](34),d=!0,m=e.t1;case 42:e.prev=42,e.prev=43,u||null==p.return||p.return();case 45:if(e.prev=45,!d){e.next=48;break}throw m;case 48:return e.finish(45);case 49:return e.finish(42);case 50:this.listas=o,this.refazFiltro(),e.next=57;break;case 54:e.prev=54,e.t2=e["catch"](0),this.$q.notifyError("Erro na consulta online de oss",e.t2);case 57:case"end":return e.stop()}},e,this,[[0,54],[14,18,22,30],[23,,25,29],[34,38,42,50],[43,,45,49]])}));return function(){return e.apply(this,arguments)}}()},watch:{entregueInicio:function(){v["gconsole"].log("AdmOSs","entregueInicio"),this.atualiza()},entregueFim:function(){v["gconsole"].log("AdmOSs","entregueFim"),this.atualiza()}},created:function(){v["gconsole"].log("AdmOSs","created()"),this.atualiza()}},h=b,S=(t("ce87"),t("2877")),C=Object(S["a"])(h,o,r,!1,null,"ee7c2fea",null);C.options.__file="Kanban.vue";a["default"]=C.exports},ce87:function(e,a,t){"use strict";var o=t("de69"),r=t.n(o);r.a},de69:function(e,a,t){}}]);