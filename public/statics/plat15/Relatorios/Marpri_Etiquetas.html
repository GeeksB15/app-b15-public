<!DOCTYPE html>
<html>
<head>
	<style type="text/css">

		@page  
		{ 
			width: 8cm;
			height: 3.8cm;
			margin: 2mm 2mm 2mm 6mm;  
		} 
		.etiqueta {
			width: 8cm;
			height: 3.6cm;
			border: 0px solid #000000;
			font-family: Arial, sans-serif;
			font-size: 10pt;
			padding: 5px;
			font-weight: bold;
			margin: 0px;
		}

		.etiqueta span {
			font-weight: normal;
		}

	</style>
	<style type="text/css" media="print">
		.etiqueta {
			page-break-before: always;
		}

		.etiqueta:first-child {
			page-break-before: avoid;
		}

	</style>
	<title>Impressão - Etiquetas</title>
	<script  src="/Scripts/jquery-2.1.4.js">
	</script>

	<script src="/Restricted/Geeks.ERP.BasicReport.js">
	</script>

	<script type="text/javascript">

	$(document).ready(function(){

			var codigoDocumento = getParameterByName("CodigoPedido");

			var banco = "Marpri";
			var url = decodeURIComponent(getParameterByName("URLServidor"));
			var usuario = getParameterByName("CodigoUsuario");

			consultaSql = GeeksSQL("Select D.DescricaoContato as Cliente, D.DescricaoContatoEndereco as Endereco, IsNull(T.Apelido,'') as Transportadora, D.NumeroVolumeTransporte, D.TipoTransporte, D.Numero from Documento D left join Contato T on D.CodigoContatoTransportadora = T.CodigoContato where D.CodigoDocumento = " + codigoDocumento, false, url, banco, usuario);
			
			var numeroEtiquetas = consultaSql.Records[0].NumeroVolumeTransporte;
			if (numeroEtiquetas == 0) numeroEtiquetas = 1;

			/*
			1=Transportadora
			2=Entrega Própria
			3=Entrega na Viagem
			4=Retirar
			*/
			
			var tipoTransporte;
			if (consultaSql.Records[0].TipoTransporte == 1)
				tipoTransporte = 'Transportadora: <span id="transportadora">'+consultaSql.Records[0].Transportadora+'</span><br>';
			else if (consultaSql.Records[0].TipoTransporte == 2)
				tipoTransporte = 'Entrega Própria: <span id="transportadora">'+consultaSql.Records[0].Transportadora+'</span><br>';
			else if (consultaSql.Records[0].TipoTransporte == 3)
				tipoTransporte = 'Entrega na Viagem: <span id="transportadora">'+consultaSql.Records[0].Transportadora+'</span><br>';
			else tipoTransporte = '<br><span style="font-size: 12pt;padding-top:5px;padding-bottom:5px;"><b>Cliente Retira</b></span><br><br>';
			
			
			var textoHtml;
			for (var i = 1; i <= numeroEtiquetas; i++) {
				textoHtml = '<div id="etiqueta' + i + '" class="etiqueta">'+
				'Cliente: <span id="cliente">'+consultaSql.Records[0].Cliente+'</span><br>' +
				'Endereço: <span id="endereco">'+consultaSql.Records[0].Endereco+'</span><br>'+
				tipoTransporte+
				'Volume <span id="numeroVolume">'+ i +'</span> de <span id="totalVolumes">'+ numeroEtiquetas+'</span>&nbsp;&nbsp;'+
				'Pedido: # <span id="cliente">'+consultaSql.Records[0].Numero+'</span><br>' +
				'</div>';
				$("body").append(textoHtml);
			}
		});

	</script>
</head>
<body style="width: 8cm;height: 4cm;margin: 0;">

</body>
</html>