<!DOCTYPE HTML>
<html lang="pt-br">
    <head>
        <meta charset="utf-8"/>
        <title> Recibo - Pagamento </title>
        <link type="text/css" rel="stylesheet" href="/Relatorios/OptiSoul/recibo/impressos.css"/>
        <script src="/Scripts/jquery-2.1.4.js"></script>
        <script src="/Restricted/Geeks.ERP.BasicReport.js"></script>
        <style type="text/css" media="print">
            .ObservacaoVazia {
                display: none;
            }
        </style>
    </head>

    <body>
        <div class="container">

            <!--titulo do impresso-->
            <table class="titulo-relatorio">
                <tr>
                    <td>
                        Recibo
                    </td>
                </tr>
            </table>


            <!--dados loja-->
            <table class="content-table">
                <tr>
                    <!--logo da loja-->
                    <td class="logo-loja" align="center" valign="center">
                    </td>

                    <!--dados da loja-->
                    <td class="dados-loja">
                        <h5 class="ApelidoEmpresa"></h5>
                        <h5 class="EnderecoEmpresa"></h5>
                        <h5 class="TelefoneEmpresa"></h5>
                        <h5 class="EmailEmpresa"></h5>
                        <h5 class="SiteEmpresa"></h5>
                    </td>

                    <!--numero do recibo-->
                    <td class="NumeroTitulo">
                    </td>
                </tr>
                <tr>
                    <td class="linha-divisoria" colspan="3"></td>
                </tr>
            </table>


            <!--recibo-->
            <table class="content-table">

                <!--valor recibo-->
                <tr>
                    <td class="text-align-right" colspan="2">
                        <h4 class="mbootom-1">Valor do recibo: <span class="ValorTitulo"></span></h4>
                    </td>
                </tr>


                <!--texto do recibo-->
                <tr>
                    <td colspan="2">
                        <h5> <x class="TipoTitulo"></x> <span class="NomeCliente"></span>, <x class="Sexo"></x>  do <x class="TipoDocumentoCliente"></x> <span class="CPFCliente"></span>, a quantia de <span class="ValorTitulo"></span> (<span class="ValorTituloExtenso"></span>), referente aos serviços listados abaixo:</h5>
                    </td>
                </tr>

                <tr>
                    <td colspan="2">
                        <h5 class="box-bottom mtop-15"> <span class="ObservacaoDespesa"></span> </h5>
                        <h5 class="box-bottom mtop-2"></h5>
                        <h5 class="box-bottom mtop-2"></h5>
                        <h5 class="box-bottom mtop-2"></h5>
                        <h5 class="box-bottom mtop-2"></h5>
                        <h5 class="box-bottom mtop-2"></h5>
                        <h5 class="box-bottom mtop-2 mbootom-05"></h5>
                    </td>
                </tr>

                <tr>
                    <td colspan="2"> <h5>E para clareza firmo(amos) o presente na cidade de <span class="MunicipioEmpresa"></span> no dia <span class="DataFinalizacaoTitulo"></span>.</h5> </td>
                </tr>


                <!--divisor-->
                <tr> <td class="ptop-15 box-bottom" colspan="2"></td></tr>

                
                <tr>
                    <td><h5><span>Impresso em <span class="Hoje"></span></span></h5></td>
                    <td colspan="2"> <h5 class="assinatura">Assinatura</h5></td>
                </tr>

            </table>

        </div>

        <script>
        	
	        $(document).ready(function () {

	        	var Titulo = getParameterByName("CodigoFinanceiroTitulo");

	            var banco = getParameterByName("BancoDeDados");
	            var url = decodeURIComponent(getParameterByName("URLServidor"));
	            var usuario = getParameterByName("CodigoUsuario");

                var DadosDespesa = GeeksSQL("select CodigoFinanceiroTitulo, CodigoEmpresa, CodigoContato, Convert(varchar(10), DataEmissao, 103) DataEmissao, Format(ValorTotal, 'N2') ValorTitulo, Case when Observacao in ('', null) then 'Observação não foi lançada na despesa, escrever à mão.' else Observacao end Observacao, Convert(varchar(10), current_timestamp, 103) Hoje, ReceberPagar from FinanceiroTitulo where CodigoFinanceiroTitulo = 0" + Titulo, false, url, banco, usuario);

	            var DadosEmpresa = GeeksSQL("Select Nome, Apelido, NumeroDocumentoNacional, Site, Email, Imagem, T.Telefone, (CE.Logradouro + ' ' + CE.Numero + ', '  + CE.Bairro + ' - ' + CE.Municipio + '/' + CE.UF + ' ' + CE.CEP) as Endereco from Contato C left join ContatoTelefone T on T.CodigoContato = C.CodigoContato and T.TipoTelefone = 'Principal' left join ContatoEndereco CE on CE.CodigoContato = C.CodigoContato and CE.Grupo = 'Principal' where C.CodigoContato = 0" + DadosDespesa.Records[0].CodigoEmpresa, false, url, banco, usuario);

	            var DadosCliente = GeeksSQL("Select Nome, NumeroDocumentoNacional, TipoDocumentoNacional from Contato where CodigoContato = 0" + DadosDespesa.Records[0].CodigoContato, false, url, banco, usuario);

                $(".ApelidoEmpresa").html(DadosEmpresa.Records[0].Apelido);
                $(".EnderecoEmpresa").html(DadosEmpresa.Records[0].Endereco);
                $(".TelefoneEmpresa").html(DadosEmpresa.Records[0].Telefone);
                $(".EmailEmpresa ").html(DadosEmpresa.Records[0].Email);
                $(".SiteEmpresa").html(DadosEmpresa.Records[0].Site);
                $(".CNPJEmpresa").html(DadosEmpresa.Records[0].NumeroDocumentoNacional);
                $(".MunicipioEmpresa").html(DadosEmpresa.Records[0].Municipio);

                if (DadosEmpresa.Records[0].Imagem != null && DadosEmpresa.Records[0].Imagem != "")
                	$(".logo-loja").html('<img class="ImagemEmpresa" src="' + DadosEmpresa.Records[0].Imagem.split("#")[0] + '" style="height: 75px;" />');
                else
                	$(".logo-loja").html('<img class="ImagemEmpresa" src="/Relatorios/OptiSoul/recibo/optsoul-exemplo.png" style="height: 75px;" />');

                $(".NumeroTitulo").html("Nº " + DadosDespesa.Records[0].CodigoFinanceiroTitulo);
                $(".ValorTitulo").html("R$" + DadosDespesa.Records[0].ValorTitulo);
                $(".DataFinalizacaoTitulo").html(DadosDespesa.Records[0].DataEmissao);
                $(".ObservacaoDespesa").html(DadosDespesa.Records[0].Observacao);
                $(".ValorTituloExtenso").html(getExtensive(DadosDespesa.Records[0].ValorTitulo, true));
                $(".Hoje").html(DadosDespesa.Records[0].Hoje);
                $(".TipoTitulo").html(DadosDespesa.Records[0].ReceberPagar == "1" ? "Recebemos de" : "Pagamos a");

                $(".NomeCliente").html(DadosCliente.Records[0].Nome);
                $(".TipoDocumentoCliente").html(DadosCliente.Records[0].TipoDocumentoNacional);
                $(".CPFCliente").html(DadosCliente.Records[0].NumeroDocumentoNacional);
                $(".Sexo").html(DadosCliente.Records[0].Sexo == "Masculino" ? "portador" : "portadora");

                if (DadosDespesa.Records[0].Observacao == 'Observação não foi lançada na despesa, escrever à mão.')
                    $(".ObservacaoDespesa").addClass("ObservacaoVazia");

	        });

        </script>

    </body>
</html>