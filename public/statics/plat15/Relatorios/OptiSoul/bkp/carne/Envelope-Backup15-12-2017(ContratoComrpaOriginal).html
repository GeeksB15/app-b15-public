<!DOCTYPE html>
<html lang="pt-br">

    <head>
        <meta charset="utf-8">
        <title>Envelope</title>
        <link rel="stylesheet" type="text/css" href="optidados.framework.css"/>
		<script src="/Scripts/jquery-2.1.4.js"></script>
        <script src="/Restricted/Geeks.ERP.BasicReport.js"></script>
        <script src="/Scripts/codigobarras.js"></script>
        <script src="/Plugins/html2canvas.js"></script>

        <style type="text/css">
	        .btRemoverVia {
	        	padding: 10px;
	        	background-color: #E64949;
	        	color: #FFF;
	        	border-radius: 5px;
	        	cursor: pointer;
	        	width: 200px;
	        	text-align: center;
	        	font-size: 12pt;
	        }

	        .btRemoverVia:hover{
	        	background-color: #5BBDBC;
	        }
        </style>

        <style type="text/css" media="print">
			.btRemoverVia{
				display: none;
			}
        </style>
		
		<script id="TemplateSumarioTratamento" type="TemplateSumarioTratamento">
			<ul class="list-col">
				<li class="w05"><p>&nbsp;</p></li>
				<li class="w77"> <p> ↪ [tratamentoDescricao]</p> </li>
				<li class="w07 txt-ac"> <p class="tratamentoQtde">[tratamentoQtde]</p> </li>
				<li class="w11 txt-ar"> <p class="tratamentoValor">[tratamentoValor]</p> </li>
			</ul>
		</script>
		<script id="TemplateLaboratorioTratamento" type="TemplateLaboratorioTratamento">
			<ul class="list-col">
				<li class="w05"><p>&nbsp;</p></li>
				<li class="w88"> <p> ↪ [tratamentoDescricao]</p> </li>
				<li class="w07 txt-ac"> <p class="tratamentoQtde"> [tratamentoQtde] </p> </li>
			</ul>
		</script>
		<script id="TemplateSumarioEnvelope" type="TemplateSumarioEnvelope">
			<!--envelope 1 EXEMPLO-->
			<div class="row w100 pb02">
				<h6 class="mt02 b">[descricaoItemVenda]<span class="float-r b">[numeroEnvelope]</span></h6>

				<!--armação-->
				<ul class="list-col">
					<li class="w62"> <p>[armacaoDescricao]</p> </li>
					<li class="w20"> <p>[armacaoMarca]</p> </li>
					<li class="w07 txt-ac"> <p>[armacaoQtde]</p> </li>
					<li class="w11 txt-ar"> <p>[armacaoValor]</p> </li>
				</ul>

				<!--lente OD !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
				<ul class="list-col linhaLOD">
					<li class="w62"> <p>[lodDescricao]</p> </li>
					<li class="w20"> <p>[lodMarca]</p> </li>
					<li class="w07 txt-ac"> <p class="lodQtde">[lodQtde]</p> </li>
					<li class="w11 txt-ar"> <p class="lodValor">[lodValor]</p> </li>
				</ul>
				<div class="row w100 TLOD"></div>
			
				<!--lente OE !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
				<ul class="list-col linhaLOE">
					<li class="w62"> <p>[loeDescricao]</p> </li>
					<li class="w20"> <p>[loeMarca]</p> </li>
					<li class="w07 txt-ac"> <p class="loeQtde">[loeQtde]</p> </li>
					<li class="w11 txt-ar"> <p class="loeValor">[loeValor]</p> </li>
				</ul>
				<div class="row w100 TLOE"></div>
				
			</div>
		</script>
		<script id="TemplateSumarioAvulso" type="TemplateSumarioAvulso">
			<ul class="list-col">
				<li class="w62"> <h6 class="b">[outroDescricao]</h6> </li>
				<li class="w20"> <h6 class="b">[outroMarca]</h6> </li>
				<li class="w07 txt-ac"> <h6>[outroQtde]</h6> </li>
				<li class="w11 txt-ar"> <h6>[outroValor]</h6> </li>
			</ul>
		</script>
		<script id="TemplateVendasEnvelope" type="TemplateVendasEnvelope">
			<div class="row w95 pcentl05">
				<p>↪ Envelope #<span>[numeroEnvelope]</span></p>
				<ul class="list-col txt-ar">
					<li class="w34"> <p>[envelopeTotelItens]</p> </li>
					<li class="w33"> <p>[envelopeDesconto]</p> </li>
					<li class="w33"> <p>[envelopeTotal]</p> </li>
				</ul>
			</div>
		</script>
		<script id="TemplateVendas" type="TemplateVendas">
			<div class="row w95 pcentl05">
				<p>↪ Venda #<span>[numeroVenda]</span></p>
				<ul class="list-col txt-ar">
					<li class="w37-5"> <p>[vendaSubTotal]</p> </li>
					<li class="w31-2"> <p>[vendaDesconto]</p> </li>
					<li class="w31-1"> <p>[vendaTotal]</p> </li>
				</ul>

				<!--sub-nivel venda envelope+produtos-->
				<div class="VendasEnvelopes"></div>

				<div class="row w95 pcentl05 divOutrosProdutos">
					<p>↪ Outros produtos</p>
					<ul class="list-col txt-ar">
						<li class="w34"> <p class="templateVendasOutrosTotalItens"></p> </li>
						<li class="w33"> <p class="templateVendasOutrosDesconto"></p> </li>
						<li class="w33"> <p class="templateVendasOutrosTotal"></p> </li>
					</ul>
				</div>
			</div>
		</script>
		<script id="TemplateFormaPgto" type="TemplateFormaPgto">
			<ul class="list-col">
				<li class="w50"> <p>[descricao] <span>[parcelas]</span></p> </li>
				<li class="w50 txt-ar"> <p>[valor]</p> </li>
			</ul>
		</script>
		<script id="TemplatePrescricaoCliente" type="TemplatePrescricaoCliente">
			<!--produtos + receita-->
			<div class="row w100 mb1">
				<!--cabecalho venda-->
				<div class="row w100 lineb mb05">
					<div class="col w45">
						<p> Paciente: <span>[nomePaciente]</span> </p>
						<p> Médico: <span>[nomeMedico]</span> </p>
					</div>

					<div class="col w25">
						<p>Fatura: <span class="dataFaturaCompleta"></span> </p>
						<p>Previsão: <span>[dataPrevisto]</span> </p>
					</div>

					<div class="col w30 txt-ac">
						<span class="[CodBarrasEnvelope]"> Código Barras (ENVELOPE) </span> <!--EXEMPLO-->
						<p>#<span class="[CodEnvelope]">Cód. Envelope</span></p>
					</div>
				</div>

				<!--prescricao-->
				<div class="row mb04">
					<!--olho direito-->
					<div class="row w80 linel lineb liner">
						<div class="col w88">
							<ul class="list-col txt-ac">
								<li class="w10"> <p class="b linef">O.D.</p> </li>
								<li class="w12-8 lineb"> <p> Adc. </p> </li>
								<li class="w12-8 lineb"> <p> Esf. </p> </li>
								<li class="w12-8 lineb"> <p> Cil. </p> </li>
								<li class="w12-8 lineb"> <p> Eixo </p> </li>
								<li class="w12-8 lineb"> <p> Pris. </p> </li>
								<li class="w12-8 lineb"> <p> Base </p> </li>
								<li class="w12-8 lineb"> <p> DNP  </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaDireitoLonge">
								<li class="w10"> <p class="txt-al"> Longe </p> </li>
								<li class="w12-8"> <p>.</p> </li>
								<li class="w12-8"> <p> [ODLEsf] </p> </li>
								<li class="w12-8"> <p> [ODLCil] </p> </li>
								<li class="w12-8"> <p> [ODLEix] </p> </li>
								<li class="w12-8"> <p> [ODLPri] </p> </li>
								<li class="w12-8"> <p> [ODLBas] </p> </li>
								<li class="w12-8"> <p> [ODLDNP] </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaDireitoMedio">
								<li class="w10"> <p class="txt-al"> Medio </p> </li>
								<li class="w12-8 "> <p> [ODMAdi] </p> </li>
								<li class="w12-8 "> <p> [ODMEsf] </p> </li>
								<li class="w12-8 "> <p> [ODMCil] </p> </li>
								<li class="w12-8 "> <p> [ODMEix] </p> </li>
								<li class="w12-8 "> <p> [ODMPri] </p> </li>
								<li class="w12-8 "> <p> [ODMBas] </p> </li>
								<li class="w12-8 "> <p> [ODMDNP] </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaDireitoPerto">
								<li class="w10"> <p class="txt-al"> Perto </p> </li>
								<li class="w12-8 "> <p> [ODPAdi] </p> </li>
								<li class="w12-8 "> <p> [ODPEsf] </p> </li>
								<li class="w12-8 "> <p> [ODPCil] </p> </li>
								<li class="w12-8 "> <p> [ODPEix] </p> </li>
								<li class="w12-8 "> <p> [ODPPri] </p> </li>
								<li class="w12-8 "> <p> [ODPBas] </p> </li>
								<li class="w12-8  "> <p> [ODPDNP] </p> </li>
							</ul>
						</div>

						<div class="col w11-1 txt-ac linel lineb liner">
							<p class="lineb"> Alt. Mont. </p>
							<p>[AlturaMontagemOD]</p>
						</div>
					</div>

					<!--tipo oculos-->
					<div class="row w18-5 linel lineb liner">
						<p class="txt-ac linel lineb liner">Tipo Óculos</p>
						<p id="TipoOculos" class="b"></p>
					</div>

					<!--olho esquerdo-->
					<div class="col w80 linel lineb liner mt02">
						<div class="row w88">
							<ul class="list-col txt-ac">
								<li class="w10"> <p class="b linef">O.E.</p> </li>
								<li class="w12-8 lineb"> <p> Adc. </p> </li>
								<li class="w12-8 lineb"> <p> Esf. </p> </li>
								<li class="w12-8 lineb"> <p> Cil. </p> </li>
								<li class="w12-8 lineb"> <p> Eixo </p> </li>
								<li class="w12-8 lineb"> <p> Pris. </p> </li>
								<li class="w12-8 lineb"> <p> Base </p> </li>
								<li class="w12-8 lineb"> <p> DNP  </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaEsquerdoLonge">
								<li class="w10"> <p class="txt-al"> Longe </p> </li>
								<li class="w12-8"> <p>.</p> </li>
								<li class="w12-8"> <p> [OELEsf] </p> </li>
								<li class="w12-8"> <p> [OELCil] </p> </li>
								<li class="w12-8"> <p> [OELEix] </p> </li>
								<li class="w12-8"> <p> [OELPri] </p> </li>
								<li class="w12-8"> <p> [OELBas] </p> </li>
								<li class="w12-8"> <p> [OELDNP] </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaEsquerdoMedio">
								<li class="w10 "> <p class="txt-al"> Medio </p> </li>
								<li class="w12-8 "> <p> [OEMAdi] </p> </li>
								<li class="w12-8 "> <p> [OEMEsf] </p> </li>
								<li class="w12-8 "> <p> [OEMCil] </p> </li>
								<li class="w12-8 "> <p> [OEMEix] </p> </li>
								<li class="w12-8 "> <p> [OEMPri] </p> </li>
								<li class="w12-8 "> <p> [OEMBas] </p> </li>
								<li class="w12-8 "> <p> [OEMDNP] </p> </li>
							</ul>

							<ul class="list-col txt-ac linhaEsquerdoPerto">
								<li class="w10 "> <p class="txt-al"> Perto </p> </li>
								<li class="w12-8 "> <p> [OEPAdi] </p> </li>
								<li class="w12-8 "> <p> [OEPEsf] </p> </li>
								<li class="w12-8 "> <p> [OEPCil] </p> </li>
								<li class="w12-8 "> <p> [OEPEix] </p> </li>
								<li class="w12-8 "> <p> [OEPPri] </p> </li>
								<li class="w12-8 "> <p> [OEPBas] </p> </li>
								<li class="w12-8 "> <p> [OEPDNP] </p> </li>
							</ul>
						</div>

						<div class="col w11-1 txt-ac linel lineb liner">
							<p class="lineb"> Alt. Mont. </p>
							<p>[AlturaMontagemOE]</p>
						</div>
					</div>
				</div>

				<!--produtos-->
				<div class="col w100">
					<!--descicao coluna-->
					<div class="row w100">
						<ul class="list-col lineb">
							<li class="w62"> <p> Descrição </p> </li>
							<li class="w20"> <p> Marca </p> </li>
							<li class="w07 txt-ac"> <p> Qtd </p> </li>
							<li class="w11 txt-ac"> <p> Preço (R$) </p> </li>
						</ul>
					</div>

					<div class="row w100">
						<!--armação-->
						<ul class="list-col">
							<li class="w62"> <p> [armacaoDescricao] </p> </li>
							<li class="w20"> <p> [armacaoMarca] </p> </li>
							<li class="w07 txt-ac"> <p> [armacaoQtde] </p> </li>
							<li class="w11 txt-ar"> <p>[armacaoValor]</p> </li>
						</ul>

						<!--lente OD !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
						<ul class="list-col linhaLOD">
							<li class="w62"> <p>[lodDescricao]</p> </li>
							<li class="w20"> <p>[lodMarca]</p> </li>
							<li class="w07 txt-ac"> <p class="lodQtde"> [lodQtde] </p> </li>
							<li class="w11 txt-ar"> <p class="lodValor">[lodValor]</p> </li>
						</ul>
						<div class="row w100 TLOD"></div>

						<!--lente OE !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
						<ul class="list-col linhaLOE">
							<li class="w62"> <p>[loeDescricao]</p> </li>
							<li class="w20"> <p>[loeMarca]</p> </li>
							<li class="w07 txt-ac"> <p class="loeQtde"> [loeQtde] </p> </li>
							<li class="w11 txt-ar"> <p class="loeValor">[loeValor]</p> </li>
						</ul>
						<div class="row w100 TLOE"></div>
					</div>
				</div>
			</div>
		</script>
		<script id="TemplatePrescricaoLaboratorio" type="TemplatePrescricaoLaboratorio">
			<!--dados loja-->
			<div class="row w100 lineb mb04">
				<div class="col w18 logo" style="margin-right: 10px">
					<img class="img-responsive" src="optsoul-exemplo.png"/>
				</div>

				<div class="col w38">
					<p class=" w100 lineb fantasiaEmissor"></p>
					<p class="enderecoEmissor"></p>
					<p class="telefoneEmissor"></p>
					<p class="emailEmissor"></p>
					<p class="siteEmissor"></p>
				</div>

				<div class="col w19 pl03">
					<p class="w100 lineb">Venda: <span>[dataVenda]</span> </p>
					<p>Previsão: <span>[dataPrevisto]</span> </p>
				</div>

				<div class="col w22 txt-ac">
					<p class="lineb w100">Via Laboratório</p>
					<p>Impresso: <span class="dataImpressao"></span> </p>
					<span class="[CodBarrasEnvelope]"> Código Barras (ENVELOPE) </span> <!--EXEMPLO-->
					<p>#<span class="[CodEnvelope]">Cód. Envelope</span></p>
				</div>
			</div>
			<div class="row w100 mt02">
				<p class="col w50"> Paciente: <span>[nomePaciente]</span> </p>
				<p class="col w50"> Médico: <span>[nomeMedico]</span> </p>
			</div>
			<!--prescricao-->
			<div class="row w100">
				<!--olho direito-->						
				<div class="col w43-6 mr05 linel lineb liner">
					<div class="col w88">
						<ul class="list-col txt-ac">
							<li class="w10"> <p class="b linef">O.D.</p> </li>
							<li class="w12-8 lineb"> <p> Adc. </p> </li>
							<li class="w12-8 lineb"> <p> Esf. </p> </li>
							<li class="w12-8 lineb"> <p> Cil. </p> </li>
							<li class="w12-8 lineb"> <p> Eixo </p> </li>
							<li class="w12-8 lineb"> <p> Pris. </p> </li>
							<li class="w12-8 lineb"> <p> Base </p> </li>
							<li class="w12-8 lineb"> <p> DNP  </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaDireitoLonge">
							<li class="w10"> <p class="txt-al"> Longe </p> </li>
							<li class="w12-8"> <p>.</p> </li>
							<li class="w12-8"> <p> [ODLEsf] </p> </li>
							<li class="w12-8"> <p> [ODLCil] </p> </li>
							<li class="w12-8"> <p> [ODLEix] </p> </li>
							<li class="w12-8"> <p> [ODLPri] </p> </li>
							<li class="w12-8"> <p> [ODLBas] </p> </li>
							<li class="w12-8"> <p> [ODLDNP] </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaDireitoMedio">
							<li class="w10"> <p class="txt-al"> Medio </p> </li>
							<li class="w12-8 "> <p> [ODMAdi] </p> </li>
							<li class="w12-8 "> <p> [ODMEsf] </p> </li>
							<li class="w12-8 "> <p> [ODMCil] </p> </li>
							<li class="w12-8 "> <p> [ODMEix] </p> </li>
							<li class="w12-8 "> <p> [ODMPri] </p> </li>
							<li class="w12-8 "> <p> [ODMBas] </p> </li>
							<li class="w12-8 "> <p> [ODMDNP] </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaDireitoPerto">
							<li class="w10"> <p class="txt-al"> Perto </p> </li>
							<li class="w12-8 "> <p> [ODPAdi] </p> </li>
							<li class="w12-8 "> <p> [ODPEsf] </p> </li>
							<li class="w12-8 "> <p> [ODPCil] </p> </li>
							<li class="w12-8 "> <p> [ODPEix] </p> </li>
							<li class="w12-8 "> <p> [ODPPri] </p> </li>
							<li class="w12-8 "> <p> [ODPBas] </p> </li>
							<li class="w12-8  "> <p> [ODPDNP] </p> </li>
						</ul>
					</div>

					<div class="col w10 txt-ac linel lineb liner">
						<p class="lineb"> A.Mon. </p>
						<p>[AlturaMontagemOD]</p>
					</div>
				</div>

				<!--olho esquerdo-->
				<div class="col w43-6 mr05 linel lineb liner">
					<div class="row w88">
						<ul class="list-col txt-ac">
							<li class="w10"> <p class="b linef">O.E.</p> </li>
							<li class="w12-8 lineb"> <p> Adc. </p> </li>
							<li class="w12-8 lineb"> <p> Esf. </p> </li>
							<li class="w12-8 lineb"> <p> Cil. </p> </li>
							<li class="w12-8 lineb"> <p> Eixo </p> </li>
							<li class="w12-8 lineb"> <p> Pris. </p> </li>
							<li class="w12-8 lineb"> <p> Base </p> </li>
							<li class="w12-8 lineb"> <p> DNP  </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaEsquerdoLonge">
							<li class="w10"> <p class="txt-al"> Longe </p> </li>
							<li class="w12-8"> <p>.</p> </li>
							<li class="w12-8"> <p> [OELEsf] </p> </li>
							<li class="w12-8"> <p> [OELCil] </p> </li>
							<li class="w12-8"> <p> [OELEix] </p> </li>
							<li class="w12-8"> <p> [OELPri] </p> </li>
							<li class="w12-8"> <p> [OELBas] </p> </li>
							<li class="w12-8"> <p> [OELDNP] </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaEsquerdoMedio">
							<li class="w10"> <p class="txt-al"> Medio </p> </li>
							<li class="w12-8 "> <p> [OEMAdi] </p> </li>
							<li class="w12-8 "> <p> [OEMEsf] </p> </li>
							<li class="w12-8 "> <p> [OEMCil] </p> </li>
							<li class="w12-8 "> <p> [OEMEix] </p> </li>
							<li class="w12-8 "> <p> [OEMPri] </p> </li>
							<li class="w12-8 "> <p> [OEMBas] </p> </li>
							<li class="w12-8 "> <p> [OEMDNP] </p> </li>
						</ul>

						<ul class="list-col txt-ac linhaEsquerdoPerto">
							<li class="w10"> <p class="txt-al"> Perto </p> </li>
							<li class="w12-8 "> <p> [OEPAdi] </p> </li>
							<li class="w12-8 "> <p> [OEPEsf] </p> </li>
							<li class="w12-8 "> <p> [OEPCil] </p> </li>
							<li class="w12-8 "> <p> [OEPEix] </p> </li>
							<li class="w12-8 "> <p> [OEPPri] </p> </li>
							<li class="w12-8 "> <p> [OEPBas] </p> </li>
							<li class="w12-8 "> <p> [OEPDNP] </p> </li>
						</ul>
					</div>

					<div class="col w10 txt-ac linel lineb liner">
						<p class="lineb"> A.Mon. </p>
						<p>[AlturaMontagemOE]</p>
					</div>
				</div>

				<!--tipo oculos-->
				<div class="col w10 linel lineb liner">
					<p class="txt-ac linel lineb liner">Tipo Óculos</p>
					<p id="TipoOculos" class="b"></p>
				</div>
			</div>

			<!--produtos-->
			<div class="col w100">
				<!--descicao coluna-->
				<div class="row w100">
					<ul class="list-col lineb">
						<li class="w73"> <p> Descrição </p> </li>
						<li class="w20"> <p> Marca </p> </li>
						<li class="w07 txt-ac"> <p> Qtd </p> </li>
					</ul>
				</div>

				<div class="row mt02 w100 divArmacao">
					<!--armação-->
					<ul class="list-col">
						<li class="w73"> <p> [armacaoDescricao] </p> </li>
						<li class="w20"> <p> [armacaoMarca] </p> </li>
						<li class="w07 txt-ac"> <p> [armacaoQtde] </p> </li>
					</ul>

					<!--lente OD !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
					<ul class="list-col linhaLOD">
						<li class="w73"> <p>[lodDescricao]</p> </li>
						<li class="w20"> <p>[lodMarca]</p> </li>
						<li class="w07 txt-ac"> <p class="lodQtde"> [lodQtde] </p> </li>
					</ul>
					<div class="row w100 TLOD"></div>

					<!--lente OE !IMPORTANTE SÓ MOSTRAR LENTES SEPARADAS SE AS MESMAS FOREM DIFERENTES-->
					<ul class="list-col linhaLOE">
						<li class="w73"> <p>[loeDescricao]</p> </li>
						<li class="w20"> <p>[loeMarca]</p> </li>
						<li class="w07 txt-ac"> <p class="loeQtde"> [loeQtde] </p> </li>
					</ul>
					<div class="row w100 TLOE"></div>
				</div>
			</div>

			<!--observação da prescrição-->
			<div class="row w100 mt04">
				<p class="linel lineb liner">Obs.: <span class="ObservacaoPresc"></span></p>
			</div>
		</script>
    </head>

    <body>
        <div class="container">

            <!--VIA CLIENTE-->
 			<div class="row w100" id="viaCliente">
 				<p class="btRemoverVia" id="btCliente">Não quero imprimir isso!</p>

                <!--dados loja-->
                <div class="row w100 lineb">
                	<div class="col w18 logo" style="margin-right: 10px">
                		<img class="img-responsive" src="optsoul-exemplo.png"/>
                	</div>

                	<div class="col w58">
                        <p class="w100 lineb fantasiaEmissor"></p>
                        <p class="enderecoEmissor"></p>
                        <p class="telefoneEmissor"></p>
                        <p class="emailEmissor"></p>
                        <p class="siteEmissor"></p>
                	</div>

                	<div class="col w22 txt-ac">
                		<p class="lineb w100">Via Cliente</p>
						<p> Impresso: <span class="dataImpressao"></span> </p>
						<span class="CodBarrasPedido"> Código Barras </span> <!--EXEMPLO-->
						<p>#<span class="CodPedido">Código Pedido</span></p>
                	</div>
                </div>


                <!--dados cliente-->
                <div class="row w100">
                	<div class="col w78">
                		<p> <span class="codigoCliente"></span> <span class="nomeCliente"></span> </p>
                        <p> <span class="enderecoCliente"></span> </p>
                        <p> <span class="telefoneCliente"></span> </p>
                	</div>

                	<div class="col w22">
                    	<p>Emissão: <span class="dataVendaEmissao"></span> </p>
						<p>Finalizado: <span class="dataVendaFinalizado"></span> </p>
						<!--<p>Previsão: <span class="prevEntrega"></span> </p>
						<p>Entrega: <span class="dataEntrega"></span> </p>-->
                	</div>
                </div>


	            <!--produtos + fatura-->
	            <div class="row w100 mt05">
	            	<!--produtos-->
	            	<div class="col w68-7 mr1">

	            		<!--descicao coluna-->
	            		<div class="row w100">
		            		<ul class="list-col lineb">
			                    <li class="w62"> <p> Descrição </p> </li>
			                    <li class="w20"> <p> Marca </p> </li>
			                    <li class="w07 txt-ac"> <p> Qtd </p> </li>
			                    <li class="w11 txt-ac"> <p> Preço (R$) </p> </li>
		            		</ul>
	        			</div>
	        			<div class="row w100" >

							<div id="Envelopes"></div>

							<!--produtos avulsos EXEMPLO-->
							<div class="Avulsos"></div>

							<!--totalizador produtos-->
							<ul class="list-col linet">
								<li class="w82"> <p class="b"> Total: </p> </li>
								<li class="w07 txt-ac"> <p class="b SumarioQtdeTotal"> 7 </p> </li>
								<li class="w11 txt-ar"> <p class="b SumarioValorTotal"> 3.070,00 </p> </li>
							</ul>

	        			</div>
	            	</div>
	            	<!--.end produtos-->

	            	<!--fatura-->
	            	<div class="col w29-5 linel liner">
	            		<!--descricao colunas-->
						<div class="row w100 lineb">
							<p class="col w22 divFatura">Fatura</p>
	        				<p class="col w33 txt-ac divFatura">#<span class="numeroFatura"></span></p>
	        				<p class="col w45 txt-ac divFatura">Data <span class="dataFatura"></span></p>
		            		<ul class="list-col txt-ac">
			                    <li class="w40-8 txt-ar"> <p> Subtotal (R$) </p> </li>
			                    <li class="w30 txt-ar"> <p> Desc. ( -R$) </p> </li>
			                    <li class="w29-2 txt-ar"> <p> Total (R$) </p> </li>
		            		</ul>
	        			</div>

	        			<!--fatura total-->
	        			<div class="row w100">
	        				<ul class="list-col txt-ar">
	        					<li class="w40-5"> <p class="totalItensFatura"></p> </li>
	        					<li class="w29-9"> <p class="descontoFatura"></p> </li>
	        					<li class="w29-6"> <p class="totalFatura"></p> </li>
	        				</ul>
	        			</div>

	        			<!--venda's + sub-niveis-->
	        			<div class="Vendas"></div>

						<ul class="list-col divOutrosPedidos">
							<li class="w50"> <p>Outros Pedidos</p> </li>
							<li class="w50 txt-ar"> <p class="valorOutrosPedidos"></p> </li>
						</ul>
						
	        			<!--formas pgto + valor restante-->
	        			<div class="row w100">
	        				<p class="b divFatura">Forma(s) Pagamento</p>

							<div class="FormasPgto"></div>

							<ul class="list-col divDevolucoes">
	        					<li class="w60"> <p class="b">Devoluções</p> </li>
	        					<li class="w40 txt-ar"> <p class="b saldoDevolucao"></p> </li>
	        				</ul>
							
	        				<ul class="list-col linet">
	        					<li class="w60"> <p class="b">Saldo a pagar</p> </li>
	        					<li class="w40 txt-ar"> <p class="b saldoPagar"></p> </li>
	        				</ul>
	        			</div>
	            	</div>
	            	<!--.end fatura-->
	            </div>
	            <!--.end produtos + fatura-->

            </div>
            <!--.END VIA CLIENTE-->

            <!--VIA LOJA-->
            <div class="row w100 pt05 linet-dashed mt05" id="viaLoja">
 				<p class="btRemoverVia" id="btLoja">Não quero imprimir isso!</p>

                <!--cabecalho-->
                <div class="row w100">
            		<div class="col w18 logo" style="margin-right: 10px">
                		<img class="img-responsive" src="optsoul-exemplo.png"/>
                	</div>
					
					<div class="col w58">
                        <p class="lineb w100 fantasiaEmissor"></p>
                		<p> <span class="codigoCliente"></span> <span class="nomeCliente"></span> </p>
                        <p> <span class="enderecoCliente"></span> </p>
                        <p> <span class="telefoneCliente"></span> </p>
                	</div>

                	<div class="col w22 txt-ac">
                		<p class="lineb w100">Via Loja</p>
						<p> Impresso: <span class="dataImpressao"></span> </p>
						<span class="CodBarrasPedido"> Código Barras </span> <!--EXEMPLO-->
						<p>#<span class="CodPedido">Código Pedido</span></p>
                	</div>
                </div>

	            <!--coluna esquerda-->
	            <div class="row w70 liner mt05 pr05">

	                <div id="PrescricaoCliente"></div>

					<!--produtos avulsos-->
					<div class="Avulsos"></div>

					<!--totalizador produtos-->
					<ul class="list-col linet">
						<li class="w82"> <p class="b"> Total: </p> </li>
						<li class="w07 txt-ac"> <p class="b SumarioQtdeTotal"> 7 </p> </li>
						<li class="w11 txt-ar"> <p class="b SumarioValorTotal"> 3.070,00 </p> </li>
					</ul>
					
					<!--observacao-->
					<div class="row w100 mt05 linel lineb liner">
						<p>Obs.: <span id="ObsPedido"></span></p>
					</div>

		        </div>

            	<!--coluna direita-->
	            <div class="row w28-6 mt05 ml05">

	            	<!--fatura-->
					<!--descricao colunas-->
					<div class="row w100 lineb">
						<p class="col w22 divFatura">Fatura</p>
						<p class="col w33 txt-ac divFatura">#<span class="numeroFatura"></span></p>
						<p class="col w45 txt-ac divFatura">Data <span class="dataFatura"></span></p>
						<ul class="list-col txt-ac">
							<li class="w40-8 txt-ar"> <p> Subtotal (R$) </p> </li>
							<li class="w30 txt-ar"> <p> Desc. ( -R$) </p> </li>
							<li class="w29-2 txt-ar"> <p> Total (R$) </p> </li>
						</ul>
					</div>

					<!--fatura total-->
					<div class="row w100">
						<ul class="list-col txt-ar">
							<li class="w40-5"> <p class="totalItensFatura"></p> </li>
							<li class="w29-9"> <p class="descontoFatura"></p> </li>
							<li class="w29-6"> <p class="totalFatura"></p> </li>
						</ul>
					</div>

					<!--venda's + sub-niveis-->
					<div class="Vendas"></div>

					<ul class="list-col divOutrosPedidos">
						<li class="w50"> <p>Outros Pedidos</p> </li>
						<li class="w50 txt-ar"> <p class="valorOutrosPedidos"></p> </li>
					</ul>
					
					<!--formas pgto + valor restante-->
					<div class="row w100">
						<p class="b divFatura">Forma(s) Pagamento</p>

						<div class="FormasPgto"></div>

						<ul class="list-col divDevolucoes">
							<li class="w60"> <p class="b">Devoluções</p> </li>
							<li class="w40 txt-ar"> <p class="b saldoDevolucao"></p> </li>
						</ul>

						<ul class="list-col linet">
							<li class="w60"> <p class="b">Saldo a pagar</p> </li>
							<li class="w40 txt-ar"> <p class="b saldoPagar"></p> </li>
						</ul>
					</div>
	            	<!--.end fatura-->

	            	<!--contrato-->
	            	<div class="row w100 mt2">
	            		<p class="txt-ac lineb">Contrato de Compra</p>
                        <p class="textoAssinatura">
                            Eu, <span>Maicon Henrique Dias</span>, residente em <span>Rua Jose Rabetti 146</span>, <span>Pedreira</span>, <span>SP</span>, portador do CPF: <span>090.962.579-44</span> e RG: <span>161843113</span>. Declaro estar adquirindo da <span>Loja De Fatos LTDA ME</span>, os produtos de minha necessidade, totalizando um valor de <span>R$ 210,00</span>.
                        </p>
                        <p class="txt-ac mt3 linet">Assinatura</p>
	            	</div>

	            </div>

            </div>
            <!--.END VIA LOJA-->



            <!--VIA LABORATÓRIO-->
            <div class="row w100 pt05 linet-dashed mt1" id="viaLaboratorio">
        		<p class="btRemoverVia" id="btLaboratorio">Não quero imprimir isso!</p>

				<div id="PrescricaoLaboratorio"></div>
            </div>
            <!--.END VIA LABORATÓRIO-->

		</div>
		<script>

			$(document).ready(function(){

				var pedido = getParameterByName("CodigoVenda");
				var banco = getParameterByName("BancoDeDados");
				var url = decodeURIComponent(getParameterByName("URLServidor"));
				var usuario = getParameterByName("CodigoUsuario");
				var qtdeTotal = 0;
				var valorTotal = 0;
				
				var envelope = getParameterByName("CodigoEnvelope");

				var dadosEmissor = GeeksSQL("select C.Nome, C.[Site], C.Email, CT.Telefone, IsNull((CE.Logradouro + ' ' + CE.Numero + ', '  + CE.Bairro + ' - ' + CE.Municipio + '/' + CE.UF + ' ' + CE.CEP), '') as Endereco, IsNull(C.Imagem, 'Não informado') Imagem from Contato C left join ContatoTelefone CT on CT.CodigoContato = C.CodigoContato and CT.TipoTelefone = 'Principal' left join ContatoEndereco CE on CE.CodigoContato = C.CodigoContato and CE.Grupo = 'Principal' where C.CodigoContato = (select CodigoEmpresa from Documento where CodigoDocumento = 0" + pedido + ")", false, url, banco, usuario);
				

				var dadosCliente = GeeksSQL("Select top 1 * from (select 1 Ordem, C.CodigoContato, C.Nome, C.NumeroDocumentoNacional, C.TipoDocumentoNacional, C.NumeroDocumentoEstadual, dbo.fn_RetornaTelefones(C.CodigoContato) Telefone, IsNull(CE.Logradouro + ', ' + IsNull(CE.Numero, 'S/N') + IsNull(' - '  + CE.Bairro,'') + IsNull(' - ' + CE.Municipio + IsNull('/' + CE.UF,''),'') + IsNull(' - ' + CE.CEP,''), 'Não informado') Endereco from Contato C left join ContatoEndereco CE on CE.CodigoContato = C.CodigoContato and CE.Grupo = 'Principal' where C.CodigoContato = (select CodigoContato from Documento where CodigoDocumento = 0"+pedido+") Union select 2 Ordem, C.CodigoContato, C.Nome, C.NumeroDocumentoNacional, C.TipoDocumentoNacional, C.NumeroDocumentoEstadual, dbo.fn_RetornaTelefones(C.CodigoContato) Telefone, IsNull(CE.Logradouro + ', ' + IsNull(CE.Numero, 'S/N') + IsNull(' - '  + CE.Bairro,'') + IsNull(' - ' + CE.Municipio + IsNull('/' + CE.UF,''),'') + IsNull(' - ' + CE.CEP,''), 'Não informado') Endereco from Contato C left join ContatoEndereco CE on CE.CodigoContato = C.CodigoContato and CE.Grupo <> 'Principal' where C.CodigoContato = (select CodigoContato from Documento where CodigoDocumento = 0"+pedido+")) dados order by 1", false, url, banco, usuario);

				$(".codigoCliente").each(function() {
					$( this ).html(dadosCliente.Records[0].CodigoContato);
				});
				$(".nomeCliente").each(function() {
					$( this ).html(dadosCliente.Records[0].Nome);
				});
				$(".enderecoCliente").each(function() {
					$( this ).html(dadosCliente.Records[0].Endereco);
				});
				$(".telefoneCliente").each(function() {
					$( this ).html(dadosCliente.Records[0].Telefone);
				});
				
				// Geração do código de barras
				var numero = String(pedido);
				var zeros = 13 - Number(numero.length);

				for (var i = 0; i < zeros; i++) 
					numero = '0' + numero;
						
				$(".CodBarrasPedido").each(function() {
					$( this ).css("white-space", "nowrap");
					$( this ).css("background-color", "#fff");
					$( this ).html(fbarcode(numero,20));
				});
				$(".CodPedido").each(function() {
					$( this ).html(pedido);
				});

				var dadosVenda = GeeksSQL("select IsNull(Convert(varchar(10), DataHoraEmissao, 103) + ' ' + Convert(varchar(10), DataHoraEmissao, 108), '') Emissao, IsNull(Convert(varchar(10), DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), DataHoraFinalizado, 108), '') Finalizado, IsNull(Convert(varchar(10), current_timestamp, 103) + ' ' + Convert(varchar(10), current_timestamp, 108), '') Agora, Numero, TotalDocumento, TotalDesconto, Observacao from Documento where CodigoDocumento = 0" + pedido, false, url, banco, usuario);  
				$(".dataVendaEmissao").html(dadosVenda.Records[0].Emissao);				
				$(".dataVendaFinalizado").html(dadosVenda.Records[0].Finalizado);	
				$("#ObsPedido").html(dadosVenda.Records[0].Observacao);	
				
				var templateVendas = $("#TemplateVendas").html()
					.replace("[numeroVenda]",dadosVenda.Records[0].Numero)
					.replace("[vendaSubTotal]",(dadosVenda.Records[0].TotalDesconto+dadosVenda.Records[0].TotalDocumento).toFixed(2).replace('.', ','))
					.replace("[vendaDesconto]",dadosVenda.Records[0].TotalDesconto.toFixed(2).replace('.', ','))
					.replace("[vendaTotal]",dadosVenda.Records[0].TotalDocumento.toFixed(2).replace('.', ','));
					
				$(".Vendas").each(function() {
					$( this ).html(templateVendas);
				});
				
				var valorVenda = dadosVenda.Records[0].TotalDocumento;
				var totalDevolucoes = 0;
				var devolucoes = GeeksSQL("Select Sum(TotalDocumento) TotalDevolucao from Documento where CodigoDocumentoAdicional="+pedido+" and NaturezaOperacao='Devolução'", false, url, banco, usuario).Records;
				if (devolucoes && devolucoes.length > 0 && devolucoes[0].TotalDevolucao) totalDevolucoes = devolucoes[0].TotalDevolucao;
				
				var listaEnvelopes = GeeksSQL("select * from Documento where CodigoDocumentoAdicional in (Select CodigoDocumento from Documento where CodigoDocumentoAdicional = 0" + pedido + ")", false, url, banco, usuario).Records;
				
				for (var idEnvelope = 0; idEnvelope < listaEnvelopes.length; idEnvelope++)
				{
					var codigoEnvelope = listaEnvelopes[idEnvelope].CodigoDocumento;
					
					//var item = GeeksSQL("select CodigoDocumentoAdicional from Documento where CodigoDocumento = 0" + codigoEnvelope, false, url, banco, usuario);
					//item = item.Records[0].CodigoDocumentoAdicional;
					item = listaEnvelopes[idEnvelope].CodigoDocumentoAdicional;
				
					var dadosEnvelope = GeeksSQL("select CodigoDocumento CodigoEnvelope, Cast((Select Numero from Documento where CodigoDocumento = (Select CodigoDocumentoAdicional from Documento where CodigoDocumento=d.CodigoDocumentoAdicional)) as varchar)+ '-' + Cast(Numero as varchar) NumeroEnvelope, IsNull(Convert(varchar(10), DataHoraPrevisto, 103), '') Previsto, Observacao from Documento d where CodigoDocumento = 0" + codigoEnvelope, false, url, banco, usuario);
				
					$(".codEnvelope").html(dadosEnvelope.Records[0].CodigoEnvelope);
					
					var vendasEnvelope = $("#TemplateVendasEnvelope").html()
						.replace("[numeroEnvelope]",dadosEnvelope.Records[0].NumeroEnvelope);

					var itemVenda = GeeksSQL("select IsNull(Convert(varchar(10), DataHoraEmissao, 103) + '' + Convert(varchar(10), DataHoraEmissao, 108), '') Emissao, IsNull(Convert(varchar(10), DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), DataHoraFinalizado, 108), '') Finalizado, IsNull(Convert(varchar(10), current_timestamp, 103) + ' ' + Convert(varchar(10), current_timestamp, 108), '') Agora, * from Documento where CodigoDocumento = 0" + item, false, url, banco, usuario);            

					$(".dataVenda").html(itemVenda.Records[0].Emissao);
					$(".prevEntrega").html(dadosEnvelope.Records[0].Previsto == '01/01/1900' ? " " : dadosEnvelope.Records[0].Previsto);
					$(".dataEntrega").html(itemVenda.Records[0].Entregue);
					
					var sumario = $("#TemplateSumarioEnvelope").html();			
					sumario = sumario.replace("[descricaoItemVenda]", itemVenda.Records[0].Descricao)
									 .replace("[numeroEnvelope]", "#" + dadosEnvelope.Records[0].NumeroEnvelope );
					
					var prescricao = $("#TemplatePrescricaoCliente").html();
					var laborat = $("#TemplatePrescricaoLaboratorio").html();
					
					var itens = GeeksSQL("Select * from DocumentoItem where CodigoDocumento = 0" + item, false, url, banco, usuario).Records;
					
					var envelopeTotalItens = 0;
					var envelopeDesconto = 0;
					var envelopeTotal = 0;
					var lodEsferico;
					var loeEsferico;
					var lodCilindrico;
					var loeCilindrico;
					var lodEixo;
					var loeEixo;
					var lodAdicao;
					var loeAdicao;
					var lodAlterada;
					var loeAlterada;
					var lodCodigo;
					var loeCodigo;
					var mesmaLente = false;
					var valorLentes = 0;
					var codigoTLOD = 0;
					var codigoTLOE = 0;
					var valorTLOD = 0;
					var valorTLOE = 0;
					$(itens).each(function(index, row){
						
						if (row.TipoItem == "Armação")
						{
							sumario = sumario.replace("[armacaoDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[armacaoMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[armacaoQtde]", row.Quantidade)
											.replace("[armacaoValor]", row.Total.toFixed(2).replace('.', ','));
							prescricao = prescricao.replace("[armacaoDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[armacaoMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[armacaoQtde]", row.Quantidade)
											.replace("[armacaoValor]", row.Total.toFixed(2).replace('.', ','));
							laborat = laborat.replace("[armacaoDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[armacaoMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[armacaoQtde]", row.Quantidade)
											.replace("[armacaoValor]", row.Total.toFixed(2).replace('.', ','));
						}
						else if (row.TipoItem == "LOD")
						{
							if (row.PrescricaoAlterada) {
								lodAlterada = true;
								lodEsferico = row.Esferico;
								lodCilindrico = row.Cilindrico;
								lodEixo = row.Eixo;
								lodAdicao = row.Adicao;
							}
							else lodAlterada = false;

							lodCodigo = row.CodigoItem;
							valorLentes = valorLentes + row.Total;
							if (loeCodigo && row.CodigoItem == loeCodigo)
							{
								mesmaLente = true;
							}
							sumario = sumario.replace("[lodDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[lodMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[lodQtde]", row.Quantidade)
											.replace("[lodValor]", row.Total.toFixed(2).replace('.', ','));
							prescricao = prescricao.replace("[lodDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[lodMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[lodQtde]", row.Quantidade)
											.replace("[lodValor]", row.Total.toFixed(2).replace('.', ','));
							laborat = laborat.replace("[lodDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[lodMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[lodQtde]", row.Quantidade)
											.replace("[lodValor]", row.Total.toFixed(2).replace('.', ','));	
						}
						else if (row.TipoItem == "LOE")
						{
							if (row.PrescricaoAlterada) {
								loeAlterada = true;
								loeEsferico = row.Esferico;
								loeCilindrico = row.Cilindrico;
								loeEixo = row.Eixo;
								loeAdicao = row.Adicao;
							}
							else loeAlterada = false;
							
							loeCodigo = row.CodigoItem;
							valorLentes = valorLentes + row.Total;
							if (lodCodigo && row.CodigoItem == lodCodigo)
							{
								mesmaLente = true;
							}
							sumario = sumario.replace("[loeDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[loeMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[loeQtde]", row.Quantidade)
											.replace("[loeValor]", row.Total.toFixed(2).replace('.', ','));
							prescricao = prescricao.replace("[loeDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[loeMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[loeQtde]", row.Quantidade)
											.replace("[loeValor]", row.Total.toFixed(2).replace('.', ','));
							laborat = laborat.replace("[loeDescricao]", (row.DescricaoItem == "" ? "Própria" : row.DescricaoItem))
											.replace("[loeMarca]", (row.Marca && row.Marca != null && row.Marca != "null" ? row.Marca : "&nbsp;"))
											.replace("[loeQtde]", row.Quantidade)
											.replace("[loeValor]", row.Total.toFixed(2).replace('.', ','));
						}
						else if (row.TipoItem == "TLOD")
						{
							codigoTLOD += row.CodigoItem;
							valorTLOD += (row.ValorItem-row.DescontoItem);
							var tratamento = $("#TemplateSumarioTratamento").html();
							tratamento = tratamento.replace("[tratamentoDescricao]", row.DescricaoItem)
								.replace("[tratamentoQtde]", "1")
								.replace("[tratamentoValor]", (row.ValorItem-row.DescontoItem).toFixed(2).replace('.', ','));
							prescricao = $("<div></div>").append(prescricao);
							prescricao.find(".TLOD").each(function() {
								$( this ).append(tratamento);
							});
							prescricao = prescricao.html();
							sumario = $("<div></div>").append(sumario);
							sumario.find(".TLOD").each(function() {
								$( this ).append(tratamento);
							});
							sumario = sumario.html();
							
							tratamento = $("#TemplateLaboratorioTratamento").html();
							tratamento = tratamento.replace("[tratamentoDescricao]", row.DescricaoItem)
								.replace("[tratamentoQtde]", "1");
							laborat = $("<div></div>").append(laborat);
							laborat.find(".TLOD").each(function() {
								$( this ).append(tratamento);
							});
							laborat = laborat.html();
							
						}
						else if (row.TipoItem == "TLOE")
						{
							codigoTLOE += row.CodigoItem;
							valorTLOE += (row.ValorItem-row.DescontoItem);
							var tratamento = $("#TemplateSumarioTratamento").html();
							tratamento = tratamento.replace("[tratamentoDescricao]", row.DescricaoItem)
								.replace("[tratamentoQtde]", "1")
								.replace("[tratamentoValor]", (row.ValorItem-row.DescontoItem).toFixed(2).replace('.', ','));
							prescricao = $("<div></div>").append(prescricao);
							prescricao.find(".TLOE").each(function() {
								$( this ).append(tratamento);
							});
							prescricao = prescricao.html();
							sumario = $("<div></div>").append(sumario);
							sumario.find(".TLOE").each(function() {
								$( this ).append(tratamento);
							});
							sumario = sumario.html();
							
							tratamento = $("#TemplateLaboratorioTratamento").html();
							tratamento = tratamento.replace("[tratamentoDescricao]", row.DescricaoItem)
								.replace("[tratamentoQtde]", "1");
							laborat = $("<div></div>").append(laborat);
							laborat.find(".TLOE").each(function() {
								$( this ).append(tratamento);
							});
							laborat = laborat.html();
						}
						if ((!envelope || envelope == "") || (envelope && codigoEnvelope == envelope))
						{
							qtdeTotal = qtdeTotal + row.Quantidade;
							valorTotal = valorTotal + row.Total;
						}
						envelopeTotalItens = envelopeTotalItens + (row.ValorItem*row.Quantidade);
						envelopeDesconto = envelopeDesconto + (row.DescontoItem*row.Quantidade);
						envelopeTotal = envelopeTotal + (row.Total*row.Quantidade);
					});
					
					if (mesmaLente && codigoTLOD == codigoTLOE && valorTLOD == valorTLOE)
					{
						sumario = $("<div></div>").append(sumario);
						sumario.find(".linhaLOE").each(function() {
							$( this ).css("display","none");
						});
						sumario.find(".TLOE").each(function() {
							$( this ).css("display","none");
						});
						sumario.find(".lodQtde").each(function() {
							$( this ).html("2");
						});
						sumario.find(".lodValor").each(function() {
							$( this ).html(valorLentes.toFixed(2).replace('.', ','));
						});
						sumario.find(".tratamentoQtde").each(function() {
							$( this ).html("2");
						});
						sumario.find(".tratamentoValor").each(function() {
							$( this ).html((Number($( this ).html().replace(',', '.'))*2).toFixed(2).replace('.', ','));
						});
						sumario = sumario.html();
						
						prescricao = $("<div></div>").append(prescricao);
						prescricao.find(".linhaLOE").each(function() {
							$( this ).css("display","none");
						});
						prescricao.find(".TLOE").each(function() {
							$( this ).css("display","none");
						});
						prescricao.find(".lodQtde").each(function() {
							$( this ).html("2");
						});
						prescricao.find(".lodValor").each(function() {
							$( this ).html(valorLentes.toFixed(2).replace('.', ','));
						});
						prescricao.find(".tratamentoQtde").each(function() {
							$( this ).html("2");
						});
						prescricao.find(".tratamentoValor").each(function() {
							$( this ).html((Number($( this ).html().replace(',', '.'))*2).toFixed(2).replace('.', ','));
						});
						prescricao = prescricao.html();
					}
					if (mesmaLente && codigoTLOD == codigoTLOE)
					{	
						laborat = $("<div></div>").append(laborat);
						laborat.find(".linhaLOE").each(function() {
							$( this ).css("display","none");
						});
						laborat.find(".TLOE").each(function() {
							$( this ).css("display","none");
						});
						laborat.find(".lodQtde").each(function() {
							$( this ).html("2");
						});
						laborat.find(".tratamentoQtde").each(function() {
							$( this ).html("2");
						});
						laborat = laborat.html();
					}
										
					if ((!envelope || envelope == "") || (envelope && codigoEnvelope == envelope))
						$("#Envelopes").append(sumario);
					
					vendasEnvelope = vendasEnvelope.replace("[envelopeTotelItens]",envelopeTotalItens.toFixed(2).replace('.', ','))
						.replace("[envelopeDesconto]",envelopeDesconto.toFixed(2).replace('.', ','))
						.replace("[envelopeTotal]",envelopeTotal.toFixed(2).replace('.', ','));
						
					$(".VendasEnvelopes").each(function() {
						$( this ).append(vendasEnvelope);
					});
					
					if (itemVenda.Records[0].Operacao != 'Lente de Contato Surfaçada') {

						var OdLonge = GeeksSQL("Select Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base, DIOD, DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Longe'", false, url, banco, usuario).Records[0];

						var OdMedio = GeeksSQL("Select Adicao, Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base, DIOD, DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Medio'", false, url, banco, usuario).Records[0];

						var OdPerto = GeeksSQL("Select Adicao, Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base, DIOD, DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Perto'", false, url, banco, usuario).Records[0];

						var OeLonge = GeeksSQL("Select Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Longe'", false, url, banco, usuario).Records[0];

						var OeMedio = GeeksSQL("Select Adicao, Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Medio'", false, url, banco, usuario).Records[0];

						var OePerto = GeeksSQL("Select Adicao, Esferico, Cilindrico, Eixo, IsNull(Prisma, 0) Prisma, Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Perto'", false, url, banco, usuario).Records[0];

						var OedAlturaMontagem = GeeksSQL("Select ISNULL(AlturaMontagemOD, 0.00) AS 'AlturaMontagemOD', IsNull(AlturaMontagemOE, 0.00) AS 'AlturaMontagemOE' from DocumentoItem  where CodigoDocumento = 0" + item + "and AlturaMontagemOD IS NOT null and AlturaMontagemOE is NOT NULL", false, url, banco, usuario).Records[0];

						// Longe
						prescricao = prescricao.replace("[OELEsf]",(loeAlterada ? loeEsferico : Number(OeLonge.Esferico)).toFixed(2).replace(".", ","))
							.replace("[OELCil]",(loeAlterada ? loeCilindrico : Number(OeLonge.Cilindrico)).toFixed(2).replace(".", ","))
							.replace("[OELEix]",(loeAlterada ? loeEixo : OeLonge.Eixo))
							.replace("[OELPri]",OeLonge.Prisma)
							.replace("[OELBas]",OeLonge.Base)
							.replace("[OELDNP]",Number(OdLonge.DIOE).toFixed(2).replace(".", ","));

						prescricao = prescricao.replace("[ODLEsf]",(lodAlterada ? lodEsferico : Number(OdLonge.Esferico)).toFixed(2).replace(".", ","))
							.replace("[ODLCil]",(lodAlterada ? lodCilindrico : Number(OdLonge.Cilindrico)).toFixed(2).replace(".", ","))
							.replace("[ODLEix]",(lodAlterada ? lodEixo : OdLonge.Eixo))
							.replace("[ODLPri]",OdLonge.Prisma)
							.replace("[ODLBas]",OdLonge.Base)
							.replace("[ODLDNP]",Number(OdLonge.DIOD).toFixed(2).replace(".", ","));

						// Médio
						prescricao = prescricao.replace("[OEMAdi]",(loeAlterada ? loeAdicao : Number(OeMedio.Adicao)).toFixed(2).replace(".", ","))
							.replace("[OEMEsf]",(loeAlterada ? loeAdicao + loeEsferico : Number(OeMedio.Esferico)).toFixed(2).replace(".", ","))
							.replace("[OEMCil]",Number(OeMedio.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[OEMEix]",OeMedio.Eixo)
							.replace("[OEMPri]",OeMedio.Prisma)
							.replace("[OEMBas]",OeMedio.Base)
							.replace("[OEMDNP]",Number(OdMedio.DIOE).toFixed(2).replace(".", ","));
						
						prescricao = prescricao.replace("[ODMAdi]",(lodAlterada ? lodAdicao : Number(OdMedio.Adicao)).toFixed(2).replace(".", ","))
							.replace("[ODMEsf]",(lodAlterada ? lodAdicao + lodEsferico : Number(OdMedio.Esferico)).toFixed(2).replace(".", ","))
							.replace("[ODMCil]",Number(OdMedio.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[ODMEix]",OdMedio.Eixo)
							.replace("[ODMPri]",OdMedio.Prisma)
							.replace("[ODMBas]",OdMedio.Base)
							.replace("[ODMDNP]",Number(OdMedio.DIOD).toFixed(2).replace(".", ","));

						// Perto
						prescricao = prescricao.replace("[OEPAdi]",Number(OePerto.Adicao).toFixed(2).replace(".", ","))
							.replace("[OEPEsf]",Number(OePerto.Esferico).toFixed(2).replace(".", ","))
							.replace("[OEPCil]",Number(OePerto.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[OEPEix]",OePerto.Eixo)
							.replace("[OEPPri]",OePerto.Prisma)
							.replace("[OEPBas]",OePerto.Base)
							.replace("[OEPDNP]",Number(OdPerto.DIOE).toFixed(2).replace(".", ","));
						
						prescricao = prescricao.replace("[ODPAdi]",Number(OdPerto.Adicao).toFixed(2).replace(".", ","))
							.replace("[ODPEsf]",Number(OdPerto.Esferico).toFixed(2).replace(".", ","))
							.replace("[ODPCil]",Number(OdPerto.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[ODPEix]",OdPerto.Eixo)
							.replace("[ODPPri]",OdPerto.Prisma)
							.replace("[ODPBas]",OdPerto.Base)
							.replace("[ODPDNP]",Number(OdPerto.DIOD).toFixed(2).replace(".", ","));
						
						// Longe
						laborat = laborat.replace("[OELEsf]",Number(OeLonge.Esferico).toFixed(2).replace(".", ","))
							.replace("[OELCil]",Number(OeLonge.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[OELEix]",OeLonge.Eixo)
							.replace("[OELPri]",OeLonge.Prisma)
							.replace("[OELBas]",OeLonge.Base)
							.replace("[OELDNP]",Number(OdLonge.DIOE).toFixed(2).replace(".", ","));

						laborat = laborat.replace("[ODLEsf]",Number(OdLonge.Esferico).toFixed(2).replace(".", ","))
							.replace("[ODLCil]",Number(OdLonge.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[ODLEix]",OdLonge.Eixo)
							.replace("[ODLPri]",OdLonge.Prisma)
							.replace("[ODLBas]",OdLonge.Base)
							.replace("[ODLDNP]",Number(OdLonge.DIOD).toFixed(2).replace(".", ","));

						// Médio
						laborat = laborat.replace("[OEMAdi]",Number(OeMedio.Adicao).toFixed(2).replace(".", ","))
							.replace("[OEMEsf]",Number(OeMedio.Esferico).toFixed(2).replace(".", ","))
							.replace("[OEMCil]",Number(OeMedio.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[OEMEix]",OeMedio.Eixo)
							.replace("[OEMPri]",OeMedio.Prisma)
							.replace("[OEMBas]",OeMedio.Base)
							.replace("[OEMDNP]",Number(OdMedio.DIOE).toFixed(2).replace(".", ","));
						
						laborat = laborat.replace("[ODMAdi]",Number(OdMedio.Adicao).toFixed(2).replace(".", ","))
							.replace("[ODMEsf]",Number(OdMedio.Esferico).toFixed(2).replace(".", ","))
							.replace("[ODMCil]",Number(OdMedio.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[ODMEix]",OdMedio.Eixo)
							.replace("[ODMPri]",OdMedio.Prisma)
							.replace("[ODMBas]",OdMedio.Base)
							.replace("[ODMDNP]",Number(OdMedio.DIOD).toFixed(2).replace(".", ","));

						// Perto
						laborat = laborat.replace("[OEPAdi]",Number(OePerto.Adicao).toFixed(2).replace(".", ","))
							.replace("[OEPEsf]",Number(OePerto.Esferico).toFixed(2).replace(".", ","))
							.replace("[OEPCil]",Number(OePerto.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[OEPEix]",OePerto.Eixo)
							.replace("[OEPPri]",OePerto.Prisma)
							.replace("[OEPBas]",OePerto.Base)
							.replace("[OEPDNP]",Number(OdPerto.DIOE).toFixed(2).replace(".", ","));
						
						laborat = laborat.replace("[ODPAdi]",Number(OdPerto.Adicao).toFixed(2).replace(".", ","))
							.replace("[ODPEsf]",Number(OdPerto.Esferico).toFixed(2).replace(".", ","))
							.replace("[ODPCil]",Number(OdPerto.Cilindrico).toFixed(2).replace(".", ","))
							.replace("[ODPEix]",OdPerto.Eixo)
							.replace("[ODPPri]",OdPerto.Prisma)
							.replace("[ODPBas]",OdPerto.Base)
							.replace("[ODPDNP]",Number(OdPerto.DIOD).toFixed(2).replace(".", ","));
						
						if(OedAlturaMontagem != undefined){
							prescricao = prescricao.replace("[AlturaMontagemOD]",Number(OedAlturaMontagem.AlturaMontagemOD).toFixed(2).replace(".", ","))
								.replace("[AlturaMontagemOE]",Number(OedAlturaMontagem.AlturaMontagemOE).toFixed(2).replace(".", ","));
							laborat = laborat.replace("[AlturaMontagemOD]",Number(OedAlturaMontagem.AlturaMontagemOD).toFixed(2).replace(".", ","))
								.replace("[AlturaMontagemOE]",Number(OedAlturaMontagem.AlturaMontagemOE).toFixed(2).replace(".", ","))
						}
						else {
							prescricao = prescricao.replace("[AlturaMontagemOD]",Number(0).toFixed(2).replace(".", ","))
								.replace("[AlturaMontagemOE]",Number(0).toFixed(2).replace(".", ","));
							laborat = laborat.replace("[AlturaMontagemOD]",Number(0).toFixed(2).replace(".", ","))
								.replace("[AlturaMontagemOE]",Number(0).toFixed(2).replace(".", ","));
						}

					} else {

						$(".oculosOuLente").append($("#lenteAumento").html());

						var lod = GeeksSQL("select Esferico, Cilindrico, Eixo, Adicao from DocumentoItem where TipoItem = 'LOD' and CodigoDocumento = 0" + item, false, url, banco, usuario);
						var loe = GeeksSQL("select Esferico, Cilindrico, Eixo, Adicao from DocumentoItem where TipoItem = 'LOE' and CodigoDocumento = 0" + item, false, url, banco, usuario);

						if (lod.Records[0] != null) {
							$(".lodAdc").html(Number(lod.Records[0].Adicao).toFixed(2).replace(".", ","));
							$(".lodEsf").html(Number(lod.Records[0].Eixo).toFixed(2).replace(".", ","));
							$(".lodCil").html(Number(lod.Records[0].Cilindrico).toFixed(2).replace(".", ","));
							$(".lodEixo").html(lod.Records[0].Esferico);
						}

						if (loe.Records[0] != null) {
							$(".loeAdc").html(Number(loe.Records[0].Adicao).toFixed(2).replace(".", ","));
							$(".loeEsf").html(Number(loe.Records[0].Eixo).toFixed(2).replace(".", ","));
							$(".loeCil").html(Number(loe.Records[0].Cilindrico).toFixed(2).replace(".", ","));
							$(".loeEixo").html(loe.Records[0].Esferico);
						}

					}
					
					var tipoOculos = GeeksSQL("select IsNull(TipoOculos,'-') TipoOculos, Oculos from DocumentoItem where TipoItem = 'Armação' and CodigoDocumento = 0" + item, false, url, banco, usuario);

					if (tipoOculos.Records[0] == undefined)
						tipoOculos = "Lente Surfaçada";
					else{
						prescricao = $("<div></div>").append(prescricao);
						laborat = $("<div></div>").append(laborat);
						switch (tipoOculos.Records[0].Oculos) {
							case "MonofocalLonge":
								prescricao.find(".linhaDireitoPerto").remove();
								prescricao.find(".linhaDireitoMedio").remove(); 
								prescricao.find(".linhaEsquerdoPerto").remove();
								prescricao.find(".linhaEsquerdoMedio").remove(); 
								prescricao.find("#TipoOculos").html("Monofocal (Longe)");              		
								
								laborat.find(".linhaDireitoPerto").remove();
								laborat.find(".linhaDireitoMedio").remove(); 
								laborat.find(".linhaEsquerdoPerto").remove();
								laborat.find(".linhaEsquerdoMedio").remove(); 
								laborat.find("#TipoOculos").html("Monofocal (Longe)");  
							break;

							case "MonofocalPerto":
								prescricao.find(".linhaDireitoLonge").remove();
								prescricao.find(".linhaDireitoMedio").remove();  
								prescricao.find(".linhaEsquerdoLonge").remove();
								prescricao.find(".linhaEsquerdoMedio").remove();
								prescricao.find("#TipoOculos").html("Monofocal (Perto)");
								
								laborat.find(".linhaDireitoLonge").remove();
								laborat.find(".linhaDireitoMedio").remove();  
								laborat.find(".linhaEsquerdoLonge").remove();
								laborat.find(".linhaEsquerdoMedio").remove();
								laborat.find("#TipoOculos").html("Monofocal (Perto)");
							break;

							case "Bifocal":
								prescricao.find(".linhaDireitoMedio").remove(); 
								prescricao.find(".linhaEsquerdoMedio").remove(); 
								prescricao.find("#TipoOculos").html("Bifocal (Longe e Perto)");  
								
								laborat.find(".linhaDireitoMedio").remove(); 
								laborat.find(".linhaEsquerdoMedio").remove(); 
								laborat.find("#TipoOculos").html("Bifocal (Longe e Perto)");  
								laborat.find("#TipoOculos").html("Bifocal (Longe e Perto)");  
							break;

							case "Multifocal":
								prescricao.find(".linhaDireitoMedio").remove(); 
								prescricao.find(".linhaEsquerdoMedio").remove();    
								prescricao.find("#TipoOculos").html("Multifocal (Longe e Perto)"); 
								
								laborat.find(".linhaDireitoMedio").remove(); 
								laborat.find(".linhaEsquerdoMedio").remove();    
								laborat.find("#TipoOculos").html("Multifocal (Longe e Perto)"); 
							break;

							case "Intermediario":
								prescricao.find(".linhaDireitoLonge").remove();
								prescricao.find(".linhaEsquerdoLonge").remove();
								prescricao.find("#TipoOculos").html("Intermediário (Médio e Perto)");
								
								laborat.find(".linhaDireitoLonge").remove();
								laborat.find(".linhaEsquerdoLonge").remove();
								laborat.find("#TipoOculos").html("Intermediário (Médio e Perto)");
							break;
							tipoOculos = tipoOculos.Records[0].TipoOculos;
						}
						laborat.find(".ObsPrescricao").each(function() {
							$( this ).html(dadosEnvelope.Records[0].Observacao);
						});
						
						prescricao = prescricao.html();						
						laborat = laborat.html();

						prescricao = prescricao.replace("[CodBarrasEnvelope]", "CodBarrasCliente"+codigoEnvelope)
							.replace("[CodEnvelope]", "CodEnvelopeCliente"+codigoEnvelope);
						laborat = laborat.replace("[CodBarrasEnvelope]", "CodBarrasCliente"+codigoEnvelope)
							.replace("[CodEnvelope]", "CodEnvelopeCliente"+codigoEnvelope);
					}

					$(".tipoOculos").html("Tipo de Óculos/Lente: " + tipoOculos);

					var dadosMedicoPaciente = GeeksSQL("Select d.CodigoDocumento, DescricaoContato Paciente, IsNull((Select Nome from Contato where CodigoContato = dc.CodigoContato),'Não informado') DescricaoMedico from Documento d left join DocumentoContato dc on d.CodigoDocumento = dc.CodigoDocumento and dc.Descricao = 'Medico' where d.CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = 0" + item + ")", false, url, banco, usuario);

					if(dadosMedicoPaciente.Records[0] != undefined) {
						prescricao = prescricao.replace("[nomePaciente]",dadosMedicoPaciente.Records[0].Paciente);
						prescricao = prescricao.replace("[nomeMedico]",dadosMedicoPaciente.Records[0].DescricaoMedico); 
						laborat = laborat.replace("[nomePaciente]",dadosMedicoPaciente.Records[0].Paciente);
						laborat = laborat.replace("[nomeMedico]",dadosMedicoPaciente.Records[0].DescricaoMedico); 
					}

					var ObservacaoPrescricao = GeeksSQL("select TOP 1 Observacao from Documento d where d.CodigoDocumento = 0" + codigoEnvelope + "-1 ORDER by d.DataHoraEmissao", false, url, banco, usuario); 

					if(ObservacaoPrescricao.Records[0] != undefined) {
						$(".obsPresc").html(ObservacaoPrescricao.Records[0].Observacao);
					}
					
					prescricao = prescricao.replace("[dataPrevisto]",dadosEnvelope.Records[0].Previsto == '01/01/1900' ? " " : dadosEnvelope.Records[0].Previsto);
					laborat = laborat.replace("[dataPrevisto]",dadosEnvelope.Records[0].Previsto == '01/01/1900' ? " " : dadosEnvelope.Records[0].Previsto);
					
					laborat = laborat.replace("[dataVenda]", dadosVenda.Records[0].Finalizado);	
					
					if ((!envelope || envelope == "") || (envelope && codigoEnvelope == envelope))
					{
						$("#PrescricaoCliente").append(prescricao);
						$("#PrescricaoLaboratorio").append(laborat);
					}
					
					// Geração do código de barras
					var numero = String(codigoEnvelope);
					var zeros = 13 - Number(numero.length);

					for (var i = 0; i < zeros; i++) 
						numero = '0' + numero;

					$(".CodBarrasCliente"+codigoEnvelope).each(function() {
						$( this ).css("white-space", "nowrap");
						$( this ).css("background-color", "#fff");
						$( this ).html(fbarcode(numero,20));
					});
					$(".CodEnvelopeCliente"+codigoEnvelope).each(function() {
						$( this ).html(codigoEnvelope);
					});
					
					/*
					var bc = document.getElementById("CodBarrasCliente"+codigoEnvelope);
					html2canvas(bc, {
						onrendered: function(canvas) {
							var img = canvas.toDataURL("image/jpeg");
								$("#CodBarrasCliente"+codigoEnvelope).html("");
								$("#CodBarrasCliente"+codigoEnvelope).append('<img style="height: 20px" src="' + img + '"></img>');
						}
					});*/
					
				}
				
				var outrosItens = GeeksSQL("Select d.Descricao, di.Marca, di.Quantidade, di.Total, ValorItem, DescontoItem from Documento d inner join DocumentoItem di on di.CodigoDocumento = d.CodigoDocumento where (NaturezaOperacao is null or NaturezaOperacao <> 'Devolução') and d.CodigoDocumentoAdicional = 0" + pedido + " and d.CodigoDocumento not in (select CodigoDocumentoAdicional from Documento where CodigoDocumentoAdicional in (Select CodigoDocumento from Documento where CodigoDocumentoAdicional = 0" + pedido + ")) Union Select DescricaoItem, Marca, Quantidade, Total, ValorItem, DescontoItem from DocumentoItem where CodigoDocumento = 0" + pedido, false, url, banco, usuario).Records;
				var outrosTotalItens = 0;
				var outrosTotalDesconto = 0;
				var outrosTotal = 0;
				$(outrosItens).each(function(index, row){
					var sumario = $("#TemplateSumarioAvulso").html();			
					sumario = sumario.replace("[outroDescricao]", row.Descricao)
									 .replace("[outroMarca]", (row.Marca ? row.Marca : "&nbsp;"))
									 .replace("[outroQtde]", row.Quantidade)
									 .replace("[outroValor]", row.Total.toFixed(2).replace('.', ','))
					$(".Avulsos").each(function() {
						$( this ).append(sumario);
					});
					qtdeTotal = qtdeTotal + row.Quantidade;
					valorTotal = valorTotal + row.Total;
					outrosTotalItens = outrosTotalItens + (row.ValorItem*row.Quantidade);
					outrosTotalDesconto = outrosTotalDesconto + (row.DescontoItem*row.Quantidade);
					outrosTotal = outrosTotal + row.Total;
				});
				$(".SumarioQtdeTotal").each(function() {
					$( this ).html(qtdeTotal);
				});
				$(".SumarioValorTotal").each(function() {
					$( this ).html(valorTotal.toFixed(2).replace('.', ','));
				});
				
				if (outrosTotalItens == 0)
				{
					$(".divOutrosProdutos").each(function() {
						$( this ).css("display","none");
					});
				}
				else
				{
					$(".templateVendasOutrosTotalItens").each(function() {
						$( this ).html(outrosTotalItens.toFixed(2).replace('.', ','));
					});
					$(".templateVendasOutrosDesconto").each(function() {
						$( this ).html(outrosTotalDesconto.toFixed(2).replace('.', ','));
					});
					$(".templateVendasOutrosTotal").each(function() {
						$( this ).html(outrosTotal.toFixed(2).replace('.', ','));
					});
				}

				var faturaPedido = GeeksSQL("select CodigoFatura from Documento where CodigoDocumento = 0" + pedido, false, url, banco, usuario).Records[0].CodigoFatura;

				var valorPago = 0;
				var totalFatura = 0;
				if (faturaPedido == null || faturaPedido == undefined) {
					$(".divOutrosPedidos").each(function() {
						$( this ).css("display","none");
					});
					$(".divFatura").each(function() {
						$( this ).css("display","none");
					});
					$(".saldoPagar").each(function() {
						$( this ).html((dadosVenda.Records[0].TotalDocumento - totalDevolucoes).toFixed(2).replace(".", ","));
					});
					if (totalDevolucoes == 0)
						$(".divDevolucoes").each(function() {
							$( this ).css("display","none");
						});
					else 
						$(".saldoDevolucao").each(function() {
							$( this ).html(totalDevolucoes.toFixed(2).replace(".", ","));
						});	
				} else {

					var formasPagamento = GeeksSQL("select D.CodigoFormaPagamento, sum(D.Valor) Valor, D.Sinal, F.Descricao, Case when count(*) > 1 then Cast(Count(*) as varchar) + 'x' else ' ' end Parcelas from DocumentoCondicaoPagamento D inner join FormaPagamento F on D.CodigoFormaPagamento = F.CodigoFormaPagamento where D.CodigoDocumento = (select CodigoFatura from Documento where CodigoDocumento = 0" + pedido + ") group by D.CodigoFormaPagamento, D.Sinal, F.Descricao order by Sinal desc", false, url, banco, usuario);

					var pedidosFatura = 0.0;

					$(formasPagamento.Records).each(function(index, row){

						$(".FormasPgto").each(function() {
							$( this ).append(
								$("#TemplateFormaPgto").html()
								.replace("[descricao]", row.Sinal == 1 ? "Sinal " + row.Descricao : row.Descricao)
								.replace("[parcelas]", row.Parcelas)
								.replace("[valor]", row.Valor.toFixed(2).replace(".", ","))
							);
						});

						pedidosFatura += row.Valor;
						valorPago += row.Valor;
					});
					
					var retorno = GeeksSQL("select Sum(TotalDocumento) Total, count(*) Itens from Documento where CodigoFatura = 0" + faturaPedido, false, url, banco, usuario).Records;
					if (retorno) pedidosFatura = retorno[0].Total;
					
					var fatura = GeeksSQL("select *, IsNull(Convert(varchar(10), DataHoraFinalizado, 103), Convert(varchar(10), DataHoraEmissao, 103)) Finalizado, IsNull(Convert(varchar(10), DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), DataHoraFinalizado, 108), Convert(varchar(10), DataHoraEmissao, 103) + ' ' + Convert(varchar(10), DataHoraEmissao, 108)) FinalizadoCompleto from Documento where CodigoDocumento = 0" + faturaPedido, false, url, banco, usuario).Records;
					totalFatura = fatura[0].TotalDocumento;
					$(".numeroFatura").each(function() {
						$( this ).html(fatura[0].Numero);
					});
					$(".dataFatura").each(function() {
						$( this ).html(fatura[0].Finalizado);
					});
					$(".dataFaturaCompleta").each(function() {
						$( this ).html(fatura[0].FinalizadoCompleto);
					});
					$(".totalItensFatura").each(function() {
						$( this ).html(pedidosFatura.toFixed(2).replace(".", ","));
					});
					$(".descontoFatura").each(function() {
						$( this ).html(fatura[0].TotalDesconto.toFixed(2).replace(".", ","));
					});
					$(".totalFatura").each(function() {
						$( this ).html(fatura[0].TotalDocumento.toFixed(2).replace(".", ","));
					});
					
					var totalFaturado = fatura[0].TotalDocumento;
					outrosPedidosFatura = totalFaturado - valorVenda;
					if (outrosPedidosFatura == 0)
						$(".divOutrosPedidos").each(function() {
							$( this ).css("display","none");
						});
					else
						$(".valorOutrosPedidos").html("(+) R$ " + outrosPedidosFatura.toFixed(2).replace('.', ','));
						
					$(".saldoPagar").each(function() {
						$( this ).html((totalFatura-valorPago).toFixed(2).replace(".", ","));
					});
					if (totalDevolucoes == 0)
						$(".divDevolucoes").each(function() {
							$( this ).css("display","none");
						});
					else 
						$(".saldoDevolucao").each(function() {
							$( this ).html(totalDevolucoes.toFixed(2).replace(".", ","));
						});	
				}
				

				var textoAssinatura = "Eu, <b>" + dadosCliente.Records[0].Nome + "</b>, ";
				if (dadosCliente.Records[0].Endereco != null)
					textoAssinatura += "residente na <b>" + dadosCliente.Records[0].Endereco + "</b>, ";
				if (dadosCliente.Records[0].NumeroDocumentoEstadual != null)
					textoAssinatura += "portador do RG <b>" + dadosCliente.Records[0].NumeroDocumentoEstadual + "</b>, ";
				if (dadosCliente.Records[0].TipoDocumentoNacional != null)
					textoAssinatura += "portador do " + dadosCliente.Records[0].TipoDocumentoNacional + " <b>";
				 else
					textoAssinatura += "portador do Doc:" + "<b> ";    
				if (dadosCliente.Records[0].NumeroDocumentoNacional != null)
					textoAssinatura +=  dadosCliente.Records[0].NumeroDocumentoNacional + "</b>, ";
				textoAssinatura += "declaro estar adquirindo da <b>" + dadosEmissor.Records[0].Nome + "</b> os produtos de minha necessidade, totalizando um valor de <b>";
				textoAssinatura += "R$ " + valorTotal.toFixed(2).replace(".", ",") + "</b>.";

				$(".textoAssinatura").html(textoAssinatura);
					
				$(".codPedido").each(function() {
					$( this ).html("Número " + pedido);
				});
				$(".fantasiaEmissor").each(function() {
					$( this ).html(dadosEmissor.Records[0].Nome);
				});
				$(".emailEmissor").each(function() {
					$( this ).html(dadosEmissor.Records[0].Email);
				});
				$(".enderecoEmissor").each(function() {
					$( this ).html(dadosEmissor.Records[0].Endereco);
				});
				$(".siteEmissor").each(function() {
					$( this ).html(dadosEmissor.Records[0].Site);
				});
				$(".telefoneEmissor").each(function() {
					$( this ).html(dadosEmissor.Records[0].Telefone);
				});

				if (dadosEmissor.Records[0].Imagem != "Não informado")
					$(".logo").each(function() {
						$( this ).html('<img class="img-responsive" src="' + dadosEmissor.Records[0].Imagem.split("#")[0] + '" />');
				});
				
				$(".dataImpressao").each(function() {
					$( this ).html(dadosVenda.Records[0].Agora);				
				});

				/*Adicionado pela optidados*/
		        var ObservacaoPrescricao = GeeksSQL("select Observacao from Documento d inner join DocumentoContato dc on d.CodigoDocumento = dc.CodigoDocumento and dc.Descricao = 'Medico' where d.CodigoDocumento = 0" + codigoEnvelope + "-1", false, url, banco, usuario);

		        if(ObservacaoPrescricao.Records[0] != undefined) {
		        	$(".ObservacaoPresc").html(ObservacaoPrescricao.Records[0].Observacao);
		        }
				
				$("#btLoja").click(function () {
					$("#viaLoja").remove();
				});

				$("#btCliente").click(function () {
					$("#viaCliente").remove();
				});

				$("#btLaboratorio").click(function () {
					$("#viaLaboratorio").remove();
				});

			});

		</script>
	</body>
</html>