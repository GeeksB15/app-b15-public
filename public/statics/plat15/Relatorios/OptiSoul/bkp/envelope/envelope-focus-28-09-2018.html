<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Envelope</title>
        <link rel="stylesheet" type="text/css" href="optidados.framework.css"/>
		<script src="/Scripts/jquery-2.1.4.js"></script>
        <script src="/Restricted/Geeks.ERP.BasicReport.js"></script>
        <script src="/Scripts/codigobarras.js"></script>
        <script src="/Plugins/html2canvas.js"></script>

        <style type="text/css">
	    	h1, h2, h3, h4, h5, h6, p, span { padding: 0; margin: 0; font-weight: normal; overflow: hidden; }

			h1 { font-size: 19px; }

			h2 { font-size: 18px; }

			h3 { font-size: 17px; }

			h4 { font-size: 16px; }

			h5 { font-size: 15px; }

			h6 { font-size: 13px; }

			p { font-size: 12px; }

			.envelope-spece { margin-bottom: 90px; position: relative; float: left; }
        </style>

        <style type="text/css" media="print">
            @page {
            	margin-top: 0.45cm;
            	margin-right: 0.45cm;
            	margin-bottom: 0.45cm;
            	margin-left: 0.45cm;
            }

            .envelope-spece { margin-bottom: 0; }
        </style>

		<!--Tratamento-->
		<script id="TempTratamento" type="TempTratamento">
			<li class="w76"> <p>&#8618; [DescricaoTratamento] </p> </li>
			<li class="w07 txt-ac"> <p class="QtdTratamento"> [QtdTratamento] </p> </li>
			<li class="w17 txt-ar"> <p class="ValorTratamento"> [ValorTratamento] </p> </li>
		</script>

		<!--Tratamento Via Laboratório-->
		<script id="TempTratamentoLAB" type="TempTratamentoLAB">
			<li class="w90"> <p>&#8618; [DescricaoTratamento] </p> </li>
			<li class="w10 txt-ac"> <p class="QtdTratamento"> [QtdTratamento] </p> </li>
		</script>

		<!--Template Envelope-->
		<script id="TempEnvelope" type="TempEnvelope">
			<div class="envelope-spece" style="page-break-inside: avoid !important;">
				<!--via loja-->
				<div class="col w48-7 liner-dashed lineb-dashed pr09" style="height:20.5cm;">
	                <!--Logo Loja-->
					<div class="col w50 logo pr03 pb03">
						<img class="img-responsive" src="optsoul-exemplo.png"/>
					</div>

					<!--CodigoBarras - Impresso Em-->
					<div class="col w49 txt-ac">
						<p> Impresso: <span>[ImpressoEm]</span> </p>
						<h4 class="CodBarras[###CodigoEnvelope###]"></h4>
						<p class="CodEnvelope[###CodigoEnvelope###]"></p>
					</div>

					<!--Dados Cliente-->
					<div class="row w100 mt05">
						<h6 class="w100 txt-hidden lineb"> [NomeEmpresa] <span class="float-r">Via Loja</span></h6>
						<p> <span> [CodigoCliente] </span> <span> [NomeCliente] </span> </p>
						<p> [EnderecoCliente] </p>
						<p> [TelefoneCliente] </p>
						<p> Vendedor: <span>[Vendedor]</span></p>
					</div>

					<!--Paciente/Medico-->
					<div class="col w60 mt1">
						<p> Paciente: <span>[NomePaciente]</span> </p>
						<p> Médico: <span>[NomeMedico]</span> </p>
					</div>

					<!--Data Fatura/Previsao-->
					<div class="col w40 mt1">
						<p>Venda: <span>[DataEmissaoVenda]</span> </p>
						<p>Prev.: <span>[DataPrevEntrega]</span> </p>
					</div>

					<!--olho direito-->
					<div class="row w100 lineb mt15">
						<div class="col w87-8">
					        <ul class="list-col txt-ac">
					            <li class="w10"> <p class="b linef">O.D.</p> </li>
					            <li class="w12-8 lineb"> <p> Adc. </p> </li>
					            <li class="w12-8 lineb"> <p> Esf. </p> </li>
					            <li class="w12-8 lineb"> <p> Cil. </p> </li>
					            <li class="w12-8 lineb"> <p> Eixo </p> </li>
					            <li class="w12-8 lineb"> <p> Pris. </p> </li>
					            <li class="w12-8 lineb"> <p> Base </p> </li>
					            <li class="w12-8 lineb"> <p> DNP  </p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoLonge">
					            <li class="w10"> <p class="txt-al"> Longe </p> </li>
					            <li class="w12-8"> <p>&nbsp;</p> </li>
					            <li class="w12-8"> <p>[ODLEsf]</p> </li>
					            <li class="w12-8"> <p>[ODLCil]</p> </li>
					            <li class="w12-8"> <p>[ODLEix]</p> </li>
					            <li class="w12-8"> <p>[ODLPri]</p> </li>
					            <li class="w12-8"> <p>[ODLBas]</p> </li>
					            <li class="w12-8"> <p>[ODLDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoMedio">
					            <li class="w10"> <p class="txt-al"> Medio </p> </li>
					            <li class="w12-8"> <p>[ODMAdi]</p> </li>
					            <li class="w12-8"> <p>[ODMEsf]</p> </li>
					            <li class="w12-8"> <p>[ODMCil]</p> </li>
					            <li class="w12-8"> <p>[ODMEix]</p> </li>
					            <li class="w12-8"> <p>[ODMPri]</p> </li>
					            <li class="w12-8"> <p>[ODMBas]</p> </li>
					            <li class="w12-8"> <p>[ODMDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoPerto">
					            <li class="w10"> <p class="txt-al"> Perto </p> </li>
					            <li class="w12-8"> <p>[ODPAdi]</p> </li>
					            <li class="w12-8"> <p>[ODPEsf]</p> </li>
					            <li class="w12-8"> <p>[ODPCil]</p> </li>
					            <li class="w12-8"> <p>[ODPEix]</p> </li>
					            <li class="w12-8"> <p>[ODPPri]</p> </li>
					            <li class="w12-8"> <p>[ODPBas]</p> </li>
					            <li class="w12-8"> <p>[ODPDNP]</p> </li>
					        </ul>
				        </div>

				        <div class="col w11 txt-ac linel lineb liner">
				        	<p class="lineb"> Alt. Mont. </p>
				        	<p>[AltMontagemLOD]</p>
				        </div>
					</div><!--.end olho direito-->

					<!--olho esquerdo-->
					<div class="col w100 lineb mt1">
						<div class="row w87-8">
					        <ul class="list-col txt-ac">
					            <li class="w10"> <p class="b linef">O.E.</p> </li>
					            <li class="w12-8 lineb"> <p> Adc. </p> </li>
					            <li class="w12-8 lineb"> <p> Esf. </p> </li>
					            <li class="w12-8 lineb"> <p> Cil. </p> </li>
					            <li class="w12-8 lineb"> <p> Eixo </p> </li>
					            <li class="w12-8 lineb"> <p> Pris. </p> </li>
					            <li class="w12-8 lineb"> <p> Base </p> </li>
					            <li class="w12-8 lineb"> <p> DNP  </p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaEsquerdoLonge">
					            <li class="w10"> <p class="txt-al"> Longe </p> </li>
					            <li class="w12-8"> <p>&nbsp;</p> </li>
					            <li class="w12-8"> <p>[OELEsf]</p> </li>
					            <li class="w12-8"> <p>[OELCil]</p> </li>
					            <li class="w12-8"> <p>[OELEix]</p> </li>
					            <li class="w12-8"> <p>[OELPri]</p> </li>
					            <li class="w12-8"> <p>[OELBas]</p> </li>
					            <li class="w12-8"> <p>[OELDNP]</p> </li>
					        </ul>

					    	<ul class="list-col txt-ac linhaEsquerdoMedio">
					        	<li class="w10"> <p class="txt-al"> Medio </p> </li>
					            <li class="w12-8"> <p>[OEMAdi]</p> </li>
					            <li class="w12-8"> <p>[OEMEsf]</p> </li>
					            <li class="w12-8"> <p>[OEMCil]</p> </li>
					            <li class="w12-8"> <p>[OEMEix]</p> </li>
					            <li class="w12-8"> <p>[OEMPri]</p> </li>
					            <li class="w12-8"> <p>[OEMBas]</p> </li>
					            <li class="w12-8"> <p>[OEMDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaEsquerdoPerto">
					        	<li class="w10"> <p class="txt-al"> Perto </p> </li>
					            <li class="w12-8"> <p>[OEPAdi]</p> </li>
					            <li class="w12-8"> <p>[OEPEsf]</p> </li>
					            <li class="w12-8"> <p>[OEPCil]</p> </li>
					            <li class="w12-8"> <p>[OEPEix]</p> </li>
					            <li class="w12-8"> <p>[OEPPri]</p> </li>
					            <li class="w12-8"> <p>[OEPBas]</p> </li>
					            <li class="w12-8"> <p>[OEPDNP]</p> </li>
					        </ul>
					    </div>

				        <div class="col w11 txt-ac linel lineb liner">
				        	<p class="lineb"> Alt. Mont. </p>
				        	<p>[AltMontagemLOE]</p>
				        </div>
					</div><!--.end olho esquerdo-->

					<!--Tipo Oculos-->
					<p class="TipoLente row w100 b mt02 float-r"></p>
					<p class="row w100 b mt02 float-r">[TipoOculos]</p>

					<!--observacao-->
					<div class="row w99-4 linel lineb liner mt1">
						<p>Obs.: <span>[ObservacaoPrescricao]</span></p>
					</div>

					<!--produtos-->
					<div class="row w100 mt15">
						<!--descicao coluna produtos-->
						<ul class="list-col lineb">
							<li class="w57"> <p> Descrição </p> </li>
							<li class="w20"> <p> Marca </p> </li>
							<li class="w07 txt-ac"> <p> Qtd </p> </li>
							<li class="w16 txt-ac"> <p> Preço (R$) </p> </li>
						</ul>

						<!--armação-->
						<ul class="list-col LinhaArmacao" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescArmacao"> [DescArmacao] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaArmacao"> [MarcaArmacao] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdArmacao"> [QtdArmacao] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorArmacao"> [ValorArmacao] </p> </li>
						</ul>

						<!--lente OD-->
						<ul class="list-col LinhaLOD" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescLOD"> [DescLOD] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaLOD"> [MarcaLOD] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdLOD"> [QtdLOD] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOD"> [ValorLOD] </p> </li>
						</ul>

						<!--tratamento OD-->
						<ul class="list-col LinhaTLOD" style="margin-top: 3px;">
							<div class="w95 float-r TLOD"></div>
						</ul>

						<!--lente OE-->
						<ul class="list-col LinhaLOE" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescLOE"> [DescLOE] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaLOE"> [MarcaLOE] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdLOE"> [QtdLOE] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOE"> [ValorLOE] </p> </li>
						</ul>

						<!--tratamento OE-->
						<ul class="list-col LinhaTLOE" style="margin-top: 3px;">
							<div class="w95 float-r TLOE"></div>
						</ul>

						<!--totalizador produtos-->
						<ul class="list-col linet" style="margin-top: 3px;">
							<li class="w77"> <p class="b"> Total: </p> </li>
							<li class="w07 txt-ac"> <p class="b"> [envelopeQtd] </p> </li>
							<li class="w16 txt-ar"> <p class="b"> [envelopeTotal] </p> </li>
						</ul>
					</div><!--.end produtos-->

					<!--contrato-->
					<div class="row w100 mt15">
						<p class="txt-ac lineb">Contrato de Compra</p>
						<p>
							Eu, <span>[NomeCliente]</span>, residente em <span>[LogradouroCliente]</span>, <span>[CidadeCliente]</span>, <span>[UFCliente]</span>, portador do CPF: <span>[CPFCliente]</span> e RG: <span>[RGCliente]</span>. Declaro estar adquirindo da <span>[NomeEmpresa]</span>, os produtos de minha necessidade, totalizando um valor de <span>[envelopeTotal]</span>.
						</p>
						<p class="txt-ac mt3 linet">Assinatura</p>
					</div>
				</div><!--.end via loja-->


				<!--via laboratório-->
				<div class="col w48-7 linel-dashed lineb-dashed pl09" style="height:20.5cm;">
	                <!--dados loja-->
					<div class="col w50 logo pr03 pb03">
						<img class="img-responsive" src="optsoul-exemplo.png"/>
					</div>

					<div class="col w49 txt-ac">
						<p>Impresso: <span>[ImpressoEm]</span> </p>
						<h4 class="CodBarras[###CodigoEnvelope###]"></h4>
						<p class="CodEnvelope[###CodigoEnvelope###]"></p>
					</div>

					<div class="col w100 mt05">
						<h6 class="lineb w100 txt-hidden"> [NomeEmpresa] <span class="float-r">Via Laboratório</span></h6>
						<p> [EnderecoEmpresa] </p>
						<p> [TelefoneEmpresa] </p>
						<p> [EmailEmpresa] </p>
						<p> [SiteEmpresa] </p>
						<p> Vendedor: <span>[Vendedor]</span> </p>
					</div>

					<!--Paciente/Medico-->
					<div class="col w60 mt1">
						<p> Paciente: <span> [NomePaciente] </span> </p>
						<p> Médico: <span> [NomeMedico] </span> </p>
					</div>

					<!--Data Fatura/Previsao-->
					<div class="col w40 mt1">
						<p>Venda: <span> [DataEmissaoVenda] </span> </p>
						<p>Prev.: <span> [DataPrevEntrega] </span> </p>
					</div>

					<!--olho direito-->
					<div class="row w100 lineb mt15">
						<div class="col w87-8">
					        <ul class="list-col txt-ac">
					            <li class="w10"> <p class="b linef">O.D.</p> </li>
					            <li class="w12-8 lineb"> <p> Adc. </p> </li>
					            <li class="w12-8 lineb"> <p> Esf. </p> </li>
					            <li class="w12-8 lineb"> <p> Cil. </p> </li>
					            <li class="w12-8 lineb"> <p> Eixo </p> </li>
					            <li class="w12-8 lineb"> <p> Pris. </p> </li>
					            <li class="w12-8 lineb"> <p> Base </p> </li>
					            <li class="w12-8 lineb"> <p> DNP  </p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoLonge">
					            <li class="w10"> <p class="txt-al"> Longe </p> </li>
					            <li class="w12-8"> <p>.</p> </li>
					            <li class="w12-8"> <p>[ODLEsf]</p> </li>
					            <li class="w12-8"> <p>[ODLCil]</p> </li>
					            <li class="w12-8"> <p>[ODLEix]</p> </li>
					            <li class="w12-8"> <p>[ODLPri]</p> </li>
					            <li class="w12-8"> <p>[ODLBas]</p> </li>
					            <li class="w12-8"> <p>[ODLDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoMedio">
					            <li class="w10"> <p class="txt-al"> Medio </p> </li>
					            <li class="w12-8"> <p>[ODMAdi]</p> </li>
					            <li class="w12-8"> <p>[ODMEsf]</p> </li>
					            <li class="w12-8"> <p>[ODMCil]</p> </li>
					            <li class="w12-8"> <p>[ODMEix]</p> </li>
					            <li class="w12-8"> <p>[ODMPri]</p> </li>
					            <li class="w12-8"> <p>[ODMBas]</p> </li>
					            <li class="w12-8"> <p>[ODMDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaDireitoPerto">
					            <li class="w10"> <p class="txt-al"> Perto </p> </li>
					            <li class="w12-8"> <p>[ODPAdi]</p> </li>
					            <li class="w12-8"> <p>[ODPEsf]</p> </li>
					            <li class="w12-8"> <p>[ODPCil]</p> </li>
					            <li class="w12-8"> <p>[ODPEix]</p> </li>
					            <li class="w12-8"> <p>[ODPPri]</p> </li>
					            <li class="w12-8"> <p>[ODPBas]</p> </li>
					            <li class="w12-8"> <p>[ODPDNP]</p> </li>
					        </ul>
				        </div>

				        <div class="col w11 txt-ac linel lineb liner">
				        	<p class="lineb"> Alt. Mont. </p>
				        	<p> [AltMontagemLOD] </p>
				        </div>
					</div><!--.end olho direito-->

					<!--olho esquerdo-->
					<div class="col w100 lineb mt1">
						<div class="row w87-8">
					        <ul class="list-col txt-ac">
					            <li class="w10"> <p class="b linef">O.E.</p> </li>
					            <li class="w12-8 lineb"> <p> Adc. </p> </li>
					            <li class="w12-8 lineb"> <p> Esf. </p> </li>
					            <li class="w12-8 lineb"> <p> Cil. </p> </li>
					            <li class="w12-8 lineb"> <p> Eixo </p> </li>
					            <li class="w12-8 lineb"> <p> Pris. </p> </li>
					            <li class="w12-8 lineb"> <p> Base </p> </li>
					            <li class="w12-8 lineb"> <p> DNP  </p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaEsquerdoLonge">
					            <li class="w10"> <p class="txt-al"> Longe </p> </li>
					            <li class="w12-8"> <p>.</p> </li>
					            <li class="w12-8"> <p>[OELEsf]</p> </li>
					            <li class="w12-8"> <p>[OELCil]</p> </li>
					            <li class="w12-8"> <p>[OELEix]</p> </li>
					            <li class="w12-8"> <p>[OELPri]</p> </li>
					            <li class="w12-8"> <p>[OELBas]</p> </li>
					            <li class="w12-8"> <p>[OELDNP]</p> </li>
					        </ul>

					    	<ul class="list-col txt-ac linhaEsquerdoMedio">
					        	<li class="w10"> <p class="txt-al"> Medio </p> </li>
					            <li class="w12-8"> <p>[OEMAdi]</p> </li>
					            <li class="w12-8"> <p>[OEMEsf]</p> </li>
					            <li class="w12-8"> <p>[OEMCil]</p> </li>
					            <li class="w12-8"> <p>[OEMEix]</p> </li>
					            <li class="w12-8"> <p>[OEMPri]</p> </li>
					            <li class="w12-8"> <p>[OEMBas]</p> </li>
					            <li class="w12-8"> <p>[OEMDNP]</p> </li>
					        </ul>

					        <ul class="list-col txt-ac linhaEsquerdoPerto">
					        	<li class="w10"> <p class="txt-al"> Perto </p> </li>
					            <li class="w12-8"> <p>[OEPAdi]</p> </li>
					            <li class="w12-8"> <p>[OEPEsf]</p> </li>
					            <li class="w12-8"> <p>[OEPCil]</p> </li>
					            <li class="w12-8"> <p>[OEPEix]</p> </li>
					            <li class="w12-8"> <p>[OEPPri]</p> </li>
					            <li class="w12-8"> <p>[OEPBas]</p> </li>
					            <li class="w12-8"> <p>[OEPDNP]</p> </li>
					        </ul>
					    </div>

				        <div class="col w11 txt-ac linel lineb liner">
				        	<p class="lineb"> Alt. Mont. </p>
				        	<p> [AltMontagemLOE] </p>
				        </div>
					</div><!--.end olho esquerdo-->

					<!--Tipo Oculos-->
					<p class="TipoLente row w100 b mt03"></p>
					<p class="row w100 b mt03">[TipoOculos]</p>

					<!--observacao-->
					<div class="row w99-4 linel lineb liner mt1">
						<p>Obs.: <span>[ObservacaoPrescricao]</span></p>
					</div>

					<!--produtos-->
					<div class="row w100 mt15">
						<!--descicao coluna produtos-->
						<ul class="list-col lineb">
							<li class="w60"> <p> Descrição </p> </li>
							<li class="w30"> <p> Marca </p> </li>
							<li class="w10 txt-ac"> <p> Qtd </p> </li>
							<!--<li class="w16 txt-ac"> <p> Preço (R$) </p> </li>-->
						</ul>

						<!--armação-->
						<ul class="list-col LinhaArmacao" style="margin-top: 3px;">
							<li class="w60"> <p class="w100 txt-hidden DescArmacao"> [DescArmacao] </p> </li>
							<li class="w30"> <p class="w100 txt-hidden MarcaArmacao"> [MarcaArmacao] </p> </li>
							<li class="w10 txt-ac"> <p class="w100 txt-hidden QtdArmacao"> [QtdArmacao] </p> </li>
							<!--<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorArmacao"> [ValorArmacao] </p> </li>-->
						</ul>

						<!--lente OD-->
						<ul class="list-col LinhaLOD" style="margin-top: 3px;">
							<li class="w60"> <p class="w100 txt-hidden DescLOD"> [DescLOD] </p> </li>
							<li class="w30"> <p class="w100 txt-hidden MarcaLOD"> [MarcaLOD] </p> </li>
							<li class="w10 txt-ac"> <p class="w100 txt-hidden QtdLOD"> [QtdLOD] </p> </li>
							<!--<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOD"> [ValorLOD] </p> </li>-->
						</ul>

						<!--tratamento OD-->
						<ul class="list-col LinhaTLOD" style="margin-top: 3px;">
							<div class="w95 float-r TLOD_LAB"></div>
						</ul>

						<!--lente OE-->
						<ul class="list-col LinhaLOE" style="margin-top: 3px;">
							<li class="w60"> <p class="w100 txt-hidden DescLOE"> [DescLOE] </p> </li>
							<li class="w30"> <p class="w100 txt-hidden MarcaLOE"> [MarcaLOE] </p> </li>
							<li class="w10 txt-ac"> <p class="w100 txt-hidden QtdLOE"> [QtdLOE] </p> </li>
							<!--<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOE"> [ValorLOE] </p> </li>-->
						</ul>

						<!--tratamento OE-->
						<ul class="list-col LinhaTLOE" style="margin-top: 3px;">
							<div class="w95 float-r TLOE_LAB"></div>
						</ul>

						<!--totalizador produtos-->
						<ul class="list-col linet" style="margin-top: 3px;">
							<li class="w90"> <p class="b"> Total: </p> </li>
							<li class="w10 txt-ac"> <p class="w100 txt-hidden b"> [envelopeQtd] </p> </li>
							<!--<li class="w10 txt-ac"> <p class="w100 txt-hidden b"> [envelopeTotal] </p> </li>-->
						</ul>
					</div><!--.end produtos-->			
				</div><!--.end via laboratório-->


				<!--via cliente-->
				<div class="row w100 pt09 linet-dashed">

	                <!--dados loja-->
					<div class="col w22 logo pr03 pb03">
						<img class="img-responsive" src="optsoul-exemplo.png"/>
					</div>

					<div class="col w54">
						<p class="lineb"> [NomeEmpresa] </p>
						<p> [EnderecoEmpresa] </p>
						<p> [TelefoneEmpresa] </p>
						<p> [EmailEmpresa] </p>
						<p> [SiteEmpresa] </p>
						<p> Vendedor: <span>[Vendedor]</span> </p>
					</div>

					<div class="col w23 txt-ac">
						<p class="lineb w100">Via Cliente</p>
						<p> Impresso: <span> [ImpressoEm] </span> </p>
						<h4 class="CodBarras[###CodigoEnvelope###]"></h4>
						<p class="CodEnvelope[###CodigoEnvelope###]"></p>
					</div>

	                <!--dados cliente-->
					<div class="col w78 mt05 linet">
						<p> <span> [CodigoCliente] </span> <span> [NomeCliente] </span> </p>
						<p> [EnderecoCliente] </p>
						<p> [TelefoneCliente] </p>
					</div>

					<div class="col w22 mt05 linet">
						<p>Venda: <span> [DataEmissaoVenda] </span> </p>
						<p>Previsão: <span> [DataPrevEntrega] </span> </p>
					</div>

					<!--produtos-->
					<div class="row w100 mt1">
						<!--descicao coluna produtos-->
						<ul class="list-col lineb">
							<li class="w57"> <p> Descrição </p> </li>
							<li class="w20"> <p> Marca </p> </li>
							<li class="w07 txt-ac"> <p> Qtd </p> </li>
							<li class="w16 txt-ac"> <p> Preço (R$) </p> </li>
						</ul>

						<!--armação-->
						<ul class="list-col LinhaArmacao" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescArmacao"> [DescArmacao] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaArmacao"> [MarcaArmacao] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdArmacao"> [QtdArmacao] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorArmacao"> [ValorArmacao] </p> </li>
						</ul>

						<!--lente OD-->
						<ul class="list-col LinhaLOD" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescLOD"> [DescLOD] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaLOD"> [MarcaLOD] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdLOD"> [QtdLOD] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOD"> [ValorLOD] </p> </li>
						</ul>

						<!--tratamento OD-->
						<ul class="list-col LinhaTLOD" style="margin-top: 3px;">
							<div class="w95 float-r TLOD"></div>
						</ul>

						<!--lente OE-->
						<ul class="list-col LinhaLOE" style="margin-top: 3px;">
							<li class="w57"> <p class="w100 txt-hidden DescLOE"> [DescLOE] </p> </li>
							<li class="w20"> <p class="w100 txt-hidden MarcaLOE"> [MarcaLOE] </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdLOE"> [QtdLOE] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorLOE"> [ValorLOE] </p> </li>
						</ul>

						<!--tratamento OE-->
						<ul class="list-col LinhaTLOE" style="margin-top: 3px;">
							<div class="w95 float-r TLOE"></div>
						</ul>

						<!--totalizador produtos-->
						<ul class="list-col linet" style="margin-top: 3px;">
							<li class="w77"> <p class="w100 txt-hidden b"> Total: </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden b"> [envelopeQtd] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden b"> [envelopeTotal] </p> </li>
						</ul>
					</div><!--.end produtos-->
				</div><!--.end via cliente-->
			</div>
		</script>


		<!--Itens Avulsos-->
		<script id="TempItensAvulsos" type="TempItensAvulsos">
			<div class="envelope-spece" style="page-break-inside: avoid !important;">
				<!--via cliente-->
				<div class="row w100 pt09">

	                <!--dados loja-->
					<div class="col w22 logo pr03 pb03">
						<img class="img-responsive" src="optsoul-exemplo.png"/>
					</div>

					<div class="col w54">
						<p class="lineb"> [NomeEmpresa] </p>
						<p> [EnderecoEmpresa] </p>
						<p> [TelefoneEmpresa] </p>
						<p> [EmailEmpresa] </p>
						<p> [SiteEmpresa] </p>
						<p> Vendedor: <span>[Vendedor]</span> </p>
					</div>

					<div class="col w23 txt-ac">
						<p class="lineb w100">Via Cliente</p>
						<p> Impresso: <span> [ImpressoEm] </span> </p>
						<h4 class="CodBarras[###CodigoVenda###]"></h4>
						<p class="CodVenda[###CodigoVenda###]"></p>
					</div>

	                <!--dados cliente-->
					<div class="col w78 mt05 linet">
						<p> <span> [CodigoCliente] </span> <span> [NomeCliente] </span> </p>
						<p> [EnderecoCliente] </p>
						<p> [TelefoneCliente] </p>
					</div>

					<div class="col w22 mt05 linet">
						<p>Venda: <span> [DataEmissaoVenda] </span> </p>
					</div>

					<!--produtos-->
					<div class="row w100 mt1">
						<!--descicao coluna produtos-->
						<ul class="list-col lineb">
							<li class="w57"> <p> Descrição </p> </li>
							<li class="w20"> <p> Marca </p> </li>
							<li class="w07 txt-ac"> <p> Qtd </p> </li>
							<li class="w16 txt-ac"> <p> Preço (R$) </p> </li>
						</ul>

						<!--Itens-->
						<ul class="list-col LinhaArmacao" style="margin-top: 3px;">
							<div class="LinhaItemAvulso"></div>
						</ul>

						<!--Totalizador-->
						<ul class="list-col linet" style="margin-top: 3px;">
							<li class="w77"> <p class="w100 txt-hidden b"> Total: </p> </li>
							<li class="w07 txt-ac"> <p class="w100 txt-hidden b"><span class="opacity">.</span> [QtdTotalItens] </p> </li>
							<li class="w16 txt-ar"> <p class="w100 txt-hidden b"><span class="opacity">.</span> [ValorTotalItens] </p> </li>
						</ul>
					</div><!--.end produtos-->
				</div><!--.end via cliente-->
			</div>
		</script>

		<!--Linhas Itens Avulsos-->
		<script id="tempLinhasItensAvulsos" type="tempLinhasItensAvulsos">
			<li class="w57"> <p class="w100 txt-hidden DescArmacao"><span class="opacity">.</span> [DescItem] </p> </li>
			<li class="w20"> <p class="w100 txt-hidden MarcaArmacao"><span class="opacity">.</span> [MarcaItem] </p> </li>
			<li class="w07 txt-ac"> <p class="w100 txt-hidden QtdArmacao"><span class="opacity">.</span> [QtdItem] </p> </li>
			<li class="w16 txt-ar"> <p class="w100 txt-hidden ValorArmacao"><span class="opacity">.</span> [ValorItem] </p> </li>
		</script>
	</head>

	<body>
		<div class="container">
			<!--Print Content Envelopes-->
			<div class="PrintTemplate"></div>

			<!--Print Content Itens Avulsos-->
			<div class="PrintTemplateAvs"></div>
		</div>

		<script>
			$(document).ready(function(){

				//Connect DB
				var banco = getParameterByName("BancoDeDados");
				var url = decodeURIComponent(getParameterByName("URLServidor"));
				var usuario = getParameterByName("CodigoUsuario");

				//Get URL
				var CodigoVenda = getParameterByName("CodigoVenda");

				//Count Envelope
				var dadosEnvelopes = GeeksSQL(
					" SELECT"
						+" IsNull(Denv.CodigoDocumento, '') CodigoEnvelope"
						+" ,IsNull(Denv.CodigoDocumentoAdicional, '') CodigoDocumentoAdicional"
						+" ,IsNull(Convert(varchar(10), Denv.DataHoraPrevisto, 103), '') Previsto"
						+" ,IsNull(Convert(varchar(10), Denv.DataHoraPrevisto, 103)+' '+Convert(varchar(10), Denv.DataHoraPrevisto, 108), '') DataHoraPrevisto"
						+" ,IsNull(Denv.Observacao, '') Observacao"
						+" ,IsNull(Dv.CodigoDocumento, '') CodigoVenda"
						+" ,Convert(Varchar, Dv.Numero)+'-'+Convert(Varchar, Denv.Numero) NumeroEnvelope"
						+" ,IsNull(Dv.CodigoContato, '') CodigoContato"
						+" ,IsNull(Dv.CodigoEmpresa, '') CodigoEmpresa"
					+" FROM Documento Denv"
						+" LEFT JOIN Documento Dv ON(Dv.CodigoDocumento = Denv.DocumentoCodigo)"
					+" WHERE"
						+" Denv.Tipo = 'Envelope'"
						+" AND Dv.Tipo = 'Venda'"
						+" AND Dv.CodigoDocumento = "+CodigoVenda
				, false, url, banco, usuario);

				$(dadosEnvelopes.Records).each(function(index, rowEnv) {

					//Get Template
					var Envelope = $("#TempEnvelope").html();

					//Temp (Dados Envelope)
					Envelope = Envelope
						.replaceAll("[DataPrevEntrega]", rowEnv.DataHoraPrevisto)
						.replaceAll("[ObservacaoPrescricao]", rowEnv.Observacao)
						.replaceAll("[###CodigoEnvelope###]", rowEnv.CodigoEnvelope)
					;


					//Dados da Loja
					var dadosEmissor = GeeksSQL(
						" SELECT"
							+" TOP 1 IsNull(Ce.CodigoContatoEndereco, '') as Ordem"
							+" ,IsNull(C.Nome, '') as RazaoSocialEmpresa"
							+" ,IsNull(C.Apelido, '') as NomeEmpresa"
							+" ,IsNull(C.[Site], '') as SiteEmpresa"
							+" ,IsNull(C.Email, '') as EmailEmpresa"
							+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')+ IsNull('  '+Ce.Municipio, '')+ IsNull('/'+Ce.UF, '')+ IsNull(' - '+Ce.Cep, '')) as EnderecoEmpresa"
							+" ,IsNull(STUFF(("
								+" SELECT ',  '+Ct.Telefone"
								+" FROM ContatoTelefone Ct"
								+" WHERE"
									+" Ct.CodigoContato = C.CodigoContato"
							+" FOR XML PATH('')), 1, 2, ''), '') AS TelefoneEmpresa"
							+" ,IsNull(C.Imagem, 'Não informado') as Imagem"
						+" FROM Contato C"
							+" LEFT JOIN ContatoEndereco CE ON(CE.CodigoContato = C.CodigoContato)"
						+" WHERE C.CodigoContato ="+rowEnv.CodigoEmpresa
						+" ORDER BY 1 Desc"
					, false, url, banco, usuario);

					//Temp (Dados Empresa)
					Envelope = Envelope
						.replaceAll("[NomeEmpresa]", dadosEmissor.Records[0].NomeEmpresa)
						.replaceAll("[EnderecoEmpresa]", dadosEmissor.Records[0].EnderecoEmpresa)
						.replaceAll("[TelefoneEmpresa]", dadosEmissor.Records[0].TelefoneEmpresa)
						.replaceAll("[EmailEmpresa]", dadosEmissor.Records[0].EmailEmpresa)
						.replaceAll("[SiteEmpresa]", dadosEmissor.Records[0].SiteEmpresa)
					;


					//Dados do Cliente
					var dadosCliente = GeeksSQL(
						" SELECT"
							+" TOP 1 IsNull(Ce.CodigoContatoEndereco, '') as Ordem"
							+" ,IsNull(C.CodigoContato, '') as CodigoCliente"
							+" ,IsNull(C.Nome, '') as NomeCliente"
							+" ,IsNull(C.NumeroDocumentoNacional, '') as CPFCliente"
							+" ,IsNull(C.NumeroDocumentoEstadual, '') as RGCliente"
							+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')+ IsNull('  '+Ce.Municipio, '')+ IsNull('/'+Ce.UF, '')+ IsNull(' - '+Ce.Cep, '')) as EnderecoCliente"
							+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')) as LogradouroCliente"
							+" ,IsNull(Ce.Municipio, '') as CidadeCliente"
							+" ,IsNull(Ce.UF, '') as UFCliente"
							+" ,STUFF(("
								+" SELECT ',  '+ Ct.Telefone"
								+" FROM ContatoTelefone Ct"
								+" WHERE"
									+" Ct.CodigoContato = C.CodigoContato"
							+" FOR XML PATH('')), 1, 2, '') AS TelefoneCliente"
						+" FROM Contato C"
							+" LEFT JOIN ContatoEndereco Ce ON(Ce.CodigoContato = C.CodigoContato)"
						+" WHERE C.CodigoContato ="+rowEnv.CodigoContato
						+" ORDER BY 1 Desc"
					, false, url, banco, usuario);

					//Temp (Dados Cliente)
					Envelope = Envelope
						.replaceAll("[CodigoCliente]", dadosCliente.Records[0].CodigoCliente)
						.replaceAll("[NomeCliente]", dadosCliente.Records[0].NomeCliente)
						.replaceAll("[CPFCliente]", dadosCliente.Records[0].CPFCliente)
						.replaceAll("[RGCliente]", dadosCliente.Records[0].RGCliente)
						.replaceAll("[EnderecoCliente]", dadosCliente.Records[0].EnderecoCliente)
						.replaceAll("[LogradouroCliente]", dadosCliente.Records[0].LogradouroCliente)
						.replaceAll("[CidadeCliente]", dadosCliente.Records[0].CidadeCliente)
						.replaceAll("[UFCliente]", dadosCliente.Records[0].UFCliente)
						.replaceAll("[TelefoneCliente]", dadosCliente.Records[0].TelefoneCliente)
					;


					//Dados do Paciente
					var dadosPacienteMedico = GeeksSQL(
						" SELECT"
						    +" Distinct Dp.DescricaoContato Paciente,"
						    +" IsNull((Select Nome from Contato where CodigoContato = DC.CodigoContato),'Não informado') Medico"
						+" FROM Documento Dp"
						    +" LEFT JOIN DocumentoContato DC ON((Dp.CodigoDocumento = Dc.CodigoDocumento) AND (Dc.Descricao = 'Medico'))"
						+" WHERE"
						    +" Dp.Tipo = 'Prescrição'"
						    +" AND Dp.CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento ="+rowEnv.CodigoDocumentoAdicional+")"
					, false, url, banco, usuario);

					//Temp (Daods Paciente e Médico)
					if (dadosPacienteMedico.Records != 0) {
						Envelope = Envelope
							.replaceAll("[NomePaciente]", dadosPacienteMedico.Records[0].Paciente)
							.replaceAll("[NomeMedico]", dadosPacienteMedico.Records[0].Medico)
						;
					}


					//Dados da Venda (Documento Tipo=Venda)
					var dadosVenda = GeeksSQL(
						" SELECT"
						    +" IsNull(Convert(varchar(10), D.DataHoraEmissao, 103), '') as Emissao,"
						    +" IsNull(Convert(varchar(10), D.DataHoraEmissao, 103) + ' ' + Convert(varchar(10), D.DataHoraEmissao, 108), '') as DataHoraEmissao,"
						    +" IsNull(Convert(varchar(10), D.DataHoraFinalizado, 103), '') as Finalizado,"
						    +" IsNull(Convert(varchar(10), D.DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), D.DataHoraFinalizado, 108), '') as DataHoraFinalizado,"
						    +" IsNull(Convert(varchar(10), current_timestamp, 103), '') as ImpressoEm,"
						    +" IsNull(Convert(varchar(10), current_timestamp, 103) + ' ' + Convert(varchar(10), current_timestamp, 108), '') as DataHoraImpressoEm,"
						    +" IsNull(D.Numero, '') as NumeroVenda,"
						    +" IsNull(D.TotalDocumento, '') as TotalDocumento,"
						    +" IsNull(D.TotalDesconto, '') as TotalDesconto,"
						    +" IsNull(D.Observacao, '') as ObsVenda,"
						    +" IsNull(C.Nome, '') as Vendedor"
						+" FROM Documento D"
						    +" LEFT JOIN Contato C ON(D.CodigoContatoVendedor = C.CodigoContato)"
						+" WHERE"
							+" D.Tipo = 'Venda'"
							+" AND D.CodigoDocumento ="+rowEnv.CodigoVenda
					, false, url, banco, usuario);

					//Temp (Dados Venda)
					Envelope = Envelope
						.replaceAll("[ImpressoEm]", dadosVenda.Records[0].DataHoraImpressoEm)
						.replaceAll("[DataEmissaoVenda]", dadosVenda.Records[0].Emissao)
						.replaceAll("[Vendedor]", dadosVenda.Records[0].Vendedor)
					;


					//Documento 'Item Venda'
					var itemVenda = GeeksSQL(
						" SELECT"
							+" IsNull(Convert(varchar(10), DataHoraEmissao, 103) + '' + Convert(varchar(10), DataHoraEmissao, 108), '') Emissao"
							+" ,IsNull(Convert(varchar(10), DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), DataHoraFinalizado, 108), '') Finalizado"
							+" ,IsNull(Convert(varchar(10), current_timestamp, 103) + ' ' + Convert(varchar(10), current_timestamp, 108), '') Agora"
							+" ,*"
						+" FROM Documento"
						+" WHERE"
							+" Tipo = 'Item Venda'"
							+" AND CodigoDocumento ="+rowEnv.CodigoDocumentoAdicional
					, false, url, banco, usuario);


					//DocumentoItem 'Itens'
					var itens = GeeksSQL(
						" SELECT"
							+" IsNull(TipoItem, '') TipoItem"
							+" ,IsNull(CodigoItem, '') CodigoItem"
							+" ,IsNull(DescricaoItem, '') DescricaoItem"
							+" ,IsNull(Marca, '') Marca"
							+" ,IsNull(ArmacaoMaterial, '') ArmacaoMaterial"
							+" ,IsNull(Material, '') Material"
							+" ,IsNull(AmarcaoCor, '') AmarcaoCor"
							+" ,IsNull(Cor, '') Cor"
							+" ,IsNull(Quantidade, 0) Quantidade"
							+" ,IsNull(ValorItem, 0) ValorItem"
							+" ,IsNull(DescontoItem, 0) DescontoItem"
							+" ,IsNull(Total, 0) Total"
							+" ,IsNull(Tamanho, 0) Tamanho"
							+" ,IsNull(Ponte, 0) Ponte"
							+" ,IsNull(Diagonal, 0) Diagonal"
							+" ,IsNull(Altura, 0) Altura"
							+" ,IsNull(Esferico, 0) Esferico"
							+" ,IsNull(Cilindrico, 0) Cilindrico"
							+" ,IsNull(Eixo, 0) Eixo"
							+" ,IsNull(Adicao, 0) Adicao"
							+" ,*"
						+" FROM DocumentoItem"
						+" WHERE CodigoDocumento ="+rowEnv.CodigoDocumentoAdicional
					, false, url, banco, usuario);

					//Variaveis
						//Lente
						var lodAlterada;
						var loeAlterada;
						var lodCodigo;
						var loeCodigo;
						var mesmaLente = false;
						var valorLentes = 0;
							
						//Tratamento
						var codigoTLOD = 0;
						var codigoTLOE = 0;
						var valorTLOD = 0;
						var valorTLOE = 0;

						//Totalizador Envelope
						var envelopeQtd = 0;
						var envelopeTotal = 0;

						//Prescricao
						var lodEsferico;
						var loeEsferico;
						var lodCilindrico;
						var loeCilindrico;
						var lodEixo;
						var loeEixo;
						var lodAdicao;
						var loeAdicao;


					$(itens.Records).each(function(index, rowItens){

						if (rowItens.TipoItem == "Armação") {
							envelopeTotal += rowItens.Total;

							Envelope = Envelope
								.replaceAll("[DescArmacao]", (rowItens.DescricaoItem == "" ? "Armação Própria" : rowItens.DescricaoItem))
								.replaceAll("[MarcaArmacao]", (rowItens.Marca && rowItens.Marca != null && rowItens.Marca != "null" ? rowItens.Marca : "&nbsp;"))
								.replaceAll("[QtdArmacao]", (rowItens.Quantidade != null && rowItens.Quantidade != "null" && rowItens.Quantidade != 0 ? rowItens.Quantidade : 0))
								.replaceAll("[ValorArmacao]", (rowItens.Total != null && rowItens.Total != "null" ? (rowItens.Total.toFixed(2).replace('.', ',')) : "&nbsp;"))
							;
						}

						else if (rowItens.TipoItem == "LOD") {
							//Verifica se a presc foi alterada
							if (rowItens.PrescricaoAlterada == 1) {
								lodAlterada = true;
								lodEsferico = (rowItens.Esferico != null && rowItens.Esferico != "null" && rowItens.Esferico != 0 ? rowItens.Esferico : 0);
								lodCilindrico = (rowItens.Cilindrico != null && rowItens.Cilindrico != "null" && rowItens.Cilindrico != 0 ? rowItens.Cilindrico : 0);
								lodEixo = (rowItens.Eixo != null && rowItens.Eixo != "null" && rowItens.Eixo != 0 ? rowItens.Eixo : 0);
								lodAdicao = (rowItens.Adicao != null && rowItens.Adicao != "null" && rowItens.Adicao != 0 ? rowItens.Adicao : 0);
							}
							else {
								lodAlterada = false;
							}

							//Verifica se as lentes são iguais
							lodCodigo = rowItens.CodigoItem;
							valorLentes += (rowItens.Total != null && rowItens.Total != "null" && rowItens.Total != 0 ? rowItens.Total : 0);
							envelopeTotal += (rowItens.Total != null && rowItens.Total != "null" && rowItens.Total != 0 ? rowItens.Total : 0);

							if (loeCodigo && rowItens.CodigoItem == loeCodigo) {
								mesmaLente = true;
							}

							Envelope = Envelope
								.replaceAll("[DescLOD]", (rowItens.DescricaoItem == "" ? "Lente Própria" : rowItens.DescricaoItem))
								.replaceAll("[MarcaLOD]", (rowItens.Marca && rowItens.Marca != null && rowItens.Marca != "null" ? rowItens.Marca : "&nbsp;"))
								.replaceAll("[QtdLOD]", (rowItens.Quantidade != null && rowItens.Quantidade != "null" && rowItens.Quantidade != 0 ? rowItens.Quantidade : 0))
								.replaceAll("[ValorLOD]", rowItens.Total.toFixed(2).replace('.', ','))
							;
						}

						else if (rowItens.TipoItem == "LOE") {
							//Verifica se a presc foi alterada
							if (rowItens.PrescricaoAlterada == 1) {
								loeAlterada = true;
								loeEsferico = (rowItens.Esferico != null && rowItens.Esferico != "null" && rowItens.Esferico != 0 ? rowItens.Esferico : 0);
								loeCilindrico = (rowItens.Cilindrico != null && rowItens.Cilindrico != "null" && rowItens.Cilindrico != 0 ? rowItens.Cilindrico : 0);
								loeEixo = (rowItens.Eixo != null && rowItens.Eixo != "null" && rowItens.Eixo != 0 ? rowItens.Eixo : 0);
								loeAdicao = (rowItens.Adicao != null && rowItens.Adicao != "null" && rowItens.Adicao != 0 ? rowItens.Adicao : 0);
							}
							else {
								loeAlterada = false;
							}

							//Verifica se as lentes são iguais
							loeCodigo = rowItens.CodigoItem;
							valorLentes += (rowItens.Total != null && rowItens.Total != "null" && rowItens.Total != 0 ? rowItens.Total : 0);
							envelopeTotal += (rowItens.Total != null && rowItens.Total != "null" && rowItens.Total != 0 ? rowItens.Total : 0);

							if (lodCodigo && rowItens.CodigoItem == lodCodigo) {
								mesmaLente = true;
							}

							Envelope = Envelope
								.replaceAll("[DescLOE]", (rowItens.DescricaoItem == "" ? "Lente Própria" : rowItens.DescricaoItem))
								.replaceAll("[MarcaLOE]", (rowItens.Marca && rowItens.Marca != null && rowItens.Marca != "null" ? rowItens.Marca : "&nbsp;"))
								.replaceAll("[QtdLOE]", (rowItens.Quantidade != null && rowItens.Quantidade != "null" && rowItens.Quantidade != 0 ? rowItens.Quantidade : 0))
								.replaceAll("[ValorLOE]", rowItens.Total.toFixed(2).replace('.', ','))
							;
						}

						else if (rowItens.TipoItem == "TLOD") {
							//Preenche Variaveis
							codigoTLOD += rowItens.CodigoItem;
							valorTLOD += ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0));
							envelopeTotal += ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0));

							//Tratamento para Via Loja e Cliente
							var tratamento = $("#TempTratamento").html();
							tratamento = tratamento
								.replace("[DescricaoTratamento]", (rowItens.DescricaoItem != null && rowItens.DescricaoItem != "null" ? rowItens.DescricaoItem : "&nbsp;"))
								.replace("[QtdTratamento]", "1")
								.replace("[ValorTratamento]", ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0)).toFixed(2).replace('.', ','))
							;

							Envelope = $("<div></div>").append(Envelope);
							Envelope.find(".TLOD").each(function() {
								$( this ).append(tratamento);
							});
							Envelope = Envelope.html();

							tratamento = '';

							//Tratamento Para Via Laboratóiro
							var tratamentoLAB = $("#TempTratamentoLAB").html();
							tratamentoLAB = tratamentoLAB
								.replace("[DescricaoTratamento]", (rowItens.DescricaoItem != null && rowItens.DescricaoItem != "null" ? rowItens.DescricaoItem : "&nbsp;"))
								.replace("[QtdTratamento]", "1")
							;

							Envelope = $("<div></div>").append(Envelope);
							Envelope.find(".TLOD_LAB").each(function() {
								$( this ).append(tratamentoLAB);
							});
							Envelope = Envelope.html();

							tratamentoLAB = '';
						}

						else if (rowItens.TipoItem == "TLOE") {
							//Preenche Variaveis
							codigoTLOE += rowItens.CodigoItem;
							valorTLOE += ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0));
							envelopeTotal += ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0));

							//Tratamento para Via Loja e Cliente
							var tratamento = $("#TempTratamento").html();
							tratamento = tratamento
								.replace("[DescricaoTratamento]", (rowItens.DescricaoItem != null && rowItens.DescricaoItem != "null" ? rowItens.DescricaoItem : "&nbsp;"))
								.replace("[QtdTratamento]", "1")
								.replace("[ValorTratamento]", ((rowItens.ValorItem != null && rowItens.ValorItem != "null" && rowItens.ValorItem != 0 ? rowItens.ValorItem : 0) - (rowItens.DescontoItem != null && rowItens.DescontoItem != "null" && rowItens.DescontoItem != 0 ? rowItens.DescontoItem : 0)).toFixed(2).replace('.', ','))
							;

							Envelope = $("<div></div>").append(Envelope);
							Envelope.find(".TLOE").each(function() {
								$( this ).append(tratamento);
							});
							Envelope = Envelope.html();

							tratamento = '';

							//Tratamento Para Via Laboratório
							var tratamentoLAB = $("#TempTratamentoLAB").html();
							tratamentoLAB = tratamentoLAB
								.replace("[DescricaoTratamento]", (rowItens.DescricaoItem != null && rowItens.DescricaoItem != "null" ? rowItens.DescricaoItem : "&nbsp;"))
								.replace("[QtdTratamento]", "1")
							;

							Envelope = $("<div></div>").append(Envelope);
							Envelope.find(".TLOE_LAB").each(function() {
								$( this ).append(tratamentoLAB);
							});
							Envelope = Envelope.html();

							tratamentoLAB = '';
						}

						//Totalizadores do Envelope
						envelopeQtd += (rowItens.Quantidade != null && rowItens.Quantidade != "null" && rowItens.Quantidade != 0 ? rowItens.Quantidade : 0);

					});//Row Itens

					//Totalizador Envelope
					Envelope = Envelope
						.replaceAll("[envelopeQtd]", envelopeQtd)
						.replaceAll("[envelopeTotal]", envelopeTotal.toFixed(2).replace('.',','))
					;


					//Mesma Lente
					if (mesmaLente && codigoTLOD == codigoTLOE && valorTLOD == valorTLOE) {
						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".LinhaLOE").each(function() {
							$( this ).css("display", "none");
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".TLOE").each(function() {
							$( this ).css("display", "none");
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".TLOE_LAB").each(function() {
							$( this ).css("display", "none");
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".QtdLOD").each(function() {
							$( this ).html("2");
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".ValorLOD").each(function() {
							$( this ).html(valorLentes.toFixed(2).replace('.', ','));
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".QtdTratamento").each(function() {
							$( this ).html("2");
						});

						Envelope = $("<div></div>").append(Envelope);
						Envelope.find(".ValorTratamento").each(function() {
							$( this ).html((Number($( this ).html().replace(',', '.'))*2).toFixed(2).replace('.', ','));
						});
						Envelope = Envelope.html();
					}


					//Prescrição
					var OdLonge = GeeksSQL("Select IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base, IsNull(DIOD, 0) DIOD, IsNull(DIOE, 0) DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Longe'", false, url, banco, usuario).Records[0];

					var OdMedio = GeeksSQL("Select IsNull(Adicao, 0) Adicao, IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base, IsNull(DIOD, 0) DIOD, IsNull(DIOE, 0) DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Medio'", false, url, banco, usuario).Records[0];

					var OdPerto = GeeksSQL("Select IsNull(Adicao, 0) Adicao, IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base, IsNull(DIOD, 0) DIOD, IsNull(DIOE, 0) DIOE from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Direito' and [Status] = 'Perto'", false, url, banco, usuario).Records[0];

					var OeLonge = GeeksSQL("Select IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Longe'", false, url, banco, usuario).Records[0];

					var OeMedio = GeeksSQL("Select IsNull(Adicao, 0) Adicao, IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Medio'", false, url, banco, usuario).Records[0];

					var OePerto = GeeksSQL("Select IsNull(Adicao, 0) Adicao, IsNull(Esferico, 0) Esferico, IsNull(Cilindrico, 0) Cilindrico, IsNull(Eixo, 0) Eixo, IsNull(Prisma, 0) Prisma, IsNull(Base, '') Base from DocumentoItem where CodigoDocumento = (Select Top 1 CodigoDocumentoAdicional from DocumentoItem where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ ") and TipoItem = 'Prescrição' and Operacao = 'Olho Esquerdo' and [Status] = 'Perto'", false, url, banco, usuario).Records[0];

					//Longe
					if (OeLonge != undefined) {
						Envelope = Envelope
							.replaceAll("[OELEsf]",(loeAlterada ? loeEsferico : Number((OeLonge.Esferico != null && OeLonge.Esferico != "null" ? OeLonge.Esferico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[OELCil]",(loeAlterada ? loeCilindrico : Number((OeLonge.Cilindrico != null && OeLonge.Cilindrico != "null" ? OeLonge.Cilindrico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[OELEix]",(loeAlterada ? loeEixo : (OeLonge.Eixo != null && OeLonge.Eixo != "null" ? OeLonge.Eixo : 0)))
							.replaceAll("[OELPri]",(OeLonge.Prisma != null && OeLonge.Prisma != "null" ? OeLonge.Prisma : 0))
							.replaceAll("[OELBas]",(OeLonge.Base != null && OeLonge.Base != "null" ? OeLonge.Base : ''))
							.replaceAll("[OELDNP]",Number((OdLonge.DIOE != null && OdLonge.DIOE != "null" ? OdLonge.DIOE : 0)).toFixed(2).replace(".", ","))
						;
					}

					if (OdLonge != undefined) {
						Envelope = Envelope
							.replaceAll("[ODLEsf]",(lodAlterada ? lodEsferico : Number((OdLonge.Esferico != null && OdLonge.Esferico != "null" ? OdLonge.Esferico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[ODLCil]",(lodAlterada ? lodCilindrico : Number((OdLonge.Cilindrico != null && OdLonge.Cilindrico != "null" ? OdLonge.Cilindrico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[ODLEix]",(lodAlterada ? lodEixo : (OdLonge.Eixo != null && OdLonge.Eixo != "null" ? OdLonge.Eixo : 0)))
							.replaceAll("[ODLPri]",(OdLonge.Prisma != null && OdLonge.Prisma != "null" ? OdLonge.Prisma : 0))
							.replaceAll("[ODLBas]",(OdLonge.Base != null && OdLonge.Base != "null" ? OdLonge.Base : ''))
							.replaceAll("[ODLDNP]",Number((OdLonge.DIOD != null && OdLonge.DIOD != "null" ? OdLonge.DIOD : 0)).toFixed(2).replace(".", ","))
						;
					}


					//Médio
					if (OeMedio != undefined) {
						Envelope = Envelope
							.replaceAll("[OEMAdi]",(loeAlterada ? loeAdicao : Number((OeMedio.Adicao != null && OeMedio.Adicao != "null" ? OeMedio.Adicao : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[OEMEsf]",(loeAlterada ? loeAdicao + loeEsferico : Number((OeMedio.Esferico != null && OeMedio.Esferico != "null" ? OeMedio.Esferico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[OEMCil]",Number((OeMedio.Cilindrico != null && OeMedio.Cilindrico != "null" ? OeMedio.Cilindrico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[OEMEix]",(OeMedio.Eixo != null && OeMedio.Eixo != "null" ? OeMedio.Eixo : 0))
							.replaceAll("[OEMPri]",(OeMedio.Prisma != null && OeMedio.Prisma != "null" ? OeMedio.Prisma : 0))
							.replaceAll("[OEMBas]",(OeMedio.Base != null && OeMedio.Base != "null" ? OeMedio.Base : ''))
							.replaceAll("[OEMDNP]",Number((OdMedio.DIOE != null && OdMedio.DIOE != "null" ? OdMedio.DIOE : 0)).toFixed(2).replace(".", ","))
						;
					}

					if (OdMedio != undefined) {
						Envelope = Envelope
							.replaceAll("[ODMAdi]",(lodAlterada ? lodAdicao : Number((OdMedio.Adicao != null && OdMedio.Adicao != "null" ? OdMedio.Adicao : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[ODMEsf]",(lodAlterada ? lodAdicao + lodEsferico : Number((OdMedio.Esferico != null && OdMedio.Esferico != "null" ? OdMedio.Esferico : 0))).toFixed(2).replace(".", ","))
							.replaceAll("[ODMCil]",Number((OdMedio.Cilindrico != null && OdMedio.Cilindrico != "null" ? OdMedio.Cilindrico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[ODMEix]",(OdMedio.Eixo != null && OdMedio.Eixo != "null" ? OdMedio.Eixo : 0))
							.replaceAll("[ODMPri]",(OdMedio.Prisma != null && OdMedio.Prisma != "null" ? OdMedio.Prisma : 0))
							.replaceAll("[ODMBas]",(OdMedio.Base != null && OdMedio.Base != "null" ? OdMedio.Base : ''))
							.replaceAll("[ODMDNP]",Number((OdMedio.DIOD != null && OdMedio.DIOD != "null" ? OdMedio.DIOD : 0)).toFixed(2).replace(".", ","))
						;
					}


					//Perto
					if (OePerto != undefined) {
						Envelope = Envelope
							.replaceAll("[OEPAdi]",Number((OePerto.Adicao != null && OePerto.Adicao != "null" ? OePerto.Adicao : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[OEPEsf]",Number((OePerto.Esferico != null && OePerto.Esferico != "null" ? OePerto.Esferico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[OEPCil]",Number((OePerto.Cilindrico != null && OePerto.Cilindrico != "null" ? OePerto.Cilindrico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[OEPEix]",(OePerto.Eixo != null && OePerto.Eixo != "null" ? OePerto.Eixo : 0))
							.replaceAll("[OEPPri]",(OePerto.Prisma != null && OePerto.Prisma != "null" ? OePerto.Prisma : 0))
							.replaceAll("[OEPBas]",(OePerto.Base != null && OePerto.Base != "null" ? OePerto.Base : ''))
							.replaceAll("[OEPDNP]",Number((OdPerto.DIOE != null && OdPerto.DIOE != "null" ? OdPerto.DIOE : 0)).toFixed(2).replace(".", ","))
						;
					}

					if (OdPerto != undefined) {
						Envelope = Envelope
							.replaceAll("[ODPAdi]",Number((OdPerto.Adicao != null && OdPerto.Adicao != "null" ? OdPerto.Adicao : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[ODPEsf]",Number((OdPerto.Esferico != null && OdPerto.Esferico != "null" ? OdPerto.Esferico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[ODPCil]",Number((OdPerto.Cilindrico != null && OdPerto.Cilindrico != "null" ? OdPerto.Cilindrico : 0)).toFixed(2).replace(".", ","))
							.replaceAll("[ODPEix]",(OdPerto.Eixo != null && OdPerto.Eixo != "null" ? OdPerto.Eixo : 0))
							.replaceAll("[ODPPri]",(OdPerto.Prisma != null && OdPerto.Prisma != "null" ? OdPerto.Prisma : 0))
							.replaceAll("[ODPBas]",(OdPerto.Base != null && OdPerto.Base != "null" ? OdPerto.Base : ''))
							.replaceAll("[ODPDNP]",Number((OdPerto.DIOD != null && OdPerto.DIOD != "null" ? OdPerto.DIOD : 0)).toFixed(2).replace(".", ","))
						;
					}


					if (itemVenda.Records != 0) {
						//ALtura da Montagem
						if (itemVenda.Records[0].Operacao != 'Lente de Contato Surfaçada') {
							
							var AlturaMontagem = GeeksSQL("Select IsNull(AlturaMontagemOD, 0) as AlturaMontagemOD, IsNull(AlturaMontagemOE, 0) as AlturaMontagemOE from DocumentoItem  where CodigoDocumento = " +rowEnv.CodigoDocumentoAdicional+ " and TipoItem='Armação'", false, url, banco, usuario).Records[0];

							Envelope = Envelope
								.replaceAll("[AltMontagemLOD]", AlturaMontagem.AlturaMontagemOD.toFixed(2))
								.replaceAll("[AltMontagemLOE]", AlturaMontagem.AlturaMontagemOE.toFixed(2))
							;
						} else {
							Envelope = Envelope
								.replaceAll("[AltMontagemLOD]", '&nbsp;')
								.replaceAll("[AltMontagemLOE]", '&nbsp;')
								.replaceAll("[DescArmacao]", '')
								.replaceAll("[MarcaArmacao]", '')
								.replaceAll("[QtdArmacao]", '')
								.replaceAll("[ValorArmacao]", '')
								.replaceAll("[TipoOculos]", '')
							;
						}


						//Óculos Receituario ou LDC Surfaçada
						if (itemVenda.Records[0].Operacao == 'Lente de Contato Surfaçada') {
							//Select Tipo LDC
							var tipoOculos = GeeksSQL(
								" SELECT"
									+" IsNull(LenteTipo, '') as Oculos"
								+" FROM DocumentoItem"
								+" WHERE (TipoItem = 'LOD' OR TipoItem = 'LOE') AND CodigoDocumento ="+rowEnv.CodigoDocumentoAdicional
							, false, url, banco, usuario);
						}
						else {
							//Select Tipo Óculos
							var tipoOculos = GeeksSQL(
								" SELECT"
									+" IsNull(TipoOculos, '') TipoOculos"
									+" ,IsNull(Oculos, '') Oculos"
								+" FROM DocumentoItem"
								+" WHERE TipoItem = 'Armação' and CodigoDocumento ="+rowEnv.CodigoDocumentoAdicional
							, false, url, banco, usuario);

							Envelope = Envelope
								.replaceAll("[TipoOculos]", 'Tipo Óculos: '+tipoOculos.Records[0].TipoOculos)
							;
						}


						//Limpa linha presc. por Tipo Óculos ou Tipo LDC
						Envelope = $("<div></div>").append(Envelope);
						switch (tipoOculos.Records[0].Oculos) {
							case "MonofocalLonge":
								Envelope.find(".linhaDireitoPerto").remove();
								Envelope.find(".linhaDireitoMedio").remove();
								Envelope.find(".linhaEsquerdoPerto").remove();
								Envelope.find(".linhaEsquerdoMedio").remove();
								Envelope.find(".TipoLente").html("Tipo Lente: Monofocal (Longe)");  
							break;

							case "MonofocalPerto":
								Envelope.find(".linhaDireitoLonge").remove();
								Envelope.find(".linhaDireitoMedio").remove();
								Envelope.find(".linhaEsquerdoLonge").remove();
								Envelope.find(".linhaEsquerdoMedio").remove();
								Envelope.find(".TipoLente").html("Tipo Lente: Monofocal (Perto)");
							break;

							case "Bifocal":
								Envelope.find(".linhaDireitoMedio").remove();
								Envelope.find(".linhaEsquerdoMedio").remove();
								Envelope.find(".TipoLente").html("Tipo Lente: Bifocal (Longe e Perto)"); 
							break;

							case "Multifocal":
								Envelope.find(".TipoLente").html("Tipo Lente: Multifocal");

								if (
										((OdMedio.Adicao == 0) || (OdMedio.Adicao == null) || (OdMedio.Adicao == "null"))
										&& ((OdMedio.Esferico == 0) || (OdMedio.Esferico == null) || (OdMedio.Esferico == "null"))
										&& ((OdMedio.Cilindrico == 0) || (OdMedio.Cilindrico == null) || (OdMedio.Cilindrico == "null"))
									)
								{
									Envelope.find(".linhaDireitoMedio").remove();
								}

								if (
										((OeMedio.Adicao == 0) || (OeMedio.Adicao == null) || (OeMedio.Adicao == "null"))
										&& ((OeMedio.Esferico == 0) || (OeMedio.Esferico == null) || (OeMedio.Esferico == "null"))
										&& ((OeMedio.Cilindrico == 0) || (OeMedio.Cilindrico == null) || (OeMedio.Cilindrico == "null"))
									)
								{
									Envelope.find(".linhaEsquerdoMedio").remove();
								}
							break;

							case "Intermediario":
								Envelope.find(".linhaDireitoLonge").remove();
								Envelope.find(".linhaEsquerdoLonge").remove();
								Envelope.find(".TipoLente").html("Tipo Lente: Intermediário (Médio e Perto)");
							break;
						}
					}//if


					//Print Template
					if( (OeLonge != undefined) && (OdLonge != undefined) && (OeMedio != undefined) && (OdMedio != undefined) && (OePerto != undefined) && (OdPerto != undefined) && (itemVenda.Records != 0) ) {
						$(".PrintTemplate").append(Envelope);
					}


					//Gera e Insere Código de Barras (Base Cod. Envelope)
					var numero = String(rowEnv.CodigoEnvelope);
					var zeros = 13 - Number(numero.length);

					for (var i = 0; i < zeros; i++)
						numero = '0' + numero;

					$(".CodBarras"+rowEnv.CodigoEnvelope).each(function() {
						$( this ).css("white-space", "nowrap");
						$( this ).css("background-color", "#fff");
						$( this ).html(fbarcode(numero,20));
					});
					$(".CodEnvelope"+rowEnv.CodigoEnvelope).each(function() {
						$( this ).html('Cód.: '+rowEnv.CodigoEnvelope+'  / Nº: '+rowEnv.NumeroEnvelope);
					});

					//Logo do Impresso
					if (dadosEmissor.Records[0].Imagem != "Não informado") {
						$(".logo").each(function() {
							$( this ).html('<img class="img-responsive" src="' + dadosEmissor.Records[0].Imagem.split("#")[0] + '"/>');
						});
					}

				});//Row Envelopes


				//Itens Avulsos e Outros Itens
				if (CodigoVenda != null && CodigoVenda != "null" && CodigoVenda != '') {

					//Dados da Venda Itens Avulsos (Documento Tipo=Venda)
					var dadosVendaAvs = GeeksSQL(
						" SELECT"
							+" IsNull(Convert(varchar(10), Dv.DataHoraEmissao, 103), '') as Emissao,"
							+" IsNull(Convert(varchar(10), Dv.DataHoraEmissao, 103) + ' ' + Convert(varchar(10), Dv.DataHoraEmissao, 108), '') as DataHoraEmissao,"
							+" IsNull(Convert(varchar(10), Dv.DataHoraFinalizado, 103), '') as Finalizado,"
							+" IsNull(Convert(varchar(10), Dv.DataHoraFinalizado, 103) + ' ' + Convert(varchar(10), Dv.DataHoraFinalizado, 108), '') as DataHoraFinalizado,"
							+" IsNull(Convert(varchar(10), current_timestamp, 103), '') as ImpressoEm,"
							+" IsNull(Convert(varchar(10), current_timestamp, 103) + ' ' + Convert(varchar(10), current_timestamp, 108), '') as DataHoraImpressoEm,"
							+" IsNull(Dv.CodigoDOcumento, '') as CodigoVenda,"
							+" IsNull(Dv.Numero, '') as NumeroVenda,"
							+" IsNull(Dv.Observacao, '') as ObservacaoVenda,"
							+" IsNull(C.Nome, '') as Vendedor,"
							+" IsNull(Dv.CodigoContato, '') as CodigoCliente,"
							+" IsNull(Dv.CodigoEmpresa, '') as CodigoEmpresa"
						+" FROM Documento Dv"
							+" LEFT JOIN Contato C ON(Dv.CodigoContatoVendedor = C.CodigoContato)"
						+" WHERE"
							+" Dv.Tipo = 'Venda'"
							+" AND Dv.CodigoDocumento ="+CodigoVenda
					, false, url, banco, usuario);

					$(dadosVendaAvs.Records).each(function(index, rowVenAvs) {

						//Get Template
						var ItensAvulsos = $("#TempItensAvulsos").html();

						//Dados Venda (Itens Avulsos)
						ItensAvulsos = ItensAvulsos
							.replaceAll("[ImpressoEm]", rowVenAvs.DataHoraImpressoEm)
							.replaceAll("[DataEmissaoVenda]", rowVenAvs.Emissao)
							.replaceAll("[Vendedor]", rowVenAvs.Vendedor)
							.replaceAll("[###CodigoVenda###]", rowVenAvs.CodigoVenda)
						;


						//Dados da Loja
						var dadosEmissorAvs = GeeksSQL(
							" SELECT"
								+" TOP 1 IsNull(Ce.CodigoContatoEndereco, '') as Ordem"
								+" ,IsNull(C.Nome, '') as RazaoSocialEmpresa"
								+" ,IsNull(C.Apelido, '') as NomeEmpresa"
								+" ,IsNull(C.[Site], '') as SiteEmpresa"
								+" ,IsNull(C.Email, '') as EmailEmpresa"
								+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')+ IsNull('  '+Ce.Municipio, '')+ IsNull('/'+Ce.UF, '')+ IsNull(' - '+Ce.Cep, '')) as EnderecoEmpresa"
								+" ,IsNull(STUFF(("
									+" SELECT ',  '+Ct.Telefone"
									+" FROM ContatoTelefone Ct"
									+" WHERE"
										+" Ct.CodigoContato = C.CodigoContato"
								+" FOR XML PATH('')), 1, 2, ''), '') AS TelefoneEmpresa"
								+" ,IsNull(C.Imagem, 'Não informado') as Imagem"
							+" FROM Contato C"
								+" LEFT JOIN ContatoEndereco CE ON(CE.CodigoContato = C.CodigoContato)"
							+" WHERE C.CodigoContato ="+rowVenAvs.CodigoEmpresa
							+" ORDER BY 1 Desc"
						, false, url, banco, usuario);

						//Temp (Dados Empresa)
						ItensAvulsos = ItensAvulsos
							.replaceAll("[NomeEmpresa]", dadosEmissorAvs.Records[0].NomeEmpresa)
							.replaceAll("[EnderecoEmpresa]", dadosEmissorAvs.Records[0].EnderecoEmpresa)
							.replaceAll("[TelefoneEmpresa]", dadosEmissorAvs.Records[0].TelefoneEmpresa)
							.replaceAll("[EmailEmpresa]", dadosEmissorAvs.Records[0].EmailEmpresa)
							.replaceAll("[SiteEmpresa]", dadosEmissorAvs.Records[0].SiteEmpresa)
						;


						//Dados do Cliente
						var dadosClienteAvs = GeeksSQL(
							" SELECT"
								+" TOP 1 IsNull(Ce.CodigoContatoEndereco, '') as Ordem"
								+" ,IsNull(C.CodigoContato, '') as CodigoCliente"
								+" ,IsNull(C.Nome, '') as NomeCliente"
								+" ,IsNull(C.NumeroDocumentoNacional, '') as CPFCliente"
								+" ,IsNull(C.NumeroDocumentoEstadual, '') as RGCliente"
								+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')+ IsNull('  '+Ce.Municipio, '')+ IsNull('/'+Ce.UF, '')+ IsNull(' - '+Ce.Cep, '')) as EnderecoCliente"
								+" ,(IsNull(Ce.Logradouro, '')+ IsNull(', '+Ce.Numero, 'S/N ')+ IsNull(' - '+Ce.Bairro, '')) as LogradouroCliente"
								+" ,IsNull(Ce.Municipio, '') as CidadeCliente"
								+" ,IsNull(Ce.UF, '') as UFCliente"
								+" ,STUFF(("
									+" SELECT ',  '+ Ct.Telefone"
									+" FROM ContatoTelefone Ct"
									+" WHERE"
										+" Ct.CodigoContato = C.CodigoContato"
								+" FOR XML PATH('')), 1, 2, '') AS TelefoneCliente"
							+" FROM Contato C"
								+" LEFT JOIN ContatoEndereco Ce ON(Ce.CodigoContato = C.CodigoContato)"
							+" WHERE C.CodigoContato ="+rowVenAvs.CodigoCliente
							+" ORDER BY 1 Desc"
						, false, url, banco, usuario);

						//Temp (Dados Cliente)
						ItensAvulsos = ItensAvulsos
							.replaceAll("[CodigoCliente]", dadosClienteAvs.Records[0].CodigoCliente)
							.replaceAll("[NomeCliente]", dadosClienteAvs.Records[0].NomeCliente)
							.replaceAll("[EnderecoCliente]", dadosClienteAvs.Records[0].EnderecoCliente)
							.replaceAll("[TelefoneCliente]", dadosClienteAvs.Records[0].TelefoneCliente)
						;


						//Var Totalizadores
						var QtdTotalItens = 0;
						var ValorTotalItens = 0;


						//Itens Avulsos (Itens que Comtem Documento Tipo=Item e DocumentoItem)
						var AvulsosItens = GeeksSQL(
							" SELECT"
								+" IsNull(CodigoItem, '') CodigoItem,"
								+" IsNull(Ditem.DescricaoItem, '') DescricaoItem,"
								+" IsNull(Ditem.Marca, '') Marca,"
								+" IsNull(Ditem.Quantidade, 0) Quantidade,"
								+" IsNull(Ditem.SubTotal, 0.00) SubTotal,"
								+" IsNull(Ditem.DescontoItem, 0.00) Desconto,"
								+" IsNull(Ditem.Total, 0.00) Total"
							+" FROM DocumentoItem as Ditem"
							    +" LEFT JOIN Documento Di ON(Di.CodigoDocumento = Ditem.CodigoDocumento)"
							    +" LEFT JOIN Documento De ON(De.CodigoDocumentoAdicional = Di.CodigoDocumento) AND (De.Tipo='Envelope')"
							+" WHERE"
							    +" De.CodigoDocumentoAdicional IS NULL"
							    +" AND Di.Tipo='Item Venda'"
							    +" AND Di.CodigoDocumentoAdicional ="+rowVenAvs.CodigoVenda
						,false ,url ,banco ,usuario);

						$(AvulsosItens.Records).each(function(index, rowAvsIt){
							//Totalizador Itnes
							QtdTotalItens += rowAvsIt.Quantidade;
							ValorTotalItens += rowAvsIt.Total;

							//Get Template
							var LinhasItensAvulsos = $("#tempLinhasItensAvulsos").html();

							LinhasItensAvulsos = LinhasItensAvulsos
								.replaceAll("[DescItem]", rowAvsIt.DescricaoItem)
								.replaceAll("[MarcaItem]", rowAvsIt.Marca)
								.replaceAll("[QtdItem]", rowAvsIt.Quantidade)
								.replaceAll("[ValorItem]", rowAvsIt.Total.toFixed(2).replace('.',','))
							;

							ItensAvulsos = $("<div></div>").append(ItensAvulsos);
							ItensAvulsos.find(".LinhaItemAvulso").each(function() {
								$( this ).append(LinhasItensAvulsos);
							});
							ItensAvulsos = ItensAvulsos.html();

							LinhasItensAvulsos = '';
						});//Row Itens Avulsos


						//Outros Itens (Itens lançados diretamente na DocumentoItem)
						var OutItens = GeeksSQL(
							" SELECT"
								+" IsNull(CodigoItem, '') CodigoItem,"
								+" IsNull(Ditem.DescricaoItem, '') DescricaoItem,"
								+" IsNull(Ditem.Marca, '') Marca,"
								+" IsNull(Ditem.Quantidade, 0) Quantidade,"
								+" IsNull(Ditem.SubTotal, 0.00) SubTotal,"
								+" IsNull(Ditem.DescontoItem, 0.00) Desconto,"
								+" IsNull(Ditem.Total, 0.00) Total"
							+" FROM DocumentoItem as Ditem"
							+" WHERE"
							    +" (Ditem.CodigoDocumento ="+rowVenAvs.CodigoVenda+")"
						,false ,url ,banco ,usuario);

						$(OutItens.Records).each(function(index, rowOutIt) {
							//Totalizador Itnes
							QtdTotalItens += rowOutIt.Quantidade;
							ValorTotalItens += rowOutIt.Total;

							//Get Template
							var LinhasItensAvulsos = $("#tempLinhasItensAvulsos").html();

							LinhasItensAvulsos = LinhasItensAvulsos
								.replaceAll("[DescItem]", rowOutIt.DescricaoItem)
								.replaceAll("[MarcaItem]", rowOutIt.Marca)
								.replaceAll("[QtdItem]", rowOutIt.Quantidade)
								.replaceAll("[ValorItem]", rowOutIt.Total.toFixed(2).replace('.',','))
							;

							ItensAvulsos = $("<div></div>").append(ItensAvulsos);
							ItensAvulsos.find(".LinhaItemAvulso").each(function() {
								$( this ).append(LinhasItensAvulsos);
							});
							ItensAvulsos = ItensAvulsos.html();

							LinhasItensAvulsos = '';
						});//Row Outros Itens


						//Totalizadores Itens
						ItensAvulsos = ItensAvulsos
							.replaceAll("[QtdTotalItens]", QtdTotalItens)
							.replaceAll("[ValorTotalItens]", ValorTotalItens.toFixed(2).replace('.',','))
						;

						//Verifica se existem itens avulsos
						if (QtdTotalItens > 0) {
							//Print Template
							$(".PrintTemplateAvs").append(ItensAvulsos);
						}


						//Gera e Insere Código de Barras (Base Cod. Envelope)
						var numero = String(rowVenAvs.CodigoVenda);
						var zeros = 13 - Number(numero.length);

						for (var i = 0; i < zeros; i++)
							numero = '0' + numero;

						$(".CodBarras"+rowVenAvs.CodigoVenda).each(function() {
							$( this ).css("white-space", "nowrap");
							$( this ).css("background-color", "#fff");
							$( this ).html(fbarcode(numero,20));
						});
						$(".CodVenda"+rowVenAvs.CodigoVenda).each(function() {
							$( this ).html('Cód.: '+rowVenAvs.CodigoVenda+'  / Nº: '+rowVenAvs.NumeroVenda);
						});

						//Logo do Impresso
						if (dadosEmissorAvs.Records[0].Imagem != "Não informado") {
							$(".logo").each(function() {
								$( this ).html('<img class="img-responsive" src="' + dadosEmissorAvs.Records[0].Imagem.split("#")[0] + '"/>');
							});
						}

					});//row Venda Itens Avulsos
				}//if

			});
		</script>
	</body>
</html>