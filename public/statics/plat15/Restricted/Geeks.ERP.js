var admAtivado=!1;function initLayout(){function e(e){var r=Geeks.ERP.Core.Connection.ExecuteSQL(`Select * from objeto where codigoObjeto=${e}`,!0).Records[0];Geeks.ERP.UI.Tela.OpenWindow("content",$("#content"),r,null,!0)}window.self!==window.top&&($("#sidebar, #top").hide(),$("#content").css("padding-top","0"),window.parent.postMessage({status:"carregado"},"*")),$(".menuToggler").on("click",(function(){$(document.body).toggleClass("is-menuOpened")})),$("#usualValidate").validate({rules:{firstname:"required",minChars:{required:!0,minlength:3},maxChars:{required:!0,maxlength:6},mini:{required:!0,min:3},maxi:{required:!0,max:6},range:{required:!0,range:[6,16]},emailField:{required:!0,email:!0},urlField:{required:!0,url:!0},dateField:{required:!0,date:!0},digitsOnly:{required:!0,digits:!0},enterPass:{required:!0,minlength:5},repeatPass:{required:!0,minlength:5,equalTo:"#enterPass"},customMessage:"required",topic:{required:"#newsletter:checked",minlength:2},agree:"required"},messages:{customMessage:{required:"Bazinga! This message is editable"},agree:"Please accept our policy"}}),$("#validate").validationEngine(),$(".fulldd li").click((function(){$(this).children("ul").slideToggle(150)})),$(document).bind("click",(function(e){$(e.target).parents().hasClass("has")||$(".fulldd li").children("ul").slideUp(150)})),$(".userNav a.search").click((function(){$(".topSearch").fadeToggle(150)})),$(".iTop").click((function(){$("#sidebar").slideToggle(100)})),$(".iButton").click((function(){$(".altMenu").slideToggle(100)})),$("#content").resize((function(){$(this).width()<769?$(this).addClass("under"):$(this).removeClass("under")})).resize(),$("ul.userNav li a.sidebar").click((function(){$(".secNav").toggleClass("display")}));var r=new URL(document.location).searchParams.get("tela");r>0&&e(r),window.addEventListener("message",(function(r){e(r.data.objeto),localStorage.setItem("plat15message","tela aberta")}))}function openReport(e,r){var o={data:$("#hfCodigoSistema").data("GeeksData")},t=uid(),a="https://rel.storage.b15.com.br/Relatorios/"+e+".html";return localStorage.setItem(t,JSON.stringify(o)),window.open(a+"?rid="+t+"&"+(r||"").replace("15A/Core","15A")+"&hfCodigoSistema="+JSON.stringify(o),t),!0}function openMultipleReport(e,r){var o={data:$("#hfCodigoSistema").data("GeeksData")};o=JSON.stringify(o);for(var t="https://rel.storage.b15.com.br/Relatorios/"+e+".html",a=0;a<r.length;a++){var n=uid();localStorage.setItem(n,o),window.open(t+"?rid="+n+"&"+(r[a]||"").replace("15A/Core","15A")+"&hfCodigoSistema="+JSON.stringify(o),n)}return!0}function openReportEmail(e,r){var o={data:$("#hfCodigoSistema").data("GeeksData")},t=uid(),a="https://rel.storage.b15.com.br/Relatorios/"+e+".html?rid="+t+"&"+((r=r+"&NomeReport="+e)||"").replace("15A/Core","15A")+"&hfCodigoSistema="+JSON.stringify(o);return localStorage.setItem(t,JSON.stringify(o)),window.open("https://rel.storage.b15.com.br/Relatorios/email.html?linkTo="+a),!0}function wordWrap(e,r){var o="\n";done=!1,res="";do{for(found=!1,i=r-1;i>=0;i--)if(testWhite(e.charAt(i))){res+=[e.slice(0,i),o].join(""),e=e.slice(i+1),found=!0;break}found||(res+=[e.slice(0,r),o].join(""),e=e.slice(r)),e.length<r&&(done=!0)}while(!done);return res+e}function testWhite(e){return new RegExp(/^\s$/).test(e.charAt(0))}function ObterValorConfiguracao(e,r){var o,t=Geeks.ERP.Core.Connection.ExecuteSQL("select * from Configuracoes  where Nome = '"+e+"' ");return null==(o=t.Records.length>0?t.Records[0].Valor:null)&&(o=r),o}Number.prototype.getMoney=function(e,r,o,t){e=isNaN(e=Math.abs(e))?2:e,r=void 0!==r?r:"$",o=o||",",t=t||".";var a=this,n=a<0?"-":"",i=parseInt(a=Math.abs(+a||0).toFixed(e),10)+"",s=(s=i.length)>3?s%3:0;return r+n+(s?i.substr(0,s)+o:"")+i.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+o)+(e?t+Math.abs(a-i).toFixed(e).slice(2):"")},String.prototype.replaceAll=String.prototype.replaceAll||function(e,r){return this.split(e).join(r)};var waitForm=void 0;function WaitForm(e){e||(e="Processando...");var r=($(window).width()-322)/2,o=($(window).height()-100)/2,t=$('<div id="popup_overlay" style="position: absolute; z-index: 99998; top: 0px; left: 0px; width: 100%; height: 100%; background: rgb(255, 255, 255); opacity: 0.01;"></div><div id="popup_backPanel" style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 20000; background-image: url(/Content/Plugins/jquery.alerts/Images/transparente.png);"></div><div id="popup_container" class="ui-draggable" style="position: fixed; z-index: 99999; padding: 0px; margin: 0px; min-width: 322px; max-width: 322px; top: '+o+"px; left: "+r+'px;">\t<h1 id="popup_title" style="cursor: move;">Aguarde...</h1>\t<div id="popup_content" class="wait">\t\t<div id="popup_message">'+e+'\t\t</div>\t\t<div id="popup_panel"></div>\t</div></div>');$("body").append(t),waitForm={window:t,close:function(){waitForm.window.remove()}}}function ShowError(e){e.message?jError(e.message,"Atenção"):e.ErrorMessage?jError(e.ErrorMessage,"Atenção"):jError("Ocorreu um erro desconhecido. Por favor, entre em contato com a Geeks.","Atenção"),$("body").remove("#DivError"),""!=e.ErrorStack&&$("body").append('<div id="DivError" style="display: none">'+e.ErrorStack+"</div>")}function getDecimal(e){if(!e)return 0;try{var r=e.replace(" ","").replace("R$","").replace("%","").replace(".","").replace(",",".");return parseFloat(r)}catch(r){return parseFloat(e)}}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function GetConfiguracao(){WaitForm("Buscando Configurações do Sistema..."),$.ajax({type:"POST",url:"http://localhost:5555/Core/GetConfiguracaoPAF",data:null,dataType:"json",async:!0,success:function(e){waitForm&&waitForm.close(),configuracaoPAF=e.Records[0],e.HasError?ShowError(e):null!=e.Records[1]&&("1"!=e.Records[1].RetornoMetodo?jError(e.Records[1].MsgRetorno||e.Records[1].MsgErro,"Atenção"):""!=e.Records[1].MsgErro?jError(e.Records[1].MsgErro,"Atenção"):""!=e.Records[1].MsgAviso&&jAlert(e.Records[1].MsgAviso,"Atenção"))},error:function(e){waitForm&&waitForm.close(),"0"==e.status||ShowError(e.responseText)}})}function EnvioWS(){$.ajax({type:"POST",url:"http://localhost:5555/Core/EnvioWS",data:{DllPath:"",Type:"",Method:"",Parameters:JSON.stringify(["Ambos"])},dataType:"json",async:!0,success:function(e){waitForm&&waitForm.close(),e.HasError?(e.ErrorMessage.indexOf("PROGRAMA BLOQUEADO POR")>=0&&($("#content_Menu").empty(),$("#menu").find("a").not("#lateral244").not("#lateral251").parent().remove(),$("#content_Menu").data("SistemaBloqueado",!0)),jError(e.ErrorMessage,"Atenção",(function(){GetConfiguracao()}))):""!=e.Records[0].Aviso?jAlert(e.Records[0].Aviso,"Sucesso",(function(){GetConfiguracao()})):GetConfiguracao()},error:function(e){waitForm&&waitForm.close(),"0"==e.status||ShowError(e.responseText)}})}function GeeksSQL(e,r,o,t,a){var n,i=null;if($.isArray(e)){var s=[];for(var l in e){if(console.log("Chamando Sentença: "+e[l]),e[l].toLowerCase().indexOf("update")>-1||e[l].toLowerCase().indexOf("delete")>-1||e[l].toLowerCase().indexOf("alter")>-1||e[l].toLowerCase().indexOf("create")>-1||e[l].toLowerCase().indexOf("drop")>-1||e[l].toLowerCase().indexOf("truncate")>-1||e[l].toLowerCase().indexOf("insert")>-1||e[l].indexOf("exec")>-1||e[l].indexOf("grant")>-1)return void ShowError("Query não permitida! "+e[l]);e[l]=e[l].replace(/'/g,"$--$").replace(/"/g,"-#-#-"),s.push(e[l])}o+="/Core/ExecuteAllSQL",n=JSON.stringify(s)}else{if(console.log("Chamando Sentença: "+e),e.toLowerCase().indexOf("update")>-1||e.toLowerCase().indexOf("delete")>-1||e.toLowerCase().indexOf("alter")>-1||e.toLowerCase().indexOf("create")>-1||e.toLowerCase().indexOf("drop")>-1||e.toLowerCase().indexOf("truncate")>-1||e.toLowerCase().indexOf("insert")>-1||e.indexOf("exec")>-1||e.indexOf("grant")>-1)return void ShowError("Query não permitida! "+e);o+="/Core/ExecuteSQL",n=e=e.replace(/'/g,"$--$").replace(/"/g,"-#-#-")}return $.ajax({type:"POST",url:o,data:{database:t,sentence:n,user:a},dataType:"json",async:!!r,success:function(e){i=e},error:function(e){}}),i}function getMonth(e){return["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"][Number(e)-1]}function getExtensive(e,r){for(var o,t,a,n,i,s=[["zero","um","dois","três","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],["dez","vinte","trinta","quarenta","cinquenta","sessenta","setenta","oitenta","noventa"],["cem","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],["mil","milhão","bilhão","trilhão","quadrilhão","quintilhão","sextilhão","setilhão","octilhão","nonilhão","decilhão","undecilhão","dodecilhão","tredecilhão","quatrodecilhão","quindecilhão","sedecilhão","septendecilhão","octencilhão","nonencilhão"]],l=" e ",c=1==r?"real":"",d=1==r?"centavo":"",u=(n=String(e).replace(e?/[^,\d]/g:/\D/g,"").split(",")).length-1,p=-1,m=[],g=[],f="";++p<=u;g=[])if(p&&(n[p]=(1*("."+n[p])).toFixed(2).slice(2)),(o=(t=n[p]).slice((i=t.length)%3).match(/\d{3}/g),t=i%3?[t.slice(0,i%3)]:[],t=o?t.concat(o):t).length){for(o=-1,i=t.length;++o<i;f="")(a=1*t[o])&&(a%100<20&&(f+=s[0][a%100])||a%100+1&&(f+=s[1][(a%100/10>>0)-1]+(a%10?l+s[0][a%10]:"")),g.push((a<100?f:a%100?s[2][a/100>>0]+l+f:s[2][100==a?0:a/100>>0])+((f=i-o-2)>-1?" "+(a>1&&f>0?s[3][f].replace("ão","ões"):s[3][f]):"")));(o=g.length>1?(o=g.pop(),g.join(" ")+l+o):g.join("")||(!p&&1*n[p+1]>0||m.length?"":s[0][0]))&&m.push(o+(e?" "+(1*t.join("")>1?p?d+"s":(/0{6,}$/.test(n[0])?"de ":"")+c.replace("l","is"):p?d:c):""))}return 1==r?m.join(l):m.join(l).trim()}function ShowError(e){e&&e.message?alert(e.message,"Atenção"):e&&e.ErrorMessage?alert(e.ErrorMessage,"Atenção"):e?alert(e,"Atenção"):alert("Ocorreu um erro desconhecido. Por favor, entre em contato com a Geeks.","Atenção"),$("body").remove("#DivError"),e&&""!=e.ErrorStack&&$("body").append('<div id="DivError" style="display: none">'+e.ErrorStack+"</div>")}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function ShowError(e){e&&e.message?jError(e.message,"Atenção"):e&&e.ErrorMessage?jError(e.ErrorMessage,"Atenção"):e&&(e.indexOf("Erro no tempo de execução")>-1||e.indexOf("Runtime Error"))?jError("Ocorreu um erro em sua operação. Por favor, entre em contato com o suporte!","Atenção"):e?jError(e,"Atenção"):jError("Ocorreu um erro desconhecido. Por favor, entre em contato com a Geeks.","Atenção"),$("body").remove("#DivError"),e&&""!=e.ErrorStack&&$("body").append('<div id="DivError" style="display: none">'+e.ErrorStack+"</div>")}function validaData(e){try{var r=e.split(/[\.\-\/]/),o=parseInt(r[2],10),t=parseInt(r[1],10),a=parseInt(r[0],10),n=new Date(o,t-1,a,0,0,0,0);return t===n.getMonth()+1&&a===n.getDate()&&o===n.getFullYear()}catch(e){return!1}}function validaMail(e){return new RegExp(/^[A-Za-z0-9_\-\.]+@[A-Za-z0-9_\-\.]{2,}\.[A-Za-z0-9]{2,}(\.[A-Za-z0-9])?/).test(e)}function uid(){for(var e="",r=0;r<32;r++)e+=Math.floor(16*Math.random()).toString(16).toUpperCase();return e}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function SetaValorPrompt(e,r){$(e).siblings("[name="+r+"]").val(e.value)}function getDecimal(e){if(!e)return 0;try{var r=e.replace(" ","").replace("R$","").replace("%","").replace(".","").replace(",",".");return parseFloat(r)}catch(r){return parseFloat(e)}}function SetaValorDataHora(e){var r=e.name.replace("d_","").replace("t_",""),o=$(e).parent().parent().find("[name=d_"+r+"]").val(),t=$(e).parent().parent().find("[name=t_"+r+"]").val();$(e).parent().parent().find("[name="+r+"]").val(o+" "+t)}nl2br=function(e){return e.replace(/\n/g,"<br />")},String.prototype.format=function(){var e=this,r=arguments[0];for(var o in r)r.hasOwnProperty(o)&&(e=e.replace(new RegExp("\\{"+o+"\\}","gm"),r[o]));return e},$("#btnEnviarEmail").click((function(){"none"==$("#dadosEmail").css("display")?$("#dadosEmail").css("display","block"):$("#dadosEmail").css("display","none")})),$("#btnEnviar").click((function(){var e=$("#emailRemetente").val(),r=$("#emailDestinatario").val(),o=$("#emailCc").val(),t=$("#emailCco").val(),a=$("#emailAssunto").val(),n=nl2br($("#emailCorpo").val()),i=window.location.href;if(e&&r&&a){GeeksSQL("Exec Sp_Envia_Email "+e+", '"+r+"', '"+o+"', '"+t+"', '"+a+"', '"+n+"', '"+i+"'",!0),$("#dadosEmail").css("display","none");var s="Fatura enviada para "+r+"\n";o&&(s+="E-mail(s) em cópia: "+o+"\n"),t&&(s+="E-mail(s) em cópia oculta: "+t),alert(s)}else alert("Faltam informações para o envio do e-mail!")}));