Geeks.Async.Core.Connection={ExecuteSQL:function(e,o){return new Promise(((r,n)=>{var a,s=null,t=o?config.serverAddress:$("#hfCodigoSistema").data("GeeksData").URLServidor,i=o?config.structureDatabase:$("#hfCodigoSistema").data("GeeksData").BancoDeDados;if($.isArray(e)){var u=[];for(var d in e)console.log("Chamando Sentença: "+e[d]),e[d]=e[d].replace(/'/g,"$--$").replace(/"/g,"-#-#-"),u.push(e[d]);t+="/ExecuteAllSQL",a=JSON.stringify(u)}else console.log("Chamando Sentença: "+e),t+="/ExecuteSQL",a=e=e.replace(/'/g,"$--$").replace(/"/g,"-#-#-");$.ajax({type:"POST",url:t,data:{database:i,sentence:a,user:$("#hfCodigoUsuario").length>0?$("#hfCodigoUsuario").val():17,caller:""},dataType:"json",async:!0,success:function(o){if($.isArray(e)){var a=$.grep(o,(function(e){return!0===e.HasError}));a.length>0&&(ShowError(a[0]),n())}else o.HasError&&(ShowError(o),n());if(s=o,$.isArray(s)){for(var t=0;t<s.length;t++)for(c in s[t].Columns)if("DateTime"==s[t].Columns[c].ColumnType)for(l in s[t].Records)s[t].Records[l]&&s[t].Records[l]["__"+s[t].Columns[c].ColumnName]&&(i=s[t].Records[l]["__"+s[t].Columns[c].ColumnName].split(".")).length>1&&(s[t].Records[l][s[t].Columns[c].ColumnName]="/Date("+new Date(i[2],i[1]-1,i[0],i[3],i[4],i[5]).getTime()+")/"),delete s[t].Records[l]["__"+s[t].Columns[c].ColumnName]}else for(c in s.Columns)if("DateTime"==s.Columns[c].ColumnType)for(l in s.Records){var i;s.Records[l]&&s.Records[l]["__"+s.Columns[c].ColumnName]&&(i=s.Records[l]["__"+s.Columns[c].ColumnName].split(".")).length>1&&(s.Records[l][s.Columns[c].ColumnName]="/Date("+new Date(i[2],i[1]-1,i[0],i[3],i[4],i[5]).getTime()+")/"),delete s.Records[l]["__"+s.Columns[c].ColumnName]}r(s)},error:function(e){ShowError(e.responseText),n()}})}))},ReportExecuteSQL:function(e,o){var r,n=null,a=o?config.serverAddress:$("#hfCodigoSistema").data("GeeksData").URLServidor,s=o?config.structureDatabase:$("#hfCodigoSistema").data("GeeksData").BancoDeDados;if($.isArray(e)){var t=[];for(var i in e){if(console.log("Chamando Sentença: "+e[i]),e[i].toLowerCase().indexOf("update")>-1||e[i].toLowerCase().indexOf("delete")>-1||e[i].toLowerCase().indexOf("alter")>-1||e[i].toLowerCase().indexOf("create")>-1||e[i].toLowerCase().indexOf("drop")>-1||e[i].toLowerCase().indexOf("truncate")>-1||e[i].toLowerCase().indexOf("insert")>-1||e[i].indexOf("exec")>-1||e[i].indexOf("grant")>-1)return void ShowError("Query não permitida! "+e[i]);e[i]=e[i].replace(/'/g,"$--$").replace(/"/g,"-#-#-"),t.push(e[i])}a+="/ExecuteAllSQL",r=JSON.stringify(t)}else{if(console.log("Chamando Sentença: "+e),e.toLowerCase().indexOf("update")>-1||e.toLowerCase().indexOf("delete")>-1||e.toLowerCase().indexOf("alter")>-1||e.toLowerCase().indexOf("create")>-1||e.toLowerCase().indexOf("drop")>-1||e.toLowerCase().indexOf("truncate")>-1||e.toLowerCase().indexOf("insert")>-1||e.indexOf("exec")>-1||e.indexOf("grant")>-1)return void ShowError("Query não permitida! "+e);a+="/ExecuteSQL",r=e=e.replace(/'/g,"$--$").replace(/"/g,"-#-#-")}return $.ajax({type:"POST",url:a,data:{database:s,sentence:r,user:$("#hfCodigoUsuario").length>0?$("#hfCodigoUsuario").val():17,caller:null!=this.ExecuteSQL.caller&&null!=this.ExecuteSQL.caller.name?this.ExecuteSQL.caller.name:"Report"},dataType:"json",async:!!asyncronous,success:function(o){if($.isArray(e)){var r=$.grep(o,(function(e){return 1==e.HasError}));if(r.length>0)return void ShowError(r[0])}else if(o.HasError)return void ShowError(o);if(n=o,$.isArray(n)){for(var a=0;a<n.length;a++)for(c in n[a].Columns)if("DateTime"==n[a].Columns[c].ColumnType)for(l in n[a].Records)n[a].Records[l]&&n[a].Records[l]["__"+n[a].Columns[c].ColumnName]&&(s=n[a].Records[l]["__"+n[a].Columns[c].ColumnName].split(".")).length>1&&(n[a].Records[l][n[a].Columns[c].ColumnName]="/Date("+new Date(s[2],s[1]-1,s[0],s[3],s[4],s[5]).getTime()+")/"),delete n[a].Records[l]["__"+n[a].Columns[c].ColumnName]}else for(c in n.Columns)if("DateTime"==n.Columns[c].ColumnType)for(l in n.Records){var s;n.Records[l]&&n.Records[l]["__"+n.Columns[c].ColumnName]&&(s=n.Records[l]["__"+n.Columns[c].ColumnName].split(".")).length>1&&(n.Records[l][n.Columns[c].ColumnName]="/Date("+new Date(s[2],s[1]-1,s[0],s[3],s[4],s[5]).getTime()+")/"),delete n.Records[l]["__"+n.Columns[c].ColumnName]}asyncronousContinueFunction&&asyncronousContinueFunction(n)},error:function(e){ShowError(e.responseText)}}),n}};