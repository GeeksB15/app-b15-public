!function(l){var a={};function e(l){return plupload.translate(l)||l}l.fn.pluploadQueue=function(d){return d?(this.each((function(){var t,p,s;function i(a){var e;a.status==plupload.DONE&&(e="plupload_done"),a.status==plupload.FAILED&&(e="plupload_failed"),a.status==plupload.QUEUED&&(e="plupload_delete"),a.status==plupload.UPLOADING&&(e="plupload_uploading");var d=l("#"+a.id).attr("class",e).find("a").css("display","block");a.hint&&d.attr("title",a.hint)}function o(){l("span.plupload_total_status",p).html(t.total.percent+"%"),l("div.plupload_progress_bar",p).css("width",t.total.percent+"%"),l("span.plupload_upload_status",p).text(e("Uploaded %d/%d files").replace(/%d\/%d/,t.total.uploaded+"/"+t.files.length))}function u(){var a,d=l("ul.plupload_filelist",p).html(""),u=0;l.each(t.files,(function(e,p){a="",p.status==plupload.DONE&&(p.target_name&&(a+='<input type="hidden" name="'+s+"_"+u+'_tmpname" value="'+plupload.xmlEncode(p.target_name)+'" />'),a+='<input type="hidden" name="'+s+"_"+u+'_name" value="'+plupload.xmlEncode(p.name)+'" />',a+='<input type="hidden" name="'+s+"_"+u+'_status" value="'+(p.status==plupload.DONE?"done":"failed")+'" />',u++,l("#"+s+"_count").val(u)),d.append('<li id="'+p.id+'"><div class="plupload_file_name"><span>'+p.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+p.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(p.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+a+"</li>"),i(p),l("#"+p.id+".plupload_delete a").click((function(a){l("#"+p.id).remove(),t.removeFile(p),a.preventDefault()}))})),l("span.plupload_total_file_size",p).html(plupload.formatSize(t.total.size)),0===t.total.queued?l("span.plupload_add_text",p).text(e("Add files.")):l("span.plupload_add_text",p).text(t.total.queued+" files queued."),l("a.plupload_start",p).toggleClass("plupload_disabled",t.files.length==t.total.uploaded+t.total.failed),d[0].scrollTop=d[0].scrollHeight,o(),!t.files.length&&t.features.dragdrop&&t.settings.dragdrop&&l("#"+s+"_filelist").append('<li class="plupload_droptext">'+e("Drag files here.")+"</li>")}p=l(this),(s=p.attr("id"))||(s=plupload.guid(),p.attr("id",s)),t=new plupload.Uploader(l.extend({dragdrop:!0,container:s},d)),a[s]=t,t.bind("UploadFile",(function(a,e){l("#"+e.id).addClass("plupload_current_file")})),t.bind("Init",(function(a,i){!function(a,d){d.contents().each((function(a,e){(e=l(e)).is(".plupload")||e.remove()})),d.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+e("Select files")+'</div><div class="plupload_header_text">'+e("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+e("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+e("Status")+'</span></div><div class="plupload_file_size">'+e("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add buttonS bDefault">'+e("Add files")+'</a><a href="#" class="plupload_button plupload_start buttonS bRed">'+e("Start upload")+'</a><div class="clear"></div></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+a+'_count" name="'+a+'_count" value="0" /></div>')}(s,p),!d.unique_names&&d.rename&&l("#"+s+"_filelist div.plupload_file_name span",p).live("click",(function(e){var d,t,p,s=l(e.target),i="";p=(d=a.getFile(s.parents("li")[0].id)).name,(t=/^(.+)(\.[^.]+)$/.exec(p))&&(p=t[1],i=t[2]),s.hide().after('<input type="text" />'),s.next().val(p).focus().blur((function(){s.show().next().remove()})).keydown((function(a){var e=l(this);13==a.keyCode&&(a.preventDefault(),d.name=e.val()+i,s.text(d.name),e.blur())}))})),l("a.plupload_add",p).attr("id",s+"_browse"),a.settings.browse_button=s+"_browse",a.features.dragdrop&&a.settings.dragdrop&&(a.settings.drop_element=s+"_filelist",l("#"+s+"_filelist").append('<li class="plupload_droptext">'+e("Drag files here.")+"</li>")),l("#"+s+"_container").attr("title","Using runtime: "+i.runtime),l("a.plupload_start",p).click((function(a){l(this).hasClass("plupload_disabled")||t.start(),a.preventDefault()})),l("a.plupload_stop",p).click((function(l){l.preventDefault(),t.stop()})),l("a.plupload_start",p).addClass("plupload_disabled")})),t.init(),t.bind("Error",(function(a,d){var t,p=d.file;p&&(t=d.message,d.details&&(t+=" ("+d.details+")"),d.code==plupload.FILE_SIZE_ERROR&&alert(e("Error: File too large: ")+p.name),d.code==plupload.FILE_EXTENSION_ERROR&&alert(e("Error: Invalid file extension: ")+p.name),p.hint=t,l("#"+p.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",t))})),t.bind("StateChanged",(function(){t.state===plupload.STARTED?(l("li.plupload_delete a,div.plupload_buttons",p).hide(),l("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",p).css("display","block"),l("span.plupload_upload_status",p).text("Uploaded "+t.total.uploaded+"/"+t.files.length+" files"),d.multiple_queues&&l("span.plupload_total_status,span.plupload_total_file_size",p).show()):(u(),l("a.plupload_stop,div.plupload_progress",p).hide(),l("a.plupload_delete",p).css("display","block"))})),t.bind("QueueChanged",u),t.bind("FileUploaded",(function(l,a){i(a)})),t.bind("UploadProgress",(function(a,e){l("#"+e.id+" div.plupload_file_status",p).html(e.percent+"%"),i(e),o(),d.multiple_queues&&t.total.uploaded+t.total.failed==t.files.length&&(l(".plupload_buttons,.plupload_upload_status",p).css("display","inline"),l(".plupload_start",p).addClass("plupload_disabled"),l("span.plupload_total_status,span.plupload_total_file_size",p).hide())})),d.setup&&d.setup(t)})),this):a[l(this[0]).attr("id")]}}(jQuery);