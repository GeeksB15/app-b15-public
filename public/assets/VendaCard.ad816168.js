import{_ as M,M as P,bY as T,p as F,o as n,i as m,w as a,f as e,x as v,B as Q,E as G,ah as _,e as i,t as r,bb as V,C as g,b4 as B,j as p,l as f,k as w,am as I,ai as D,d as y,F as k,r as x,aj as h,ak as l,D as q,aF as H,L as C,s as R}from"./index.7658826a.js";import{D as K}from"./DocumentosFiscais.bffb3783.js";import{M as U}from"./ModalHistoricoStatus.5c8adad3.js";import{e as j}from"./emitirNFe.de0f28dd.js";const L={components:{Avatar:P,DocumentosFiscais:K,VendaModal:T,ModalHistoricoStatus:U},computed:{config(){return $db.configuracoes.valores},podeMigrarFatura(){return!~["Aguardando Estoque","Aguardando Financeiro","Aguardando Aprova\xE7\xE3o","Aguardando Pagamento","Cancelado","N\xE3o Aprovado","Or\xE7amento","Faturado"].indexOf(this.dados.venda.status)}},data(){return{dbUsuario:$db.usuario,dados:{venda:{}},contatos:{},faturasAbertas:[],detalhesVisivel:!1,visibilidade:{botao:{editar:!1,remover:!1}},modalDevolucaoGarantia:{visivel:!1,item:{},orcamento:{}},sistemaPai:"",configImpressaoOrcamento:[],configImpressaoEnvelope:[],documentoItemKit:{}}},emits:["executar"],methods:{async duplicarVenda(){try{await new Promise((o,s)=>{this.$q.dialog({message:"Duplicar este pedido?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{o()}).onCancel(()=>{s()})})}catch{return}try{const o=await $db.venda.duplicarVenda(this.id);this.$refs.vendaModal.mostrar({id:o}),this.$q.notify({type:"positive",message:"Pedido duplicado"})}catch(o){let s="N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o";/^GError:.+/.test(o.message)&&(s=o.message.slice(7)),this.$q.notify({type:"negative",message:s}),console.error(o)}},irParaAtendimentoFatura(o){this.$router.push({name:"AtendimentoFatura",params:{id:o}})},async migrarFatura(o){try{await new Promise((s,c)=>{this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 migrar esta venda para outra fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{s()}).onCancel(()=>{c()})})}catch{return}o||(o=$db.fatura.criar(this.dados.venda),await $db.fatura.grava({fatura:o})),o.id?(await $db.venda.grava({venda:{id:this.dados.venda.id,idFatura:o.id},vendaOriginal:this.dados.venda}),localStorage.setItem("idFatura",o.id),this.dados.venda.idContato&&(this.$emit("executar","atualizar"),this.irParaAtendimentoFatura(this.dados.venda.idContato))):this.$q.notify("N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o")},alternarDetalhes(){this.detalhesVisivel=!this.detalhesVisivel},async atualizar(){const o=await $db.venda.leCompleto(this.id);o.carrinho.sort((c,u)=>new Date(c.dataHoraEmissao)<new Date(u.dataHoraEmissao)?-1:1),o.oss.sort((c,u)=>new Date(c.documento.dataHoraEmissao)<new Date(u.documento.dataHoraEmissao)?-1:1),o.customs.sort((c,u)=>new Date(c.documento.dataHoraEmissao)<new Date(u.documento.dataHoraEmissao)?-1:1),o.kits.sort((c,u)=>new Date(c.documento.dataHoraEmissao)<new Date(u.documento.dataHoraEmissao)?-1:1);for(const c of o.kits){const u=c.documentosItem.find(t=>t.operacaoFator===-1&&t.operacao!=="Manipula\xE7\xE3o");this.documentoItemKit[c.documento.id]=u}if((o.venda||{}).idContato&&(o.venda||{}).idEmpresa){let c=[];c=await $db.fatura.obterAbertas(o.venda.idContato,o.venda.idEmpresa),this.faturasAbertas=c.sort((u,t)=>!u.numero||u.numero<t.numero?-1:1)}const s={};if(o.venda.idContato){const c=o.venda.idContato;s[c]||(s[c]=await $db.contato.le({id:c}))}if(o.venda.idContatoVendedor){const c=o.venda.idContatoVendedor;s[c]||(s[c]=await $db.contato.le({id:c}))}this.configuraImpressaoEnvelope(o.venda.idEmpresa),this.configuraImpressaoOrcamento(o.venda.idEmpresa),this.contatos=s,this.dados=o,await this.$nextTick(),o.venda.id===localStorage.getItem("idVenda")&&(this.$refs.vendaModal.mostrar({id:o.venda.id}),localStorage.removeItem("idVenda"))},async configuraImpressaoEnvelope(o){const s=await $db.configuracoes.porNome("impressao.envelope",o);this.configImpressaoEnvelope=[...s.length?s.map(c=>({texto:"Imprimir Envelope",...c})):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]]},async configuraImpressaoOrcamento(o){const s=await $db.configuracoes.porNome("impressao.venda",o);this.configImpressaoOrcamento=[...s.length?s.map(c=>({texto:"Imprimir Or\xE7amento",...c})):[{valor:"invoice",texto:"Or\xE7amento/Venda (Invoice)"},this.sistemaPai==="optisoul"?{valor:"orcamento",texto:"Or\xE7amento (Antigo)"}:{},this.sistemaPai==="optisoul"?{valor:"termoGarantia",texto:"Termo de Garantia"}:{}]]},copiarUid(){const o=this.$refs.uid;o.type="text";try{o.select(),document.execCommand("copy"),this.$q.notify({message:"UID copiado para a \xE1rea de transfer\xEAncia.",type:"info"})}catch{this.$q.notify("Erro ao copiar.")}o.type="hidden",window.getSelection().removeAllRanges()},descricaoEnvelope(o){let s="";for(const c of this.dados.itensEnvelopes)c.idDocumentoAdicional===o&&c.descricaoItem.trim()&&(s+=c.descricaoItem.trim()+" | ");return s.slice(0,-3)},async devolucaoGarantia(o){let s=await $db.documento.ler({idContato:$db.contato.selecionado.id,tipo:"Venda",status:"Or\xE7amento"});if(s=$lodash.orderBy(s,"dataHoraEmissao","desc"),!s.length){this.$q.notify({message:"Crie um or\xE7amento para inclus\xE3o de devolu\xE7\xE3o/garantia.",type:"info"});return}this.modalDevolucaoGarantia={visivel:!0,item:o,orcamento:s[0]}},editar(){this.$refs.vendaModal.mostrar({id:this.dados.venda.id})},executar(o){switch(o){case"atualizar":this.atualizar();break;case"cancelar":case"finalizar":case"reprovar":this.$emit("executar","atualizar");break;case"retornarOrcamento":this.$emit("executar",o);break}},async finalizaDevolucaoGarantia(o,s,c){const u=$utils.clonar(o);s==="devolucao"&&(u.operacao="Devolu\xE7\xE3o de Venda"),s==="garantia"&&(u.operacao="Garantia de Venda",u.motivo=c),u.idDocumentoItemVenda=u.id,u.idDocumentoVenda=u.idDocumento,u.id=$utils.uuid(),u.idDocumento=this.modalDevolucaoGarantia.orcamento.id,u.status="Or\xE7amento",u.operacaoFator=1,u.codigoCfop=20,u.idCfop=(await $db.cfop.le({codigoCfop:20}))[0].id,u.dataHoraEmissao=$utils.dataAtual(),u.dataHoraFinalizado="",u.subTotal=u.subTotal*-1,u.total=u.total*-1,u.valorItem=u.valorItem*-1,u.descontoSubTotal=0,delete u.codigoCfop,delete u.codigoDocumento,delete u.codigoDocumentoItem,delete u.codigoItem,delete u.codigoPlanoContaDestino,delete u.codigoPlanoContaEstoque,await $db.documentoItem.grava({atual:u}),this.$q.notify({message:"Item adicionado ao or\xE7amento.",type:"positive"}),localStorage.setItem("idVenda",this.modalDevolucaoGarantia.orcamento.id),this.$emit("executar","atualizar")},async remover(){this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 remover esta venda da fatura",title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{await $db.venda.checarConflitoStatus({id:this.dados.venda.id,status:this.dados.venda.status})}catch(s){return $q.notifyError(s.message),!1}let o=$utils.clonar(this.dados.venda);this.dados.venda.idFatura="",await $db.venda.grava({venda:this.dados.venda,vendaOriginal:o}),this.$emit("executar","remover")})}},mixins:[j],props:{id:{required:!0,type:String},resetarEnvio:{required:!1,type:Function}},watch:{async dados(o){this.visibilidade.botao.editar=!1,this.visibilidade.botao.visualizar=!1,this.visibilidade.botao.remover=!1,(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data.find(c=>c.id===o.venda.idEmpresa)&&(o.venda.idFatura&&this.faturasAbertas.find(c=>c.id===o.venda.idFatura)&&(this.visibilidade.botao.remover=await $db.permissao.objeto("Diretiva_Vendas_RemoverVendaFatura")),!~["Cancelado","N\xE3o Aprovado"].indexOf(o.venda.status)&&!o.venda.idFatura&&(this.visibilidade.botao.editar=!0),this.visibilidade.botao.editar||(this.visibilidade.botao.visualizar=!0))}},mounted(){this.sistemaPai=$utils.sistemaPai(),this.atualizar()}},J={class:"col-12 col-md-6 q-pl-none"},Y={class:"q-item-section"},W={class:"col-6 col-md hideonmobile"},X={class:"text-left q-my-none"},Z={class:"col-4 col-md hideonmobile"},$={class:"text-left q-my-none"},ee={class:"col-4 col-md hideonmobile"},ae={class:"text-left q-my-none"},te={class:"col-6 col-md hideonmobile"},oe={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},de={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},se={class:"col-12 hideondesktop"},ie={class:"text-left q-my-none"},ne={class:"col-12 col-md-6"},le={class:"col-12 col-md-6 full-height items-end hideonmobile"},re={class:"col-6"},ue={class:"text-left q-my-none"},ce={class:"text-left q-my-none"},me={class:"col-6"},ve={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},fe={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},pe={class:"col-12 full-height items-end"},he={class:"col-12 col-md-6"},_e={class:"text-subtitle1 text-weight-bold q-ma-none items-center"},be={class:"q-ma-none"},ye={key:0},ke={key:1},ge={class:"col-6 col-md-4"},Ce=v("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Faturamento ",-1),xe={class:"q-ma-none"},qe={class:"col-6 col-md-2 text-right"},we=v("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Desconto ",-1),Ve={class:"q-ma-none"};function Ee(o,s,c,u,t,b){const N=F("avatar"),z=F("row"),O=F("documentos-fiscais"),S=F("VendaModal"),A=F("modal-historico-status");return t.dados.venda.id?(n(),m(R,{key:0,id:"VendaCard",class:"extratoItem bg-white q-pa-sm no-shadow"},{default:a(()=>[e(z,{class:"items-center justify-between q-mx-none q-px-none q-mb-sm"},{default:a(()=>[v("div",J,[e(Q,{class:"q-pa-none"},{default:a(()=>[e(N,{imagem:(t.contatos[t.dados.venda.idContato]||{}).imagem,rotulo:t.dados.venda.descricaoContato,tamanho:"40",style:{float:"left"}},null,8,["imagem","rotulo"]),e(G,null,{default:a(()=>[v("div",Y,[e(_,null,{default:a(()=>[i(r((t.contatos[t.dados.venda.idContato]||{}).apelido),1)]),_:1}),e(_,{caption:""},{default:a(()=>[i(r((t.contatos[t.dados.venda.idContato]||{}).nome),1)]),_:1})])]),_:1}),e(V,{rounded:"",color:"tertiary",small:""},{default:a(()=>[i(r(t.dados.venda.status),1)]),_:1}),e(V,{class:"q-ml-sm",color:"positive",escuro:"",onClick:b.copiarUid},{default:a(()=>[i(" #"+r(parseInt(t.dados.venda.numero)||(t.dados.venda.id||"").slice(-6))+" ",1),g(v("input",{type:"hidden","onUpdate:modelValue":s[0]||(s[0]=d=>t.dados.venda.id=d),ref:"uid"},null,512),[[B,t.dados.venda.id]])]),_:1},8,["onClick"])]),_:1})]),v("div",W,[v("p",X,[t.contatos[t.dados.venda.idContatoVendedor]?(n(),m(p,{key:0,name:"mdi-account-tie"})):f("",!0),i(" "+r((t.contatos[t.dados.venda.idContatoVendedor]||{}).apelido)+" ",1),e(w,null,{default:a(()=>[i(" Vendedor(a) ")]),_:1})])]),v("div",Z,[v("p",$,[t.dados.venda.dataHoraEmissao?(n(),m(p,{key:0,name:"mdi-calendar-today "})):f("",!0),i(" "+r(o.$filters.data(t.dados.venda.dataHoraEmissao))+" ",1),e(w,null,{default:a(()=>[i(" Emiss\xE3o ")]),_:1})])]),v("div",ee,[v("p",ae,[t.dados.venda.dataHoraFinalizado?(n(),m(p,{key:0,name:"mdi-calendar-check"})):f("",!0),i(" "+r(o.$filters.data(t.dados.venda.dataHoraFinalizado))+" ",1),t.dados.venda.dataHoraFinalizado?(n(),m(w,{key:1},{default:a(()=>[i(" Finalizado ")]),_:1})):f("",!0)])]),v("div",te,[v("p",oe,r(o.$filters.numero(t.dados.venda.totalDocumento,2)),1),v("p",de,r(o.$filters.numero(t.dados.venda.subTotal,2)),1)])]),_:1}),e(I,{class:"hideondesktop q-mb-sm"}),e(z,{class:"q-mx-none q-px-none items-center"},{default:a(()=>[v("div",se,[v("p",ie,[t.contatos[t.dados.venda.idContatoVendedor]?(n(),m(p,{key:0,name:"mdi-account-tie"})):f("",!0),i(" "+r((t.contatos[t.dados.venda.idContatoVendedor]||{}).apelido)+" ",1),e(w,null,{default:a(()=>[i(" Vendedor(a) ")]),_:1})])]),v("div",ne,[e(D,{class:"no-border text-tertiary"},{default:a(()=>[(n(!0),y(k,null,x(t.dados.carrinho,d=>(n(),m(h,{key:d.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(l,{avatar:"",class:"mw80"},{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.quantidade)+"x",1)]),_:2},1024)]),_:2},1024),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.descricaoItem),1)]),_:2},1024)]),_:2},1024),e(l,{side:"",top:""},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(d.total,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(n(!0),y(k,null,x(t.dados.customs,d=>(n(),m(h,{key:d.documento.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(l,{avatar:"",class:"mw80"},{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.documento.numero)+"x ",1)]),_:2},1024)]),_:2},1024),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.documento.descricao),1)]),_:2},1024)]),_:2},1024),e(l,{side:"",top:""},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(d.documento.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(n(!0),y(k,null,x(t.dados.oss,d=>(n(),m(h,{key:d.documento.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(l,{avatar:"",class:"mw80"},{default:a(()=>[e(_,null,{default:a(()=>[i(" OS "),e(V,{color:"tertiary",small:""},{default:a(()=>[i("#"+r(d.documento.numero),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.documento.descricao),1)]),_:2},1024)]),_:2},1024),e(l,{avatar:"",class:"mw50"},{default:a(()=>[d.documento.status!=="Or\xE7amento"?(n(),m(V,{key:0,rounded:"",color:"tertiary",small:""},{default:a(()=>[i(r(d.documento.status),1)]),_:2},1024)):f("",!0)]),_:2},1024),e(l,{right:"",top:""},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(d.documento.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(n(!0),y(k,null,x(t.dados.kits,d=>(n(),m(h,{key:d.documento.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(l,{avatar:"",class:"mw80"},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(t.documentoItemKit[d.documento.id].quantidade,4))+"x",1)]),_:2},1024)]),_:2},1024),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(t.documentoItemKit[d.documento.id].descricaoItem),1)]),_:2},1024)]),_:2},1024),e(l,{side:"",top:""},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(t.documentoItemKit[d.documento.id].total,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(n(!0),y(k,null,x(t.dados.envelopes,d=>(n(),m(h,{key:d.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:a(()=>[e(l,{avatar:"",class:"mw80"},{default:a(()=>[e(_,null,{default:a(()=>[i(" EN "),e(V,{color:"tertiary",small:""},{default:a(()=>[i(" #"+r(parseInt(d.numero)||(d.id||"").slice(-6))+" ",1),e(w,null,{default:a(()=>[i(r(d.tipo)+" - "+r(d.descricaoContato),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(b.descricaoEnvelope(d.id)),1)]),_:2},1024)]),_:2},1024),e(l,{avatar:""},{default:a(()=>[d.status!=="Or\xE7amento"?(n(),m(V,{key:0,rounded:"",color:"tertiary",small:""},{default:a(()=>[i(r(d.status),1)]),_:2},1024)):f("",!0)]),_:2},1024),e(l,{right:"",top:""},{default:a(()=>[e(_,null,{default:a(()=>[i(r(o.$filters.numero(d.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),v("div",le,[e(I,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(q,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[e(H,null,{default:a(()=>[g((n(),m(D,{link:"",separator:""},{default:a(()=>[o.$utils.mapearStatus(t.dados.venda).permiteNota?(n(),y(k,{key:0},[g((n(),m(h,{clickable:"",onClick:s[1]||(s[1]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},1,"Venda"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Sa\xEDda/Venda")]),_:1})]),_:1})),[[C]]),g((n(),m(h,{clickable:"",onClick:s[2]||(s[2]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Entrada/Devolu\xE7\xE3o")]),_:1})]),_:1})),[[C]]),g((n(),m(h,{clickable:"",onClick:s[3]||(s[3]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},1,"Remessa"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Remessa")]),_:1})]),_:1})),[[C]])],64)):f("",!0),b.podeMigrarFatura?(n(),y(k,{key:1},[(n(!0),y(k,null,x(t.faturasAbertas.filter(d=>d.id!==t.dados.venda.idFatura),d=>g((n(),m(h,{clickable:"",key:d.id,onClick:E=>b.migrarFatura(d)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"mdi-folder-move"})]),_:1}),e(l,null,{default:a(()=>[i(r("Migrar para fatura #"+(d.numero||d.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[C]])),128)),g((n(),m(h,{clickable:"",onClick:s[4]||(s[4]=d=>b.migrarFatura())},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"mdi-folder-move"})]),_:1}),e(l,null,{default:a(()=>[i("Migrar para nova fatura")]),_:1})]),_:1})),[[C]])],64)):f("",!0),e(h,{clickable:"",onClick:s[5]||(s[5]=d=>o.$refs.modalHistoricoStatus.mostrar({idDocumento:t.dados.venda.id}))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"history"})]),_:1}),e(l,null,{default:a(()=>[i("Hist\xF3rico do Status")]),_:1})]),_:1}),e(h,{clickable:"",onClick:b.duplicarVenda},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"mdi-content-duplicate"})]),_:1}),e(l,null,{default:a(()=>[i("Duplicar Pedido")]),_:1})]),_:1},8,["onClick"]),c.resetarEnvio&&t.dados.venda.rotaJson&&t.dados.venda.rotaJson.length>0?(n(),m(h,{key:2,clickable:"",onClick:s[6]||(s[6]=d=>c.resetarEnvio(t.dados.venda))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"restart_alt"})]),_:1}),e(l,null,{default:a(()=>[i("Resetar Envio")]),_:1})]),_:1})):f("",!0)]),_:1})),[[C]])]),_:1})]),_:1}),t.visibilidade.botao.remover?(n(),m(q,{key:0,rounded:"",dense:"",flat:"",icon:"clear",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",onClick:b.remover,style:{float:"right"}},null,8,["onClick"])):f("",!0),t.visibilidade.botao.editar?(n(),m(q,{key:1,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:b.editar,style:{float:"right"}},null,8,["onClick"])):f("",!0),t.visibilidade.botao.visualizar?(n(),m(q,{key:2,rounded:"",dense:"",flat:"",icon:"remove_red_eye",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:b.editar,style:{float:"right"}},null,8,["onClick"])):f("",!0),e(q,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[e(H,null,{default:a(()=>[e(D,{link:"",separator:""},{default:a(()=>[(n(!0),y(k,null,x(t.configImpressaoOrcamento.filter(d=>d.valor),d=>(n(),m(h,{clickable:"",key:d.valor,onClick:E=>o.$imprimir(d.valor,{id:(t.dados.venda||{}).id||"0",Oculto:"0"})},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"print"})]),_:1}),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(n(!0),y(k,{key:0},x(t.configImpressaoEnvelope,d=>(n(),m(h,{clickable:"",key:d.valor,onClick:E=>o.$imprimir(d.valor,(t.dados.venda||{}).id||"0")},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"print"})]),_:1}),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):f("",!0)]),_:1})]),_:1})]),_:1}),e(q,{rounded:"",dense:"",flat:"",icon:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-mx-xs",color:"tertiary",style:{float:"right"},onClick:b.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),e(I,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(z,{class:"q-mx-none q-px-none hideondesktop"},{default:a(()=>[v("div",re,[v("p",ue,[t.dados.venda.dataHoraEmissao?(n(),m(p,{key:0,name:"mdi-calendar-today"})):f("",!0),i(" "+r(o.$filters.data(t.dados.venda.dataHoraEmissao))+" ",1),e(w,null,{default:a(()=>[i(" Emiss\xE3o ")]),_:1})]),v("p",ce,[t.dados.venda.dataHoraFinalizado?(n(),m(p,{key:0,name:"mdi-calendar-check"})):f("",!0),i(" "+r(o.$filters.data(t.dados.venda.dataHoraFinalizado))+" ",1),t.dados.venda.dataHoraFinalizado?(n(),m(w,{key:1},{default:a(()=>[i(" Finalizado ")]),_:1})):f("",!0)])]),v("div",me,[v("p",ve,r(o.$filters.numero(t.dados.venda.subTotal,2)),1),v("p",fe,r(o.$filters.numero(t.dados.venda.totalDocumento,2)),1)]),v("div",pe,[e(I,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(q,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[e(H,null,{default:a(()=>[g((n(),m(D,{link:"",separator:""},{default:a(()=>[o.$utils.mapearStatus(t.dados.venda).permiteNota?(n(),y(k,{key:0},[g((n(),m(h,{clickable:"",onClick:s[7]||(s[7]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},1,"Venda"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Sa\xEDda/Venda")]),_:1})]),_:1})),[[C]]),g((n(),m(h,{clickable:"",onClick:s[8]||(s[8]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},0,"Devolu\xE7\xE3o"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Entrada/Devolu\xE7\xE3o")]),_:1})]),_:1})),[[C]]),g((n(),m(h,{clickable:"",onClick:s[9]||(s[9]=d=>o.emitirNFeV2({idVenda:t.dados.venda.id},1,"Remessa"))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"account_balance"})]),_:1}),e(l,null,{default:a(()=>[i("NFe de Remessa")]),_:1})]),_:1})),[[C]])],64)):f("",!0),b.podeMigrarFatura?(n(),y(k,{key:1},[(n(!0),y(k,null,x(t.faturasAbertas.filter(d=>d.id!==t.dados.venda.idFatura),d=>g((n(),m(h,{key:d.id,onClick:E=>b.migrarFatura(d)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"mdi-folder-move"})]),_:1}),e(l,null,{default:a(()=>[i(r("Migrar para fatura #"+(d.numero||d.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[C]])),128)),g((n(),m(h,{onClick:s[10]||(s[10]=d=>b.migrarFatura())},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"mdi-folder-move"})]),_:1}),e(l,null,{default:a(()=>[i("Migrar para nova fatura")]),_:1})]),_:1})),[[C]])],64)):f("",!0),e(h,{clickable:"",onClick:s[11]||(s[11]=d=>o.$refs.modalHistoricoStatus.mostrar({idDocumento:t.dados.venda.id}))},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"history"})]),_:1}),e(l,null,{default:a(()=>[i("Hist\xF3rico do Status")]),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),_:1}),t.visibilidade.botao.remover?(n(),m(q,{key:0,rounded:"",dense:"",flat:"",icon:"clear",color:"tertiary",class:"no-shadow q-mx-xs",size:"md",onClick:b.remover,style:{float:"right"}},null,8,["onClick"])):f("",!0),t.visibilidade.botao.editar?(n(),m(q,{key:1,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-mx-xs",size:"md",onClick:b.editar,style:{float:"right"}},null,8,["onClick"])):f("",!0),e(q,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-mx-xs",size:"md",style:{float:"right"}},{default:a(()=>[e(H,null,{default:a(()=>[e(D,{link:"",separator:""},{default:a(()=>[(n(!0),y(k,null,x(t.configImpressaoOrcamento.filter(d=>d.valor),d=>(n(),m(h,{clickable:"",key:d.valor,onClick:E=>o.$imprimir(d.valor,{id:(t.dados.venda||{}).id||"0",Oculto:"0"})},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"print"})]),_:1}),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.sistemaPai==="optisoul"?(n(!0),y(k,{key:0},x(t.configImpressaoEnvelope,d=>(n(),m(h,{clickable:"",key:d.valor,onClick:E=>o.$imprimir(d.valor,(t.dados.venda||{}).id||"0")},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(p,{name:"print"})]),_:1}),e(l,null,{default:a(()=>[e(_,null,{default:a(()=>[i(r(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):f("",!0)]),_:1})]),_:1})]),_:1}),e(q,{rounded:"",dense:"",flat:"",icon:t.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-mx-xs",color:"tertiary",style:{float:"right"},onClick:b.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),t.detalhesVisivel?(n(),m(I,{key:0,class:"hideondesktop q-my-sm"})):f("",!0),t.detalhesVisivel?(n(),m(z,{key:1,class:"items-start q-mx-none q-px-none q-mt-md"},{default:a(()=>[v("div",he,[v("p",_e,[e(p,{name:"business"}),i(" "+r(t.dados.venda.descricaoEmpresa),1)]),v("p",be,[i(r(t.dados.venda.observacao)+" ",1),t.dados.venda.observacaoInterna?(n(),y("br",ye)):f("",!0),i(" "+r(t.dados.venda.observacaoInterna)+" ",1),t.dados.venda.observacaoCancelamento?(n(),y("br",ke)):f("",!0),i(" "+r(t.dados.venda.observacaoCancelamento),1)]),e(O,{idVenda:t.dados.venda.id},null,8,["idVenda"])]),v("div",ge,[Ce,v("p",xe,r(t.dados.venda.observacaoFaturamento),1)]),v("div",qe,[we,v("p",Ve,r(o.$filters.numero(t.dados.venda.totalDesconto,2)),1)])]),_:1})):f("",!0),e(S,{ref:"vendaModal",onExecutar:b.executar},null,8,["onExecutar"]),e(A,{ref:"modalHistoricoStatus"},null,512)]),_:1})):f("",!0)}var He=M(L,[["render",Ee]]);export{He as V};
