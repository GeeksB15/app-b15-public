import{_ as D,bd as T,p as O,o as g,i as q,w as a,f as l,K as z,A as Q,B as d,D as S,E as R,e as V,l as y,aF as A,C as j,aj as M,ak as L,j as H,L as P,G as J,H as B,x as i,s as f,aK as p,be as X,t as w,z as K,Q as b,U as v,I as G,aQ as W,y as Y}from"./index.6f8ff6bd.js";import{Q as Z}from"./QSpace.f8f6c471.js";import{o as C}from"./optionsNfse.22979934.js";import{J as k}from"./JsonViewer.3abe6a3a.js";const $={components:{JsonViewer:k},data(){return{showModal:!1,opcoesNatureza:[],opcoesTipoRps:[],opcoesRegimeEspecialTributacao:[],opcoesStatusRps:[],opcoesSimNao:[],opcoesUF:[],opcoesInformacoesServicos:[],telefoneTipos:[],situacaoNfse:"Rascunho",nfse:{},opcoesCidadeIbge:[],JsonViewer:k}},emits:["atualizar"],methods:{onHide(){this.$router.replace({params:{id:""}})},trocouServico(r){const e=this.opcoesInformacoesServicos.find(u=>u.codigo===r);this.nfse.servico.itemListaServico=e.codigo,this.nfse.servico.codigoCnae=e.codigoCNAE,this.nfse.servico.codigoTributacaoMunicipio=e.codigoTributacao},async abrirModalTomador(){const r={ativo:!0},e=await $g.promptContato.show({filtro:r,placeholder:"Selecione"});if(!e)return;if(!e.nome){$q.notifyError("\xC9 preciso informar a Raz\xE3o Social do Intermedi\xE1rio");return}if(!e.numeroDocumentoNacional||e.numeroDocumentoNacional.length<14){$q.notifyError("\xC9 preciso informar o CPF/CNPJ do Intermedi\xE1rio");return}const t=await $db.contatoEndereco.leEnderecoPrincipal(e.id);this.nfse.tomador.razaoSocial=e.nome,this.nfse.tomador.documento=e.numeroDocumentoNacional.match(/\d+/g).join(""),this.nfse.tomador.endereco.numero=t.numero,this.nfse.tomador.endereco.rua=t.logradouro,this.nfse.tomador.endereco.bairro=t.bairro,this.nfse.tomador.endereco.cidade=t.ibgeCod,this.nfse.tomador.endereco.estado=t.uf,this.nfse.tomador.endereco.cep=t.cep,this.opcoesCidadeIbge.push({valor:t.ibgeCod,rotulo:t.municipio+"-"+t.uf}),console.log(this.nfse),console.log(this.opcoesCidadeIbge)},async show(r,e,u){var N,_,x,E,I,U;let t=null,o=null,c=null,n=null;if(r&&(c=await $db.documentoFiscalEletronico.ler({id:r,tipo:"NFSe"}),n=JSON.parse(c.json),t=(await $erp().empresa.toArray()).find(h=>h.numeroDocumentoNacional.replace(/\D/g,"")===c.cpfCnpjEmitente)),t!=null&&t.idContato&&(o=(await $db.empresa.le({idContato:t.idContato}))[0]),o&&(e={nfseItensListaDeServico:JSON.parse((N=o.nfseItensListaDeServico)!=null?N:null)}),n!=null&&n.rps)this.nfse=n.rps,this.situacaoNfse=c.situacao;else{if(this.situacaoNfse="Rascunho",this.nfse=$utils.clonarV2($db.nfse.modelo),this.nfse.dataHoraCriacao=$utils.dataAtual(),u){const h=(x=JSON.parse((_=u==null?void 0:u.json)!=null?_:null))==null?void 0:x.rps,F=(Number((E=h==null?void 0:h.identificacaoRps)==null?void 0:E.numero)||0)+1;this.nfse.identificacaoRps.numero=F.toString(),this.nfse.identificacaoRps.serie=(I=h==null?void 0:h.identificacaoRps)==null?void 0:I.serie,this.nfse.numeroLote=this.nfse.numeroLote||F.toString()}this.nfse.prestador.documento=e.documento,this.nfse.prestador.razaoSocial=e.nome,this.nfse.prestador.inscricaoMunicipal=e.inscricaoMunicipal,this.nfse.inscricaoMunicipal=e.inscricaoMunicipal,this.nfse.optanteSimplesNacional=e.nfseOptanteSimples,this.nfse.incentivadorCultural=e.nfseIncentivadorCultural,this.nfse.naturezaOperacao=e.nfseNaturezaOperacao,this.nfse.regimeEspecialTributacao=e.nfseRegimeTributario,this.nfse.servico.discriminacao=e.nfseDescricaoServico,this.nfse.servico.valores.aliquota=e.nfseAliquotaIss,this.nfse.servico.municipioPrestacaoServico=e.ibgeCod,this.opcoesCidadeIbge.push({valor:e.ibgeCod,rotulo:e.cidadeUf}),console.log(this.opcoesCidadeIbge)}this.opcoesInformacoesServicos=e==null?void 0:e.nfseItensListaDeServico;const m=(U=$utils.clonarV2(c))!=null?U:{};let s={};delete m.rps,this.documentoFiscalEletronico=$utils.clonarV2(m),m.id&&(s=(await $erp().documentoFiscalEletronicoXml.where({idDocumentoFiscalEletronico:m.id}).toArray())[0]),this.documentoFiscalEletronico.id||(this.documentoFiscalEletronico.id=$utils.uuid()),this.documentoFiscalEletronicoOriginal=$utils.clonarV2(m),this.documentoFiscalEletronicoXmlOriginal=$utils.clonarV2(s),this.nfseOriginal=$utils.clonarV2(this.nfse),this.showModal=!0},async emitir(){var u;if(!await this.$refs.nfseForm.validate())return;let e;this.situacaoNfse==="Rascunho"&&(e="Enviando..."),this.situacaoNfse==="Protocolada"&&(e="Checando...");try{$q.loading.show({message:`${e}`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),this.nfse.dataEmissao=$utils.dataAtual();let t={...this.nfse,id:(u=this.documentoFiscalEletronico)==null?void 0:u.id};const{nfse:o,situacao:c}=await $db.nfse.emitir({nfse:t,aguardarRetorno:!0});this.nfse=o,this.situacaoNfse=c,c==="Enviada"&&(await this.salvar(async n=>{$q.loading.show({message:"Solicitando URL...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),await $db.nfse.solicitarURLImpressao(n)}),$q.notifyPositive("NFS-e emitida!")),c!=="Enviada"&&(typeof o.mensagemDeRetorno=="string"&&$q.notifyError(o.mensagemDeRetorno),typeof o.mensagemDeRetorno!="string"&&$q.notifyError("Erro de valida\xE7\xE3o"),await this.salvar())}catch(t){let o=t.message.replace("db.nfse.sincronizarLote: ","");o.length!==t.message&&$q.notifyError(o),o.length===t.message&&($q.notifyError("Falha ao emitir NFS-e"),console.error(t.message)),console.log(this.nfse)}finally{$q.loading.hide()}},async salvar(r){if(!await this.$refs.nfseForm.validate())return;const u=this.documentoFiscalEletronico.id||$utils.uuid(),t=this.documentoFiscalEletronicoOriginal.dataHoraCriacao||$utils.dataAtual(),o={id:u,tipo:"NFSe",tpAmb:"2",situacao:this.situacaoNfse,mod:"",serie:"",nNF:"",chNFe:"",vNF:0,dhEmi:T.formatarDataNFe(new Date(this.nfse.dataEmissao)),cpfCnpjEmitente:this.nfse.prestador.documento,xNomeEmitente:this.nfse.prestador.razaoSocial,cpfCnpjDestinatario:this.nfse.tomador.documento,xNomeDestinatario:this.nfse.tomador.razaoSocial,dataHoraEmissao:this.nfse.dataEmissao,dataHoraCriacao:t,protocoloRetorno:this.nfse.protocoloRetorno,xml:this.nfse.xml,pdf:this.nfse.pdf,json:JSON.stringify({rps:this.nfse})},c={id:this.documentoFiscalEletronicoXmlOriginal.id||$utils.uuid(),tipo:o.tipo,situacao:o.situacao,tpAmb:o.tpAmb,dataHoraEnvio:this.nfse.dataEmissao,cpfCnpjEmitente:this.nfse.prestador.documento,xmlEnvio:this.nfse.xml,idDocumentoFiscalEletronico:o.id};try{await $db.documentoFiscalEletronico.grava({atual:o,original:this.documentoFiscalEletronicoOriginal}),await $db.documentoFiscalEletronicoXml.grava({atual:c,original:this.documentoFiscalEletronicoXmlOriginal}),r&&await r(o.id),this.hide(),this.$emit("atualizar",{id:u,situacaoNfse:this.situacaoNfse})}catch(n){$q.notifyError(n.message)}},voltar(r){r.stopPropagation();let e=$utils.diferencaObjetos(this.nfseOriginal,this.nfse);if(!Object.keys(e).length){this.hide();return}$q.dialog({message:"Deseja descartar as modifica\xE7\xF5es?",title:"Descartar",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.hide()})},hide(){this.showModal=!1},setarValorLiquidoNfse(){const{valorServicos:r,valorPis:e,valorCofins:u,valorInss:t,valorIr:o,valorCsll:c,descontoIncondicionado:n,descontoCondicionado:m}=this.nfse.servico.valores,s=r-e-u-t-o-c-n-m;this.nfse.servico.valores.valorLiquidoNfse=s},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)}},beforeMount(){this.opcoesNatureza=C.opcoesNatureza,this.opcoesTipoRps=C.opcoesTipoRps,this.opcoesRegimeEspecialTributacao=C.opcoesRegimeEspecialTributacao,this.opcoesStatusRps=C.opcoesStatusRps,this.opcoesSimNao=C.opcoesSimNao,this.telefoneTipos=C.telefoneTipos,this.opcoesUF=C.opcoesUF},watch:{"nfse.servico.valores.valorServicos":function(){const{valorServicos:r,descontoIncondicionado:e}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=r-e,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoIncondicionado":function(){const{valorServicos:r,descontoIncondicionado:e}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=r-e,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoCondicionado":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorPis":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCofins":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorInss":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorIr":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCsll":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.baseCalculo":async function(){const{baseCalculo:r,aliquota:e}=this.nfse.servico.valores,u=$utils.arredondar(r*(e/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const o=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(o==null?void 0:o.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(u)),t&&(this.nfse.servico.valores.valorIss=parseFloat(u.toFixed(2)))},"nfse.servico.valores.aliquota":async function(){const{baseCalculo:r,aliquota:e}=this.nfse.servico.valores,u=$utils.arredondar(r*(e/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const o=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(o==null?void 0:o.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(u)),t&&(this.nfse.servico.valores.valorIss=parseFloat(u.toFixed(2)))}}},oo={class:"layout-padding q-my-lg"},eo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Informa\xE7\xF5es da Nota Fiscal Eletr\xF4nica ",-1),so={class:"row q-col-gutter-x-sm q-px-none q-mb-md"},lo={class:"col-12 col-md-2"},io={class:"col-12 col-md-2"},ao={class:"col-12 col-md-1"},no={class:"col-12 col-md-1"},to={class:"col-12 col-md-3"},ro={class:"col-12 col-md-3"},co={class:"row q-col-gutter-x-sm q-px-none q-mb-md"},uo={class:"col-12 col-md-6"},mo={class:"col-12 col-md-6"},fo={class:"row q-col-gutter-x-sm q-px-none"},po={class:"col-12 col-md-4"},vo={class:"col-12 col-md-4"},ho={class:"col-12 col-md-4"},Vo={class:"col-12 col-md-6"},bo={class:"row"},go={class:"col-12"},qo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," RPS Substitu\xEDdo ",-1),Co={class:"row q-col-gutter-x-sm q-px-none"},No={class:"col-6"},_o={class:"col-6"},So={class:"row q-col-gutter-x-sm q-px-none"},Ro={class:"col-12"},yo={class:"row"},wo={class:"col-12"},xo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Prestador ",-1),Eo={class:"row q-col-gutter-x-sm q-px-none"},Io={class:"col-12 col-md-6"},Uo={class:"col-12 col-md-6"},Fo={class:"row q-col-gutter-x-sm q-px-none"},Oo={class:"col-12"},Lo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Tomador ",-1),ko={class:"row q-col-gutter-x-sm q-px-none mb-2"},Do={class:"col-12"},To={class:"row q-col-gutter-x-sm q-px-none"},zo={class:"col-12 col-md-6"},Qo={class:"col-12 col-md-6"},Ao={class:"row q-col-gutter-x-sm q-px-none q-mb-md"},jo={class:"col-12 col-md-6"},Mo={class:"col-12 col-md-6"},Ho={class:"col-12 col-md-6"},Po={class:"col-12 col-md-6"},Jo={class:"col-12 col-md-6"},Bo={class:"col-12 col-md-6"},Xo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Constru\xE7\xE3o Civil ",-1),Ko={class:"row q-px-none q-col-gutter-x-sm"},Go={class:"col-12 col-md-6"},Wo={class:"col-12 col-md-6"},Yo=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Discrimina\xE7\xE3o dos Servi\xE7os ",-1),Zo={class:"row q-px-none"},$o={class:"col"},oe=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Informa\xE7\xF5es de servi\xE7os ",-1),ee={class:"row q-col-gutter-x-sm q-px-none"},se={class:"col-12 col-md-4"},le={class:"col-12 col-sm-6 col-md-3"},ie={class:"col-12 col-md-2"},ae={class:"col-12 col-md-2"},ne={class:"col-12 col-md-2"},te={class:"col-12 col-md-2"},re=i("p",{class:"q-item-label q-mb-none",style:{color:"#0c0c0c"}}," Valores ",-1),ce={class:"row q-col-gutter-x-sm q-px-none"},ue={class:"col-12 col-sm-6 col-md-3"},de={class:"col-12 col-sm-6 col-md-3"},me={class:"col-12 col-sm-6 col-md-3"},fe={class:"col-12 col-sm-6 col-md-3"},pe={class:"col-12 col-sm-6 col-md-3"},ve={class:"col-12 col-sm-6 col-md-3"},he={class:"col-12 col-sm-6 col-md-3"},Ve={class:"col-12 col-sm-6 col-md-3"},be={class:"col-12 col-sm-6 col-md-3"},ge={class:"col-12 col-sm-6 col-md-3"},qe={class:"col-12 col-sm-6 col-md-3"},Ce={class:"col-12 col-sm-6 col-md-3"},Ne={class:"col-12 col-sm-6 col-md-3"};function _e(r,e,u,t,o,c){const n=O("campo"),m=O("JsonViewer");return g(),q(Y,{modelValue:o.showModal,"onUpdate:modelValue":e[48]||(e[48]=s=>o.showModal=s),onKeyup:W(c.voltar,["esc"]),onHide:c.onHide,maximized:"",persistent:""},{default:a(()=>[l(z,{view:"hHh LpR fFf",container:"",class:"bg-light"},{default:a(()=>[l(Q,null,{default:a(()=>[l(d,null,{default:a(()=>[l(S,{dense:"",flat:"",icon:"arrow_back",round:"",onClick:c.voltar},null,8,["onClick"]),l(R,null,{default:a(()=>[V("NFS-e")]),_:1}),o.situacaoNfse==="Rascunho"?(g(),q(S,{key:0,onClick:e[0]||(e[0]=s=>c.salvar()),label:"Salvar",color:"white","text-color":"primary",unelevated:""})):y("",!0),r.$db.usuario.desenvolvedor()?(g(),q(S,{key:1,icon:"more_vert",round:"",flat:"",class:"q-ml-sm"},{default:a(()=>[l(A,null,{default:a(()=>[j((g(),q(M,{onClick:e[1]||(e[1]=s=>c.mostrarJsonViewer()),clickable:""},{default:a(()=>[l(L,{avatar:""},{default:a(()=>[l(H,{name:"mdi-file-replace",size:"sm"})]),_:1}),l(L,null,{default:a(()=>[V("Ver Objeto")]),_:1})]),_:1})),[[P]])]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1}),l(J,null,{default:a(()=>[l(B,{class:"u-container"},{default:a(()=>[i("div",oo,[o.nfse.mensagemDeRetorno?(g(),q(f,{key:0,class:"q-py-lg bg-white q-pa-md no-border no-shadow"},{default:a(()=>[l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[l(X,{class:"q-col-12 text-white bg-red"},{default:a(()=>[V(w(o.nfse.mensagemDeRetorno),1)]),_:1})]),_:1})]),_:1})):y("",!0),l(K,{ref:"nfseForm",class:"q-py-lg"},{default:a(()=>[l(f,{class:"bg-white q-pa-md no-border no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[eo]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",so,[i("div",lo,[l(b,{label:"N\xFAmero do Lote",modelValue:o.nfse.numeroLote,"onUpdate:modelValue":e[2]||(e[2]=s=>o.nfse.numeroLote=s),readonly:"",dense:""},null,8,["modelValue"])]),i("div",io,[l(b,{label:"N\xFAmero do RPS",modelValue:o.nfse.identificacaoRps.numero,"onUpdate:modelValue":[e[3]||(e[3]=s=>o.nfse.identificacaoRps.numero=s),e[4]||(e[4]=()=>{o.nfse.numeroLote=o.nfse.identificacaoRps.numero})],readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),i("div",ao,[l(b,{label:"Serie do RPS",modelValue:o.nfse.identificacaoRps.serie,"onUpdate:modelValue":e[5]||(e[5]=s=>o.nfse.identificacaoRps.serie=s),readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),i("div",no,[l(v,{modelValue:o.nfse.identificacaoRps.tipo,"onUpdate:modelValue":e[6]||(e[6]=s=>o.nfse.identificacaoRps.tipo=s),options:o.opcoesTipoRps,label:"Tipo RPS",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),i("div",to,[l(n,{rotulo:"Data de emiss\xE3o NFS-e",tipo:"dataHora",modelValue:o.nfse.dataEmissao,"onUpdate:modelValue":e[7]||(e[7]=s=>o.nfse.dataEmissao=s),"somente-leitura":""},null,8,["modelValue"])]),i("div",ro,[l(n,{rotulo:"Data de cria\xE7\xE3o RPS",tipo:"dataHora",modelValue:o.nfse.dataHoraCriacao,"onUpdate:modelValue":e[8]||(e[8]=s=>o.nfse.dataHoraCriacao=s),"somente-leitura":""},null,8,["modelValue"])])]),i("div",co,[i("div",uo,[l(v,{modelValue:o.nfse.naturezaOperacao,"onUpdate:modelValue":e[9]||(e[9]=s=>o.nfse.naturezaOperacao=s),options:o.opcoesNatureza,label:"Natureza da Opera\xE7\xE3o",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),i("div",mo,[l(v,{modelValue:o.nfse.regimeEspecialTributacao,"onUpdate:modelValue":e[10]||(e[10]=s=>o.nfse.regimeEspecialTributacao=s),options:o.opcoesRegimeEspecialTributacao,label:"Regime Especial Tributa\xE7\xE3o",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])])]),i("div",fo,[i("div",po,[l(v,{modelValue:o.nfse.status,"onUpdate:modelValue":e[11]||(e[11]=s=>o.nfse.status=s),options:o.opcoesStatusRps,label:"Status",rules:[s=>!!s||"Campo Obrigat\xF3rio"],readonly:"","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","rules"])]),i("div",vo,[l(v,{modelValue:o.nfse.optanteSimplesNacional,"onUpdate:modelValue":e[12]||(e[12]=s=>o.nfse.optanteSimplesNacional=s),options:o.opcoesSimNao,label:"Optante Simples Nacional",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),i("div",ho,[l(v,{modelValue:o.nfse.incentivadorCultural,"onUpdate:modelValue":e[13]||(e[13]=s=>o.nfse.incentivadorCultural=s),options:o.opcoesSimNao,label:"Incentivador Cultural",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])])])]),_:1})]),_:1}),i("div",Vo,[l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[i("div",bo,[i("div",go,[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[qo,l(R,null,{default:a(()=>[V("\xA0")]),_:1})]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",Co,[i("div",No,[l(n,{rotulo:"N\xFAmero do RPS",modelValue:o.nfse.numeroRPSSubstituido,"onUpdate:modelValue":e[14]||(e[14]=s=>o.nfse.numeroRPSSubstituido=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",_o,[l(n,{rotulo:"Protocolo de retorno",modelValue:o.nfse.protocoloRetorno,"onUpdate:modelValue":e[15]||(e[15]=s=>o.nfse.protocoloRetorno=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])])])]),_:1})])])]),_:1})]),i("div",So,[i("div",Ro,[l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[i("div",yo,[i("div",wo,[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[xo,l(R,null,{default:a(()=>[V("\xA0")]),_:1})]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",Eo,[i("div",Io,[l(n,{rotulo:"CNPJ",modelValue:o.nfse.prestador.documento,"onUpdate:modelValue":e[16]||(e[16]=s=>o.nfse.prestador.documento=s),"somente-leitura":"",rules:[s=>!!s||"Campo Obrigat\xF3rio"]},null,8,["modelValue","rules"])]),i("div",Uo,[l(n,{rotulo:"Inscri\xE7\xE3o Municipal",modelValue:o.nfse.prestador.inscricaoMunicipal,"onUpdate:modelValue":e[17]||(e[17]=s=>o.nfse.prestador.inscricaoMunicipal=s),rules:[s=>!!s||"Campo Obrigat\xF3rio"],"somente-leitura":""},null,8,["modelValue","rules"])])])]),_:1})])])]),_:1})])]),i("div",Fo,[i("div",Oo,[l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[Lo,l(R,null,{default:a(()=>[V("\xA0")]),_:1})]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",ko,[i("div",Do,[l(n,{modelValue:o.nfse.tomador.razaoSocial,"onUpdate:modelValue":e[18]||(e[18]=s=>o.nfse.tomador.razaoSocial=s),rotulo:"Selecione o Tomador",before:[{icon:"search",handler:c.abrirModalTomador}],"somente-leitura":""},null,8,["modelValue","before"])])]),i("div",To,[i("div",zo,[l(n,{rotulo:"Nome/Raz\xE3o Social",modelValue:o.nfse.tomador.razaoSocial,"onUpdate:modelValue":e[19]||(e[19]=s=>o.nfse.tomador.razaoSocial=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Qo,[l(n,{rotulo:"CNPJ/CPF",modelValue:o.nfse.tomador.documento,"onUpdate:modelValue":e[20]||(e[20]=s=>o.nfse.tomador.documento=s),"somente-leitura":""},null,8,["modelValue"])])]),i("div",Ao,[i("div",jo,[l(b,{label:"CEP",modelValue:o.nfse.tomador.endereco.cep,"onUpdate:modelValue":e[21]||(e[21]=s=>o.nfse.tomador.endereco.cep=s),readonly:o.situacaoNfse!=="Rascunho",mask:"#####-###",dense:""},null,8,["modelValue","readonly"])]),i("div",Mo,[l(n,{rotulo:"Rua",modelValue:o.nfse.tomador.endereco.rua,"onUpdate:modelValue":e[22]||(e[22]=s=>o.nfse.tomador.endereco.rua=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Ho,[l(n,{rotulo:"Numero",modelValue:o.nfse.tomador.endereco.numero,"onUpdate:modelValue":e[23]||(e[23]=s=>o.nfse.tomador.endereco.numero=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Po,[l(n,{rotulo:"Bairro",modelValue:o.nfse.tomador.endereco.bairro,"onUpdate:modelValue":e[24]||(e[24]=s=>o.nfse.tomador.endereco.bairro=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Jo,[l(b,{label:"Cidade (C\xF3digo Municipal)",modelValue:o.nfse.tomador.endereco.cidade,"onUpdate:modelValue":e[25]||(e[25]=s=>o.nfse.tomador.endereco.cidade=s),readonly:o.situacaoNfse!=="Rascunho",mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly"])]),i("div",Bo,[l(v,{label:"UF",modelValue:o.nfse.tomador.endereco.estado,"onUpdate:modelValue":e[26]||(e[26]=s=>o.nfse.tomador.endereco.estado=s),options:o.opcoesUF,readonly:o.situacaoNfse!=="Rascunho",dense:""},null,8,["modelValue","options","readonly"])])])]),_:1})]),_:1})])]),l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[Xo]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",Ko,[i("div",Go,[l(n,{rotulo:"C\xF3digo de Obra",modelValue:o.nfse.codigoObra,"onUpdate:modelValue":e[27]||(e[27]=s=>o.nfse.codigoObra=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Wo,[l(n,{rotulo:"C\xF3digo ART",modelValue:o.nfse.codigoART,"onUpdate:modelValue":e[28]||(e[28]=s=>o.nfse.codigoART=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])])])]),_:1})]),_:1}),l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[Yo]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",Zo,[i("div",$o,[l(n,{rotulo:"Discrimina\xE7\xE3o dos Servi\xE7os",modelValue:o.nfse.servico.discriminacao,"onUpdate:modelValue":e[29]||(e[29]=s=>o.nfse.servico.discriminacao=s),tipo:"textoArea",rows:"2","somente-leitura":o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"]},null,8,["modelValue","somente-leitura","rules"])])])]),_:1})]),_:1}),l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[oe]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",ee,[i("div",se,[i("div",le,[l(v,{modelValue:o.nfse.servico.itemListaServico,options:o.opcoesInformacoesServicos,"option-value":s=>s.codigo,"option-label":s=>s?s.descricao:"",readonly:o.situacaoNfse!=="Rascunho",label:"Servi\xE7os","emit-value":"","map-options":"",dense:"","onUpdate:modelValue":c.trocouServico},null,8,["modelValue","options","option-value","option-label","readonly","onUpdate:modelValue"])])]),i("div",ie,[l(b,{label:"C\xF3digo de Item da Lista de Servi\xE7o",modelValue:o.nfse.servico.itemListaServico,"onUpdate:modelValue":e[30]||(e[30]=s=>o.nfse.servico.itemListaServico=s),readonly:"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],dense:""},null,8,["modelValue","rules"])]),i("div",ae,[l(b,{label:"C\xF3digo CNAE",modelValue:o.nfse.servico.codigoCnae,"onUpdate:modelValue":e[31]||(e[31]=s=>o.nfse.servico.codigoCnae=s),readonly:"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],dense:""},null,8,["modelValue","rules"])]),i("div",ne,[l(b,{label:"C\xF3digo de Tributa\xE7\xE3o",modelValue:o.nfse.servico.codigoTributacaoMunicipio,"onUpdate:modelValue":e[32]||(e[32]=s=>o.nfse.servico.codigoTributacaoMunicipio=s),readonly:"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],dense:""},null,8,["modelValue","rules"])]),i("div",te,[i("div",{class:"col",onClick:e[34]||(e[34]=(...s)=>r.carregarEquipamentos&&r.carregarEquipamentos(...s))},[l(n,{modelValue:o.nfse.servico.municipioPrestacaoServico,"onUpdate:modelValue":e[33]||(e[33]=s=>o.nfse.servico.municipioPrestacaoServico=s),opcoes:o.opcoesCidadeIbge,tipo:"seletor",rotulo:"C\xF3digo Munic\xEDpio IBGE"},null,8,["modelValue","opcoes"])])])])]),_:1})]),_:1}),l(f,{class:"bg-white q-pa-md no-border q-mt-md no-shadow"},{default:a(()=>[l(d,{class:"q-pa-none q-ma-none",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:a(()=>[re]),_:1}),l(p,{class:"q-px-none q-pb-none"},{default:a(()=>[i("div",ce,[i("div",ue,[l(v,{modelValue:o.nfse.servico.valores.issRetido,"onUpdate:modelValue":e[35]||(e[35]=s=>o.nfse.servico.valores.issRetido=s),options:o.opcoesSimNao,label:"ISS Retido",readonly:o.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),i("div",de,[l(n,{rotulo:"Valor dos Servi\xE7os",modelValue:o.nfse.servico.valores.valorServicos,"onUpdate:modelValue":e[36]||(e[36]=s=>o.nfse.servico.valores.valorServicos=s),decimals:"4",value:"0",prefix:"R$",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",me,[l(n,{rotulo:"Valor PIS",modelValue:o.nfse.servico.valores.valorPis,"onUpdate:modelValue":e[37]||(e[37]=s=>o.nfse.servico.valores.valorPis=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",fe,[l(n,{rotulo:"Valor COFINS",modelValue:o.nfse.servico.valores.valorCofins,"onUpdate:modelValue":e[38]||(e[38]=s=>o.nfse.servico.valores.valorCofins=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",pe,[l(n,{rotulo:"Valor INSS",modelValue:o.nfse.servico.valores.valorInss,"onUpdate:modelValue":e[39]||(e[39]=s=>o.nfse.servico.valores.valorInss=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",ve,[l(n,{rotulo:"Valor IR",modelValue:o.nfse.servico.valores.valorIr,"onUpdate:modelValue":e[40]||(e[40]=s=>o.nfse.servico.valores.valorIr=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",he,[l(n,{rotulo:"Valor CSLL",modelValue:o.nfse.servico.valores.valorCsll,"onUpdate:modelValue":e[41]||(e[41]=s=>o.nfse.servico.valores.valorCsll=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Ve,[l(n,{rotulo:"Valor ISS",modelValue:o.nfse.servico.valores.valorIss,"onUpdate:modelValue":e[42]||(e[42]=s=>o.nfse.servico.valores.valorIss=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":""},null,8,["modelValue"])]),i("div",be,[l(n,{rotulo:"Base Calculo",modelValue:o.nfse.servico.valores.baseCalculo,"onUpdate:modelValue":e[43]||(e[43]=s=>o.nfse.servico.valores.baseCalculo=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":""},null,8,["modelValue"])]),i("div",ge,[l(n,{rotulo:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal",modelValue:o.nfse.servico.valores.aliquota,"onUpdate:modelValue":e[44]||(e[44]=s=>o.nfse.servico.valores.aliquota=s),"somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",qe,[l(n,{rotulo:"Valor Liquido Nfse",modelValue:o.nfse.servico.valores.valorLiquidoNfse,"onUpdate:modelValue":e[45]||(e[45]=s=>o.nfse.servico.valores.valorLiquidoNfse=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":""},null,8,["modelValue"])]),i("div",Ce,[l(n,{rotulo:"Desconto Condicionado",modelValue:o.nfse.servico.valores.descontoCondicionado,"onUpdate:modelValue":e[46]||(e[46]=s=>o.nfse.servico.valores.descontoCondicionado=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),i("div",Ne,[l(n,{rotulo:"Desconto Incondicionado",modelValue:o.nfse.servico.valores.descontoIncondicionado,"onUpdate:modelValue":e[47]||(e[47]=s=>o.nfse.servico.valores.descontoIncondicionado=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])])])]),_:1})]),_:1})]),_:1},512)])]),_:1})]),_:1}),l(G,{class:"bg-light",bordered:""},{default:a(()=>[l(d,{class:"bg-light text-tertiary q-pa-sm u-container"},{default:a(()=>[l(R,null,{default:a(()=>{var s,N,_;return[V(" Total "),i("strong",null,"R$ "+w(r.$filters.numero((_=(N=(s=o.nfse.servico)==null?void 0:s.valores)==null?void 0:N.valorServicos)!=null?_:0,2)),1),V(" --- "+w(o.situacaoNfse)+" --- ",1)]}),_:1}),l(Z),~["Rascunho"].indexOf(o.situacaoNfse)?(g(),q(S,{key:0,onClick:c.emitir,label:"Emitir",color:"primary",unelevated:"",class:"q-ml-sm float-right"},null,8,["onClick"])):y("",!0),~["Protocolada"].indexOf(o.situacaoNfse)?(g(),q(S,{key:1,onClick:c.emitir,label:"Checar envio",color:"primary",unelevated:"",class:"q-ml-sm float-right"},null,8,["onClick"])):y("",!0)]),_:1})]),_:1}),l(m,{ref:"jsonViewer"},null,512)]),_:1})]),_:1},8,["modelValue","onKeyup","onHide"])}var xe=D($,[["render",_e]]);export{xe as n};
