import{_ as K,N as X,b1 as W,M as $,cg as F,ch as L,Y as A,ci as M,cj as ee,Z as oe,ck as S,p as V,o as n,i as p,w as o,f as e,K as te,G as ae,A as le,B as Q,C as Y,D as I,L as Z,E,e as d,H as se,t as m,d as y,l as u,k as q,aF as J,ai as T,F as D,r as P,aj as w,ak as f,ah as C,s as G,x as c,j as b,am as H,I as ie,y as ne,aE as N,aA as j,T as O,q as B}from"./index.2840a24b.js";import{l as re}from"./listaV3.7a814258.js";import{C as de}from"./Campo.6b70276b.js";import{P as ce}from"./PromptContatoV2.39a5f823.js";import"./QBtnDropdown.ec9c3d45.js";import"./QBtnGroup.98eac65a.js";import"./QSpace.875dcce3.js";import"./QDate.64684ec3.js";import"./QPopupEdit.4ef1bd29.js";import"./xlsx.881700fc.js";const ue={components:{Badge:X,Campo:de,PromptItemV2:W,Avatar:$,PromptContatoV2:ce},data(){return{cliente:{},emitente:{},diaVencimento:"",documentoAnterior:{},documentoItensAnterior:[],documento:{id:F(),dataHoraEmissao:L(),numero:"",descricaoContato:"",idContato:"",descricaoEmpresa:"",idEmpresa:"",numeroVolumeTransporte:"",status:"Ativo",tipo:"Contrato"},documentoItens:[],totalItens:0,visibilidade:{modal:!1},itensModal:!1,carregando:!0,contatosModal:!1,emitenteModal:!1,empresas:[],configImpressaoContrato:[]}},emits:["atualizar"],methods:{async atualizar(a){if(a=a!=null?a:this.$route.params.id,a)this.documentoAnterior=await A.contrato.le({id:a}),this.documento=M(this.documentoAnterior),this.documentoItensAnterior=await A.itemManipulacao.leItens({idDocumento:a}),this.documentoItens=M(this.documentoItensAnterior),this.cliente.id=this.documento.idContato,this.cliente.nome=this.documento.descricaoContato,this.emitente.id=this.documento.idEmpresa,this.emitente.nome=this.documento.descricaoEmpresa,this.diaVencimento=this.documento.numeroVolumeTransporte;else{this.limparCampos();const v=await $g.promptContato.show({filtro:{ativo:!0,empresas:!0},placeholder:"Selecione"});this.emitente=M(v),this.documento.idEmpresa=this.emitente.id,this.documento.descricaoEmpresa=this.emitente.nome}const i=await A.item.ler();this.itens=i.data,this.empresas=await A.empresa.le(),this.somarValorTotal(),this.configuraImpressaoContrato(this.documento.idEmpresa)},async mostrar(){await ee(500),this.carregando=!1},async configuraImpressaoContrato(a){const i=await A.configuracoes.porNome("impressao.contrato",a);this.configImpressaoContrato=i},fechar(){this.$router.replace({params:{id:""}}),this.carregando=!0},limparCampos(){this.documentoAnterior={},this.documento={id:F(),dataHoraEmissao:L(),numero:"",descricaoContato:"",idContato:"",descricaoEmpresa:"",idEmpresa:"",numeroVolumeTransporte:"",status:"Ativo",tipo:"Contrato"},this.documentoItensAnterior=[],this.documentoItens=[],this.cliente.id="",this.cliente.nome="",this.emitente.id="",this.emitente.nome="",this.diaVencimento=""},async abrirModal(a=""){let i={},v=[];a?v=this.documentoItens.filter(h=>h.idItem===a):v=this.documentoItens;for(const h of v)i[h.idItem]={item:await oe().item.get(h.idItem)||{},quantidade:h.quantidade};this.$refs.promptItem.itensSelecionados=i,this.$refs.promptItem.termo=a,this.$refs.promptItem.atualizar(),this.itensModal=!0},recalcularTotal(a){a.subTotal=S(a.quantidade*a.valorItem),a.total=S(a.quantidade*a.valorItem),this.somarValorTotal()},async selecionarCliente(){if(this.documento.status!=="Cancelado"){const a=await $g.promptContato.show({filtro:{ativo:!0},placeholder:"Selecione"});this.cliente=M(a),this.contatosModal=!1,this.documento.idContato=this.cliente.id,this.documento.descricaoContato=this.cliente.nome}},async selecionarEmitente(a,i){if(!a){this.emitenteModal=!1;return}this.emitente=M(i),this.emitenteModal=!1,this.documento.idEmpresa=this.emitente.id,this.documento.descricaoEmpresa=this.emitente.nome},aoSelecionarVencimento(){this.documento.numeroVolumeTransporte=this.diaVencimento},selecionarItens:function(a){for(const i in a){const v=a[i].item||{},h=a[i].quantidade||0;let t=this.documentoItens.find(r=>r.idItem===i);t?(t.quantidade=h,t.quantidadeRealizado=h,t.total=S(h*v.valorVenda)):this.documentoItens.push({dataHoraEmissao:L(),descricaoItem:v.descricao,id:F(),idDocumento:this.documento.id,idItem:v.id,operacao:"-",quantidade:h,unidade:v.unidade,quantidadeRealizado:h,tipoItem:v.tipo,total:S(h*v.valorVenda),valorItem:v.valorVenda})}this.somarValorTotal()},somarValorTotal(){this.totalItens=this.documentoItens.reduce((a,i)=>a+=i.total,0)},excluirItem(a){this.documentoItens=this.documentoItens.filter(i=>i.id!==a),this.somarValorTotal()},validaDia(){if(this.diaVencimento<1||this.diaVencimento>28){this.$q.notifyAlert("O dia deve ser um valor entre 1 e 28"),this.diaVencimento="";return}this.aoSelecionarVencimento()},async gravar(a=!1){if(console.log("gravar"),console.log(this.cliente),console.log(this.emitente),!this.cliente.id){this.$q.notifyAlert("Selecione um Cliente");return}if(!this.emitente.id){this.$q.notifyAlert("Selecione um Emitente");return}if(!this.diaVencimento){this.$q.notifyAlert("Selecione um dia de Vencimento");return}if(!this.totalItens){this.$q.notifyAlert("Adicione alguns itens ao contrato");return}try{await A.contrato.grava({documentoAnterior:this.documentoAnterior,documento:this.documento,documentoItensAnterior:this.documentoItensAnterior,documentoItens:this.documentoItens}),this.visibilidade.modal=a,this.atualizar(this.documento.id),this.$emit("atualizar")}catch(i){this.$q.notifyError("Erro ao salvar",i)}},cancelar(){this.documento.status="Cancelado",this.documento.dataHoraFinalizado=L(),this.gravar(!0),$q.notifyPositive("Contrato Cancelado")},ativar(){this.documento.status="Ativo",this.documento.dataHoraFinalizado="",this.gravar(!0),$q.notifyPositive("Contrato Reativado")}},async created(){console.log("created")}},me={key:0},pe={key:3},fe={ref:"form"},he={class:"col-12 col-md"},ve={class:"col-auto"},_e={class:"col"},ye={class:"col-12 col-md"},Ce={class:"col-auto"},ge={class:"col"},Ie={class:"col-12 col-md"},be=c("div",{class:"col-2 col-md"},"C\xF3digo",-1),Ve=c("div",{class:"col-10 col-md-4"},"Descri\xE7\xE3o",-1),ke=c("div",{class:"col-6 col-md text-right"},"Quantidade",-1),we=c("div",{class:"col-6 col-md text-right"},"Valor",-1),qe=c("div",{class:"col-6 col-md text-right"},"Total",-1),xe=c("div",{class:"col-6 col-md-1 text-right"},"A\xE7\xF5es",-1),Ae={class:"col-2 col-md"},ze={class:"col-10 col-md-4"},Me={class:"col-6 col-md text-right row"},De={class:"col-2"},Le={class:"col-6 col-md text-right"},Se={class:"col-6 col-md text-right"},Ee={class:"col-6 col-md-1 text-right"},Te=c("div",{class:"col-2 col-md"},null,-1),Pe=c("div",{class:"col-10 col-md-4"},null,-1),Ue=c("div",{class:"col-6 col-md text-right"},null,-1),Fe=c("div",{class:"col-6 col-md text-right"},null,-1),Qe={class:"col-6 col-md text-right"},Be=c("div",{class:"col-6 col-md-1 text-right"},"\xA0",-1),He={class:"u-container relative-position"};function Re(a,i,v,h,t,r){const _=V("badge"),k=V("avatar"),g=V("campo"),x=V("row"),U=V("PromptItemV2"),l=V("PromptContatoV2");return n(),p(ne,{modelValue:t.visibilidade.modal,"onUpdate:modelValue":i[10]||(i[10]=s=>t.visibilidade.modal=s),maximized:"",onShow:r.mostrar,onHide:r.fechar},{default:o(()=>[e(te,{class:"bg-light",container:""},{default:o(()=>[e(ae,{class:"u-container"},{default:o(()=>[e(le,null,{default:o(()=>[e(Q,null,{default:o(()=>[Y(e(I,{dense:"",flat:"",icon:"arrow_back",round:""},null,512),[[Z]]),e(E,null,{default:o(()=>[d("Contrato")]),_:1}),e(I,{class:"no-shadow",unelevated:"",color:"white","text-color":"primary",label:"Salvar",onClick:i[0]||(i[0]=s=>r.gravar(!1))})]),_:1})]),_:1}),e(se,null,{default:o(()=>[e(Q,{class:"q-pa-none q-ma-none q-my-md",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:o(()=>[e(E,{class:"text-black q-px-none text-body2"},{default:o(()=>[d("Emiss\xE3o: "+m(a.$filters.data(t.documento.dataHoraEmissao))+" ",1),t.documento.dataHoraFinalizado?(n(),y("span",me,"Cancelamento: "+m(a.$filters.data(t.documento.dataHoraFinalizado)),1)):u("",!0)]),_:1}),t.documento.status==="Ativo"?(n(),p(_,{key:0,cor:"positive",class:"q-mx-sm",icone:"flag",escuro:""},{default:o(()=>[d(m(t.documento.status),1)]),_:1})):u("",!0),t.documento.status==="Cancelado"?(n(),p(_,{key:1,cor:"negative",class:"q-mx-xs",icone:"flag",escuro:""},{default:o(()=>[d(m(t.documento.status),1)]),_:1})):u("",!0),t.documento.numero?(n(),p(_,{key:2,cor:"tertiary",escuro:"",icone:"playlist_add_check",class:"q-mx-xs"},{default:o(()=>[d(" #"+m(t.documento.numero)+" ",1),t.documento.codigoDocumento?(n(),p(q,{key:0},{default:o(()=>[d("C\xF3digo: "+m(t.documento.codigoDocumento),1)]),_:1})):u("",!0)]),_:1})):u("",!0),t.documento.numero?(n(),y("div",pe,[t.configImpressaoContrato.length>1?(n(),p(I,{key:0,class:"q-ml-xs",color:"primary",icon:"print",flat:"",dense:"",round:""},{default:o(()=>[e(J,{self:"top middle",anchor:"bottom middle"},{default:o(()=>[e(T,{link:"",separator:""},{default:o(()=>[(n(!0),y(D,null,P(t.configImpressaoContrato.filter(s=>s.valor),s=>(n(),p(w,{key:s.valor,onClick:R=>a.$imprimir(s.valor,{id:(t.documento||{}).id||"0",Oculto:"0"})},{default:o(()=>[e(f,{icon:"print"}),e(C,{label:s.texto},null,8,["label"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})):(n(),p(I,{key:1,class:"q-ml-xs",color:"primary",icon:"print",flat:"",dense:"",round:"",onClick:i[1]||(i[1]=s=>a.$imprimir(t.configImpressaoContrato[0].valor,{id:(t.documento||{}).id||"0",Oculto:"0"}))}))])):u("",!0)]),_:1}),e(G,{class:"bg-white q-pa-md q-mt-md no-shadow"},{default:o(()=>[c("form",fe,[e(x,{class:"q-col-gutter-sm"},{default:o(()=>[c("div",he,[e(x,null,{default:o(()=>[c("div",ve,[e(k,{imagem:t.emitente.imagem,rotulo:t.emitente.nome,tamanho:"30",style:{float:"left"},class:"q-mr-sm"},null,8,["imagem","rotulo"])]),c("div",_e,[e(g,{rotulo:"Emitente",tipo:"texto",class:"col-10",modelValue:t.emitente.nome,"onUpdate:modelValue":i[2]||(i[2]=s=>t.emitente.nome=s),disable:""},null,8,["modelValue"])])]),_:1})]),c("div",ye,[e(x,null,{default:o(()=>[c("div",Ce,[e(k,{imagem:t.cliente.imagem,rotulo:t.cliente.nome,tamanho:"30",style:{float:"left"},class:"q-mr-sm"},null,8,["imagem","rotulo"])]),c("div",ge,[e(g,{placeholder:"Cliente",rotulo:"Cliente",tipo:"texto",after:[{icon:"edit",handler(){r.selecionarCliente()}}],modelValue:t.cliente.nome,"onUpdate:modelValue":[i[3]||(i[3]=s=>t.cliente.nome=s),a.aoSelecionarCliente],onClick:r.selecionarCliente,somenteLeitura:t.documento.status==="Cancelado"},null,8,["after","modelValue","onClick","onUpdate:modelValue","somenteLeitura"])])]),_:1})]),c("div",Ie,[e(g,{class:"col-12 col-md",rotulo:"Dia de Vencimento",modelValue:t.diaVencimento,"onUpdate:modelValue":i[4]||(i[4]=s=>t.diaVencimento=s),opcoes:{minimumValue:1,maximumValue:28},placeholder:"Dia Vencimento",tipo:"numero",onBlur:r.validaDia,errorMessage:"Dia entre 1 e 28",error:t.diaVencimento>28||t.diaVencimento<1},null,8,["modelValue","onBlur","error"])])]),_:1})],512)]),_:1}),e(G,{class:"bg-white q-pa-md q-mt-md no-shadow"},{default:o(()=>[e(Q,{class:"q-pa-none q-ma-none q-mb-md",color:"none","text-color":"black",style:{"min-height":"auto"}},{default:o(()=>[e(b,{name:"shopping_cart",size:"24px",style:{color:"#737373"}}),e(E,null,{default:o(()=>[d(" Produtos e Servi\xE7os ")]),_:1}),t.documento.status!=="Cancelado"?(n(),p(I,{key:0,color:"positive",flat:"",dense:"",icon:"add",round:"",size:"md",onClick:i[5]||(i[5]=s=>r.abrirModal())},{default:o(()=>[e(q,null,{default:o(()=>[d("Adicionar Item")]),_:1})]),_:1})):u("",!0)]),_:1}),e(T,{class:"col-12 no-border q-mx-none q-pa-none"},{default:o(()=>[e(w,{class:"q-pa-none"},{default:o(()=>[e(f,null,{default:o(()=>[e(C,null,{default:o(()=>[e(x,{class:"q-col-gutter-md text-weight-bold text-left justify-around"},{default:o(()=>[be,Ve,ke,we,qe,xe]),_:1})]),_:1}),e(H,{class:"q-my-xs"}),(n(!0),y(D,null,P(t.documentoItens,(s,R)=>(n(),y(D,{key:R},[e(C,null,{default:o(()=>[e(x,{class:"q-col-gutter-md text-weight-bold text-left justify-around"},{default:o(()=>[c("div",Ae,m(s.codigoItem||"-"),1),c("div",ze,m(s.descricaoItem||"-"),1),c("div",Me,[e(g,{class:"col-10",modelValue:s.quantidade,"onUpdate:modelValue":z=>s.quantidade=z,tipo:"decimal",decimals:"4",onBlur:z=>r.recalcularTotal(s)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),c("span",De,m(s.unidade||"-"),1)]),c("div",Le,[e(g,{class:"col-10",modelValue:s.valorItem,"onUpdate:modelValue":z=>s.valorItem=z,tipo:"decimal",decimals:"4",onBlur:z=>r.recalcularTotal(s)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),c("div",Se,m(a.$filters.numero(s.total,2)),1),c("div",Ee,[e(I,{flat:"",dense:"",icon:"edit",round:"",size:"md",onClick:z=>r.abrirModal(s.idItem)},{default:o(()=>[e(q,null,{default:o(()=>[d("Editar")]),_:1})]),_:2},1032,["onClick"]),e(I,{flat:"",dense:"",icon:"delete",round:"",size:"md",onClick:z=>r.excluirItem(s.id)},{default:o(()=>[e(q,null,{default:o(()=>[d("Excluir")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024),e(H,{class:"q-my-xs"})],64))),128))]),_:1})]),_:1}),e(w,{class:"q-px-none"},{default:o(()=>[e(f,null,{default:o(()=>[e(C,null,{default:o(()=>[e(x,{class:"q-col-gutter-md text-weight-bold text-left justify-around"},{default:o(()=>[Te,Pe,Ue,Fe,c("div",Qe,m(a.$filters.numero(t.totalItens,2)),1),Be]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{class:"q-px-none"},{default:o(()=>[e(f,null,{default:o(()=>[e(C,{class:"text-center"},{default:o(()=>[e(I,{color:"positive",icon:"add",class:"q-mx-auto",label:"Adicionar item",outline:"",size:"xs",onClick:i[6]||(i[6]=s=>r.abrirModal())})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{modelValue:t.itensModal,"onUpdate:modelValue":i[7]||(i[7]=s=>t.itensModal=s),filtro:{ativo:!0,idEmpresa:t.documento.idEmpresa},onSelecionarItens:r.selecionarItens,habilitarQuantidade:!0,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"]),e(l,{modelValue:t.contatosModal,"onUpdate:modelValue":i[8]||(i[8]=s=>t.contatosModal=s),filtro:{ativo:!0},placeholder:"Seleciona o Cliente",onSelecionar:a.aoSelecionarCliente},null,8,["modelValue","onSelecionar"]),e(l,{modelValue:t.emitenteModal,"onUpdate:modelValue":i[9]||(i[9]=s=>t.emitenteModal=s),filtro:{ativo:!0,empresas:!0},placeholder:"Seleciona a empresa emitente",onSelecionar:r.selecionarEmitente},null,8,["modelValue","onSelecionar"])]),_:1}),e(ie,{class:"bg-light no-shadow q-pa-sm text-right",bordered:""},{default:o(()=>[c("div",He,[e(E,{class:"text-right"},{default:o(()=>[t.documento.status==="Cancelado"?(n(),p(I,{key:0,color:"primary",label:"Ativar",unelevated:"",onClick:r.ativar},null,8,["onClick"])):u("",!0),t.documento.status==="Ativo"?(n(),p(I,{key:1,class:"q-mx-md",color:"negative",flat:"",label:"Cancelar",onClick:r.cancelar},null,8,["onClick"])):u("",!0)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onShow","onHide"])}var Ge=K(ue,[["render",Re]]);const Ne={components:{lista:re,Badge:X,ContratoModal:Ge},data(){return{paginacao:{atual:1,minimo:1,maximo:1,total:1,limite:25},filtros:{tab:"Ativos",empresa:{selecionada:"",opcoes:[]},periodo:{emissao:{ini:"",fim:""},finalizado:{ini:"",fim:""}}},documentos:[],tabs:[{rotulo:"Ativos",value:"Ativos"},{rotulo:"Cancelados",value:"Cancelados"},{rotulo:"Todos",value:"Todos"}],tabSelecionada:{valor:"Ativos"},checkboxModel:!1,showAllPreviewDetail:!1,listaItensLayout:{},showFilters:!1,filtrosDrawer:{ativo:null,descricaoAplicacao:null,codIdRef:null,codigoBarras:null,marca:null,fornecedor:null,grupo:null,subGrupo:null,estoque:null,tipo:null,codigoCompra:null},buscaCampo:"",opcoesMarca:[],opcoesGrupo:[],opcoesSubGrupo:[],opcoesTipo:["Produto"]}},methods:{async criarContrato(){await this.$refs.contratoModal.atualizar(),this.$refs.contratoModal.visibilidade.modal=!0},selecionarTodosXCheckBox(){for(let a of this.listaItens)this.listaItensLayout[a.id].remover=this.checkboxModel},async abrirItem(a){this.$router.replace({params:{id:a}}),await this.$refs.contratoModal.atualizar(a),this.$refs.contratoModal.visibilidade.modal=!0},abrirTodosPreview(){if(this.showAllPreviewDetail=!this.showAllPreviewDetail,this.showAllPreviewDetail)for(let a in this.listaItensLayout)this.listaItensLayout[a].showPreviewDetail=!0,this.listaItensLayout[a].detalhes=!0;else for(let a in this.listaItensLayout)this.listaItensLayout[a].showPreviewDetail=!1,this.listaItensLayout[a].detalhes=!1},async showDetails(a){let i=await $db.registro.leItens({idDocumento:a.id});a.documentoItens=i,a.showAllPreviewDetail=!a.showAllPreviewDetail,a.detalhes=!a.detalhes,this.listaItensLayout[a.id].detalhes=!this.listaItensLayout[a.id].detalhes},async atualizar(){this.filtros.tab=this.tabSelecionada.valor;try{this.$q.loading.show();const a=this.paginacao.limite,i=this.paginacao.atual,v="descricao";let h="";this.filtros.tab==="Ativos"?h="Ativo":this.filtros.tab==="Cancelados"&&(h="Cancelado");let t=this.filtros.empresa.selecionada.value||"";this.filtros.idEmpresa=t;let r={};if(!this.buscaCampo){let _=this.$utils.eliminarVazios(this.filtros);_.status=h,r=await this.filtrarCampos(_,a,i,v)}for(let _ of r.data){let k=await $db.registro.leItens({idDocumento:_.id});_.documentoItens=k,_.totalContrato=k.map(function(g){return g.total}),this.listaItensLayout[_.id]={detalhes:!1,showPreviewDetail:!1,remover:!1}}this.documentos=M(r.data),this.paginacao.total=r.total,this.paginacao.maximo=r.totalPages}catch(a){this.$q.notifyError("Erro iniciar",a)}finally{this.$q.loading.hide()}},async filtrarCampos(a,i,v,h){return A.contrato.leRefatorado({filtros:a,limit:i,page:v,sort:h})},async gerarLoteNFSe(){await this.$q.dialog({title:"Gerar lote de NFS-e",message:"Deseja gerar as notas de servi\xE7o a partir dos contratos?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async()=>{await A.contrato.gerarNFSEapartirContrato(),$q.notifyPositive("Exporta\xE7\xE3o das notas finalizada.")}).onCancel(()=>{}).onDismiss(()=>{})}},created(){this.atualizar()},mounted(){this.$route.params.id&&this.$route.params.id.length&&this.abrirItem(this.$route.params.id)}},je={class:"row items-center"},Oe=["onClick"],Ke={key:0,class:"col-12"},Xe={key:1,class:"col-12"},Ye={class:"text-tertiary q-col-gutter-xs"},Ze={class:"col-12 col-lg"},Je={style:{"white-space":"pre-line"}},We=["onClick"],$e={key:0,class:"col-10 col-lg"},eo={key:1,class:"col-12 col-lg"},oo={key:2,class:"col-10 col-lg"},to={key:3,class:"col-12 col-lg-auto q-pt-md",style:{"min-width":"115px !important"}};function ao(a,i,v,h,t,r){const _=V("campo"),k=V("badge"),g=V("row"),x=V("lista"),U=V("ContratoModal");return n(),y("div",null,[e(x,{buscaCampo:t.buscaCampo,"onUpdate:buscaCampo":i[4]||(i[4]=l=>t.buscaCampo=l),checkboxModel:t.checkboxModel,"onUpdate:checkboxModel":i[5]||(i[5]=l=>t.checkboxModel=l),filtros:t.filtros,opcoesGrupo:t.opcoesGrupo,opcoesMarca:t.opcoesMarca,opcoesSubGrupo:t.opcoesSubGrupo,opcoesTipo:t.opcoesTipo,paginacao:t.paginacao,tabSelecionada:t.tabSelecionada,tabs:t.tabs,icone:"gavel",showAdd:"false",titulo:"Contratos",onAbrirTodosPreview:r.abrirTodosPreview,onCriar_click:r.criarContrato,onFiltro_change:r.atualizar},{menuExtras:o(()=>[e(w,{clickable:"",onClick:i[0]||(i[0]=l=>r.gerarLoteNFSe())},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(b,{name:"mdi-file-replace",size:"sm"})]),_:1}),e(f,null,{default:o(()=>[d("Gerar notas de servi\xE7o")]),_:1})]),_:1})]),filtroCampos:o(()=>[e(_,{modelValue:t.filtrosDrawer.descricaoAplicacao,"onUpdate:modelValue":i[1]||(i[1]=l=>t.filtrosDrawer.descricaoAplicacao=l),dense:"",rotulo:"Descri\xE7\xE3o/Aplica\xE7\xE3o"},null,8,["modelValue"]),e(_,{modelValue:t.filtrosDrawer.codIdRef,"onUpdate:modelValue":i[2]||(i[2]=l=>t.filtrosDrawer.codIdRef=l),dense:"",rotulo:"C\xF3digo/ID/Refer\xEAncia"},null,8,["modelValue"]),e(_,{modelValue:t.filtrosDrawer.codigoBarras,"onUpdate:modelValue":i[3]||(i[3]=l=>t.filtrosDrawer.codigoBarras=l),dense:"",rotulo:"C\xF3d. Barras"},null,8,["modelValue"])]),itemLista:o(()=>[e(T,{class:""},{default:o(()=>[(n(!0),y(D,null,P(t.documentos,l=>(n(),y(D,{key:l.id},[e(w,{class:"items-center d-flex q-pa-xs",clickable:""},{default:o(()=>[e(f,{avatar:"",center:"",class:"mw120 hideonmobile"},{default:o(()=>[c("div",je,[e(N,{modelValue:t.listaItensLayout[l.id].remover,"onUpdate:modelValue":s=>t.listaItensLayout[l.id].remover=s},null,8,["modelValue","onUpdate:modelValue"]),l.status==="Cancelado"?(n(),p(k,{key:0,class:"q-mr-sm hideonmobile",cor:"tertiary",escuro:""},{default:o(()=>[d(" #"+m((l.codigoDocumento||0).toString().padStart(3,"0")),1)]),_:2},1024)):(n(),p(k,{key:1,class:"q-mr-sm hideonmobile",cor:"positive",escuro:""},{default:o(()=>[d(" #"+m((l.codigoDocumento||0).toString().padStart(3,"0")),1)]),_:2},1024))])]),_:2},1024),e(f,{clickable:""},{default:o(()=>[e(g,{class:"items-center q-col-gutter-x-sm"},{default:o(()=>[e(N,{modelValue:t.listaItensLayout[l.id].remover,"onUpdate:modelValue":s=>t.listaItensLayout[l.id].remover=s,class:"q-ma-none q-pa-none hideondesktop"},null,8,["modelValue","onUpdate:modelValue"]),c("div",{class:"col",onClick:s=>r.abrirItem(l.id)},[l.descricaoContato?(n(),p(C,{key:0,class:"text-tertiary text-weight-bold"},{default:o(()=>[d(m(l.descricaoContato),1)]),_:2},1024)):u("",!0),e(g,{class:"hideondesktop items-center q-my-sm"},{default:o(()=>[l.dataHoraEmissao?(n(),y("div",Ke,[e(g,null,{default:o(()=>[e(b,{class:"text-tertiary",name:"today"}),e(C,null,{default:o(()=>[d(m(a.$filters.data(l.dataHoraEmissao)),1)]),_:2},1024),e(q,null,{default:o(()=>[d("Data Emiss\xE3o")]),_:1})]),_:2},1024)])):u("",!0),l.dataHoraFinalizado?(n(),y("div",Xe,[e(g,null,{default:o(()=>[e(b,{class:"text-tertiary",name:"today"}),e(C,null,{default:o(()=>[d(m(a.$filters.data(l.dataHoraFinalizado)),1)]),_:2},1024),e(q,null,{default:o(()=>[d("Data Finaliza\xE7\xE3o")]),_:1})]),_:2},1024)])):u("",!0)]),_:2},1024)],8,Oe)]),_:2},1024)]),_:2},1024),e(f,{class:"hideonmobile",onClick:s=>r.abrirItem(l.id)},{default:o(()=>[l.dataHoraEmissao?(n(),p(g,{key:0},{default:o(()=>[e(b,{class:"text-tertiary",name:"today"}),e(C,null,{default:o(()=>[d(m(a.$filters.data(l.dataHoraEmissao)),1)]),_:2},1024),e(q,null,{default:o(()=>[d("Data Emiss\xE3o")]),_:1})]),_:2},1024)):u("",!0)]),_:2},1032,["onClick"]),e(f,{class:"hideonmobile",onClick:s=>r.abrirItem(l.id)},{default:o(()=>[l.dataHoraFinalizado?(n(),p(g,{key:0},{default:o(()=>[e(b,{class:"text-tertiary",name:"today"}),e(C,null,{default:o(()=>[d(m(a.$filters.data(l.dataHoraFinalizado)),1)]),_:2},1024),e(q,null,{default:o(()=>[d("Data Finaliza\xE7\xE3o")]),_:1})]),_:2},1024)):u("",!0)]),_:2},1032,["onClick"]),e(f,{onClick:s=>r.abrirItem(l.id)},{default:o(()=>[e(C,{caption:"",class:"text-right text-tertiary"},{default:o(()=>[d(m(a.$filters.numero(l.totalContrato,2))+" ",1),e(q,null,{default:o(()=>[d("Valor do Contrato")]),_:1})]),_:2},1024)]),_:2},1032,["onClick"]),e(f,{side:"",top:""},{default:o(()=>[c("div",Ye,[e(I,{icon:t.listaItensLayout[l.id].detalhes?"keyboard_arrow_up":"keyboard_arrow_down",class:"buttons",color:"tertiary",dense:"",flat:"",round:"",size:"md",onClick:s=>r.showDetails(l)},null,8,["icon","onClick"]),e(I,{class:"buttons",color:"primary",dense:"",flat:"",icon:"edit",round:"",size:"md",onClick:s=>r.abrirItem(l.id)},null,8,["onClick"]),e(I,{dense:"",flat:"",icon:"more_vert",round:"",size:"md"},{default:o(()=>[e(J,null,{default:o(()=>[Y((n(),p(T,{class:"q-py-none",link:"","no-border":"",separator:""},{default:o(()=>[t.filtros.tab!=="Excluidos"?(n(),p(w,{key:0,onClick:s=>a.removerItem(l)},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(b,{name:"delete"})]),_:1}),e(f,null,{default:o(()=>[d(" Remover")]),_:1})]),_:2},1032,["onClick"])):u("",!0),t.filtros.tab==="Excluidos"?(n(),p(w,{key:1,onClick:s=>a.restaurarItem(l)},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(b,{name:"restore_from_trash"})]),_:1}),e(f,null,{default:o(()=>[d("Restaurar")]),_:1})]),_:2},1032,["onClick"])):u("",!0),e(w,{onClick:s=>a.duplicarItem(l.id)},{default:o(()=>[e(f,{avatar:""},{default:o(()=>[e(b,{name:"control_point_duplicate"})]),_:1}),e(f,null,{default:o(()=>[d("Duplicar Produto/Servi\xE7o")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Z]])]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024),t.listaItensLayout[l.id].detalhes?(n(),p(w,{key:0,class:"collumnOnMobile q-px-md q-py-xs",onClick:s=>r.abrirItem(l.id)},{default:o(()=>[l.grupo?(n(),p(f,{key:0,class:"row full-width"},{default:o(()=>[e(C,{caption:""},{default:o(()=>[d(m(l.grupo),1)]),_:2},1024),e(C,null,{default:o(()=>[d(m(l.subGrupo),1)]),_:2},1024)]),_:2},1024)):u("",!0),e(f,{avatar:""},{default:o(()=>[e(k,{class:"q-mr-sm",cor:"primary",escuro:""},{default:o(()=>[d(m(l.tipo),1)]),_:2},1024)]),_:2},1024),e(f,null,{default:o(()=>[l.quantidadeDisponivel?(n(),p(C,{key:0,stamp:""},{default:o(()=>[d(" Estoque "),c("strong",null,m(l.quantidadeDisponivel),1),e(k,{class:"q-ml-sm",cor:"tertiary",escuro:""},{default:o(()=>[d(m(l.unidade),1)]),_:2},1024)]),_:2},1024)):u("",!0)]),_:2},1024),e(f,null,{default:o(()=>[t.listaItensLayout[l.id].fornecedor?(n(),p(C,{key:0,stamp:""},{default:o(()=>[e(b,{class:"q-mr-xs",name:"business"}),d(" Fornecedor: "),(n(!0),y(D,null,P(t.listaItensLayout[l.id].fornecedor,s=>(n(),y("div",{key:s.idContato},m(s.contato.nome),1))),128))]),_:2},1024)):u("",!0)]),_:2},1024),c("div",Ze,[l.codigoBarras?(n(),p(f,{key:0,stamp:""},{default:o(()=>[e(b,{class:"q-mr-xs",name:"mdi-barcode"}),d(" "+m(l.codigoBarras),1)]),_:2},1024)):u("",!0),l.address?(n(),p(f,{key:1,stamp:""},{default:o(()=>[c("span",Je,m(l.address),1)]),_:2},1024)):u("",!0)])]),_:2},1032,["onClick"])):u("",!0),t.listaItensLayout[l.id].detalhes?(n(),y("div",{key:1,class:"row q-col-gutter-x-md q-pa-md pointer",onClick:s=>r.abrirItem(l.id)},[e(j,{class:"col-2 col-lg-auto"},{default:o(()=>[e(O,{modelValue:t.listaItensLayout[l.id].utilizaComposicaoValorReposicaoInvertido,"onUpdate:modelValue":s=>t.listaItensLayout[l.id].utilizaComposicaoValorReposicaoInvertido=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.permissaoFicha?(n(),y("div",$e,[e(_,B({modelValue:l.valorCustoReposicao,"onUpdate:modelValue":s=>l.valorCustoReposicao=s,ajuda:t.listaItensLayout[l.id].utilizaComposicaoValorReposicaoInvertido?"":"Total da composi\xE7\xE3o",disable:!t.listaItensLayout[l.id].utilizaComposicaoValorReposicaoInvertido,readonly:!t.listaItensLayout[l.id].utilizaComposicaoValorReposicaoInvertido,class:"no-shadow full-width"},a.meta.valorCustoReposicao),null,16,["modelValue","onUpdate:modelValue","ajuda","disable","readonly"])])):u("",!0),a.permissaoFicha?(n(),y("div",eo,[e(_,B({modelValue:t.listaItensLayout[l.id].percentualMarkup,"onUpdate:modelValue":s=>t.listaItensLayout[l.id].percentualMarkup=s,disable:t.listaItensLayout[l.id].utilizaMarkupInvertido,readonly:t.listaItensLayout[l.id].utilizaMarkupInvertido,class:"no-shadow full-width",decimals:"2",rotulo:"Lucro",tipo:"decimal"},a.meta.percentualMarkup),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])])):u("",!0),e(j,{class:"col-2 col-lg-auto"},{default:o(()=>[e(O,{modelValue:t.listaItensLayout[l.id].utilizaMarkupInvertido,"onUpdate:modelValue":s=>t.listaItensLayout[l.id].utilizaMarkupInvertido=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.permissaoFicha?(n(),y("div",oo,[e(_,B({modelValue:l.valorVenda,"onUpdate:modelValue":s=>l.valorVenda=s,disable:!t.listaItensLayout[l.id].utilizaMarkupInvertido,readonly:!t.listaItensLayout[l.id].utilizaMarkupInvertido,class:"no-shadow full-width"},a.meta.valorVenda),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])])):u("",!0),a.permissaoFicha?(n(),y("div",to,[e(I,{class:"full-width no-shadow",color:"primary",label:"Salvar",size:"sm",onClick:s=>a.salvarItem(l)},null,8,["onClick"])])):u("",!0)],8,We)):u("",!0),e(H)],64))),128))]),_:1})]),_:1},8,["buscaCampo","checkboxModel","filtros","opcoesGrupo","opcoesMarca","opcoesSubGrupo","opcoesTipo","paginacao","tabSelecionada","tabs","onAbrirTodosPreview","onCriar_click","onFiltro_change"]),e(U,{ref:"contratoModal",onAtualizar:r.atualizar},null,8,["onAtualizar"])])}var ho=K(Ne,[["render",ao],["__scopeId","data-v-7d7c988a"]]);export{ho as default};
