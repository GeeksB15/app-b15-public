import{an as lo,ao as so,bq as no,ap as uo,a5 as te,a6 as L,cW as co,az as mo,a8 as qe,cX as po,cY as go,cZ as Ee,c_ as De,c$ as be,d0 as fo,a7 as d,bz as vo,d1 as Ie,aH as re,aG as Ne,bH as Z,j as ze,a_ as he,aZ as bo,cE as K,bV as ho,a9 as Co,bA as So,af as Pe,d2 as yo,_ as _o,M as wo,a as ko,p as R,o as V,d as M,x as p,F as $,r as ie,i as G,w as l,f as e,B as le,E as se,t as w,e as E,l as J,D as k,s as Q,K as me,V as Ue,A as pe,C as z,L as W,G as ge,aB as Ce,J as Ae,U as ne,aj as fe,ak as j,ah as ve,b9 as Te,ba as Le,bb as Y,y as ee,H as He,aS as xo,d3 as Vo,aK as X,Q as ue,bj as Oe,a$ as qo,aE as Se,ai as Eo,am as Me,bc as Do,aC as Io,aD as No}from"./index.53d95d0a.js";import{o as ye}from"./optionsNfse.22979934.js";const Po=["rgb(255,204,204)","rgb(255,230,204)","rgb(255,255,204)","rgb(204,255,204)","rgb(204,255,230)","rgb(204,255,255)","rgb(204,230,255)","rgb(204,204,255)","rgb(230,204,255)","rgb(255,204,255)","rgb(255,153,153)","rgb(255,204,153)","rgb(255,255,153)","rgb(153,255,153)","rgb(153,255,204)","rgb(153,255,255)","rgb(153,204,255)","rgb(153,153,255)","rgb(204,153,255)","rgb(255,153,255)","rgb(255,102,102)","rgb(255,179,102)","rgb(255,255,102)","rgb(102,255,102)","rgb(102,255,179)","rgb(102,255,255)","rgb(102,179,255)","rgb(102,102,255)","rgb(179,102,255)","rgb(255,102,255)","rgb(255,51,51)","rgb(255,153,51)","rgb(255,255,51)","rgb(51,255,51)","rgb(51,255,153)","rgb(51,255,255)","rgb(51,153,255)","rgb(51,51,255)","rgb(153,51,255)","rgb(255,51,255)","rgb(255,0,0)","rgb(255,128,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,128)","rgb(0,255,255)","rgb(0,128,255)","rgb(0,0,255)","rgb(128,0,255)","rgb(255,0,255)","rgb(245,0,0)","rgb(245,123,0)","rgb(245,245,0)","rgb(0,245,0)","rgb(0,245,123)","rgb(0,245,245)","rgb(0,123,245)","rgb(0,0,245)","rgb(123,0,245)","rgb(245,0,245)","rgb(214,0,0)","rgb(214,108,0)","rgb(214,214,0)","rgb(0,214,0)","rgb(0,214,108)","rgb(0,214,214)","rgb(0,108,214)","rgb(0,0,214)","rgb(108,0,214)","rgb(214,0,214)","rgb(163,0,0)","rgb(163,82,0)","rgb(163,163,0)","rgb(0,163,0)","rgb(0,163,82)","rgb(0,163,163)","rgb(0,82,163)","rgb(0,0,163)","rgb(82,0,163)","rgb(163,0,163)","rgb(92,0,0)","rgb(92,46,0)","rgb(92,92,0)","rgb(0,92,0)","rgb(0,92,46)","rgb(0,92,92)","rgb(0,46,92)","rgb(0,0,92)","rgb(46,0,92)","rgb(92,0,92)","rgb(255,255,255)","rgb(205,205,205)","rgb(178,178,178)","rgb(153,153,153)","rgb(127,127,127)","rgb(102,102,102)","rgb(76,76,76)","rgb(51,51,51)","rgb(25,25,25)","rgb(0,0,0)"],Be="M5 5 h10 v10 h-10 v-10 z",Uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAH0lEQVQoU2NkYGAwZkAFZ5G5jPRRgOYEVDeB3EBjBQBOZwTVugIGyAAAAABJRU5ErkJggg==";var Fe=lo({name:"QColor",props:{...so,...no,modelValue:String,defaultValue:String,defaultView:{type:String,default:"spectrum",validator:r=>["spectrum","tune","palette"].includes(r)},formatModel:{type:String,default:"auto",validator:r=>["auto","hex","rgb","hexa","rgba"].includes(r)},palette:Array,noHeader:Boolean,noHeaderTabs:Boolean,noFooter:Boolean,square:Boolean,flat:Boolean,bordered:Boolean,disable:Boolean,readonly:Boolean},emits:["update:modelValue","change"],setup(r,{emit:o}){const{proxy:s}=Co(),{$q:u}=s,a=uo(r,u),{getCache:c}=So(),q=te(null),_=te(null),g=L(()=>r.formatModel==="auto"?null:r.formatModel.indexOf("hex")>-1),y=L(()=>r.formatModel==="auto"?null:r.formatModel.indexOf("a")>-1),U=te(r.formatModel==="auto"?r.modelValue===void 0||r.modelValue===null||r.modelValue===""||r.modelValue.startsWith("#")?"hex":"rgb":r.formatModel.startsWith("hex")?"hex":"rgb"),O=te(r.defaultView),n=te(ce(r.modelValue||r.defaultValue)),x=L(()=>r.disable!==!0&&r.readonly!==!0),D=L(()=>r.modelValue===void 0||r.modelValue===null||r.modelValue===""||r.modelValue.startsWith("#")),P=L(()=>g.value!==null?g.value:D.value),f=L(()=>({type:"hidden",name:r.name,value:n.value[P.value===!0?"hex":"rgb"]})),t=vo(f),b=L(()=>y.value!==null?y.value:n.value.a!==void 0),h=L(()=>({backgroundColor:n.value.rgb||"#000"})),A=L(()=>`q-color-picker__header-content q-color-picker__header-content--${(n.value.a!==void 0&&n.value.a<65?!0:co(n.value)>.4)?"light":"dark"}`),I=L(()=>({background:`hsl(${n.value.h},100%,50%)`})),Qe=L(()=>({top:`${100-n.value.v}%`,[u.lang.rtl===!0?"right":"left"]:`${n.value.s}%`})),Re=L(()=>r.palette!==void 0&&r.palette.length!==0?r.palette:Po),je=L(()=>"q-color-picker"+(r.bordered===!0?" q-color-picker--bordered":"")+(r.square===!0?" q-color-picker--square no-border-radius":"")+(r.flat===!0?" q-color-picker--flat no-shadow":"")+(r.disable===!0?" disabled":"")+(a.value===!0?" q-color-picker--dark q-dark":"")),Ge=L(()=>r.disable===!0?{"aria-disabled":"true"}:{}),Je=L(()=>[[mo,Ye,void 0,{prevent:!0,stop:!0,mouse:!0}]]);qe(()=>r.modelValue,i=>{const m=ce(i||r.defaultValue);m.hex!==n.value.hex&&(n.value=m)}),qe(()=>r.defaultValue,i=>{if(!r.modelValue&&i){const m=ce(i);m.hex!==n.value.hex&&(n.value=m)}});function oe(i,m){n.value.hex=Ee(i),n.value.rgb=De(i),n.value.r=i.r,n.value.g=i.g,n.value.b=i.b,n.value.a=i.a;const S=n.value[P.value===!0?"hex":"rgb"];o("update:modelValue",S),m===!0&&o("change",S)}function ce(i){const m=y.value!==void 0?y.value:r.formatModel==="auto"?null:r.formatModel.indexOf("a")>-1;if(typeof i!="string"||i.length===0||po.anyColor(i.replace(/ /g,""))!==!0)return{h:0,s:0,v:0,r:0,g:0,b:0,a:m===!0?100:void 0,hex:void 0,rgb:void 0};const S=go(i);return m===!0&&S.a===void 0&&(S.a=100),S.hex=Ee(S),S.rgb=De(S),Object.assign(S,be(S))}function de(i,m,S){const C=q.value;if(C===null)return;const B=C.clientWidth,v=C.clientHeight,F=C.getBoundingClientRect();let T=Math.min(B,Math.max(0,i-F.left));u.lang.rtl===!0&&(T=B-T);const ae=Math.min(v,Math.max(0,m-F.top)),xe=Math.round(100*T/B),Ve=Math.round(100*Math.max(0,Math.min(1,-(ae/v)+1))),io=Ie({h:n.value.h,s:xe,v:Ve,a:b.value===!0?n.value.a:void 0});n.value.s=xe,n.value.v=Ve,oe(io,S)}function _e(i,m){const S=Math.round(i),C=Ie({h:S,s:n.value.s,v:n.value.v,a:b.value===!0?n.value.a:void 0});n.value.h=S,oe(C,m)}function N(i,m,S,C,B){if(C!==void 0&&Z(C),!/^[0-9]+$/.test(i)){B===!0&&s.$forceUpdate();return}const v=Math.floor(Number(i));if(v<0||v>S){B===!0&&s.$forceUpdate();return}const F={r:m==="r"?v:n.value.r,g:m==="g"?v:n.value.g,b:m==="b"?v:n.value.b,a:b.value===!0?m==="a"?v:n.value.a:void 0};if(m!=="a"){const T=be(F);n.value.h=T.h,n.value.s=T.s,n.value.v=T.v}if(oe(F,B),C!==void 0&&B!==!0&&C.target.selectionEnd!==void 0){const T=C.target.selectionEnd;Pe(()=>{C.target.setSelectionRange(T,T)})}}function we(i,m){let S;const C=i.target.value;if(Z(i),U.value==="hex"){if(C.length!==(b.value===!0?9:7)||!/^#[0-9A-Fa-f]+$/.test(C))return!0;S=yo(C)}else{let v;if(C.endsWith(")"))if(b.value!==!0&&C.startsWith("rgb(")){if(v=C.substring(4,C.length-1).split(",").map(F=>parseInt(F,10)),v.length!==3||!/^rgb\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3}\)$/.test(C))return!0}else if(b.value===!0&&C.startsWith("rgba(")){if(v=C.substring(5,C.length-1).split(","),v.length!==4||!/^rgba\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/.test(C))return!0;for(let T=0;T<3;T++){const ae=parseInt(v[T],10);if(ae<0||ae>255)return!0;v[T]=ae}const F=parseFloat(v[3]);if(F<0||F>1)return!0;v[3]=F}else return!0;else return!0;if(v[0]<0||v[0]>255||v[1]<0||v[1]>255||v[2]<0||v[2]>255||b.value===!0&&(v[3]<0||v[3]>1))return!0;S={r:v[0],g:v[1],b:v[2],a:b.value===!0?v[3]*100:void 0}}const B=be(S);if(n.value.h=B.h,n.value.s=B.s,n.value.v=B.v,oe(S,m),m!==!0){const v=i.target.selectionEnd;Pe(()=>{i.target.setSelectionRange(v,v)})}}function We(i){const m=ce(i),S={r:m.r,g:m.g,b:m.b,a:m.a};S.a===void 0&&(S.a=n.value.a),n.value.h=m.h,n.value.s=m.s,n.value.v=m.v,oe(S,!0)}function Ye(i){i.isFinal?de(i.position.left,i.position.top,!0):Xe(i)}const Xe=fo(i=>{de(i.position.left,i.position.top)},20);function Ze(i){de(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset,!0)}function Ke(i){de(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset)}function ke(i){_.value!==null&&(_.value.$el.style.opacity=i?1:0)}function $e(){const i=[];return r.noHeaderTabs!==!0&&i.push(d(Ne,{class:"q-color-picker__header-tabs",modelValue:U.value,dense:!0,align:"justify",...c("topVTab",{"onUpdate:modelValue":m=>{U.value=m}})},()=>[d(re,{label:"HEX"+(b.value===!0?"A":""),name:"hex",ripple:!1}),d(re,{label:"RGB"+(b.value===!0?"A":""),name:"rgb",ripple:!1})])),i.push(d("div",{class:"q-color-picker__header-banner row flex-center no-wrap"},[d("input",{class:"fit",value:n.value[U.value],...x.value!==!0?{readonly:!0}:{},...c("topIn",{onInput:m=>{ke(we(m)===!0)},onChange:Z,onBlur:m=>{we(m,!0)===!0&&s.$forceUpdate(),ke(!1)}})}),d(ze,{ref:_,class:"q-color-picker__error-icon absolute no-pointer-events",name:u.iconSet.type.negative})])),d("div",{class:"q-color-picker__header relative-position overflow-hidden"},[d("div",{class:"q-color-picker__header-bg absolute-full"}),d("div",{class:A.value,style:h.value},i)])}function eo(){return d(bo,{modelValue:O.value,animated:!0},()=>[d(he,{class:"q-color-picker__spectrum-tab overflow-hidden",name:"spectrum"},ao),d(he,{class:"q-pa-md q-color-picker__tune-tab",name:"tune"},to),d(he,{class:"q-color-picker__palette-tab",name:"palette"},ro)])}function oo(){return d("div",{class:"q-color-picker__footer relative-position overflow-hidden"},[d(Ne,{class:"absolute-full",modelValue:O.value,dense:!0,align:"justify",...c("ftIn",{"onUpdate:modelValue":i=>{O.value=i}})},()=>[d(re,{icon:u.iconSet.colorPicker.spectrum,name:"spectrum",ripple:!1}),d(re,{icon:u.iconSet.colorPicker.tune,name:"tune",ripple:!1}),d(re,{icon:u.iconSet.colorPicker.palette,name:"palette",ripple:!1})])])}function ao(){const i={ref:q,class:"q-color-picker__spectrum non-selectable relative-position cursor-pointer"+(x.value!==!0?" readonly":""),style:I.value,...x.value===!0?{onClick:Ze,onMousedown:Ke}:{}},m=[d("div",{style:{paddingBottom:"100%"}}),d("div",{class:"q-color-picker__spectrum-white absolute-full"}),d("div",{class:"q-color-picker__spectrum-black absolute-full"}),d("div",{class:"absolute",style:Qe.value},[n.value.hex!==void 0?d("div",{class:"q-color-picker__spectrum-circle"}):null])],S=[d(K,{class:"q-color-picker__hue non-selectable",modelValue:n.value.h,min:0,max:360,trackSize:"8px",innerTrackColor:"transparent",selectionColor:"transparent",readonly:x.value!==!0,thumbPath:Be,"onUpdate:modelValue":_e,...c("lazyhue",{onChange:C=>_e(C,!0)})})];return b.value===!0&&S.push(d(K,{class:"q-color-picker__alpha non-selectable",modelValue:n.value.a,min:0,max:100,trackSize:"8px",trackColor:"white",innerTrackColor:"transparent",selectionColor:"transparent",trackImg:Uo,readonly:x.value!==!0,hideSelection:!0,thumbPath:Be,...c("alphaSlide",{"onUpdate:modelValue":C=>N(C,"a",100),onChange:C=>N(C,"a",100,void 0,!0)})})),[ho("div",i,m,"spec",x.value,()=>Je.value),d("div",{class:"q-color-picker__sliders"},S)]}function to(){return[d("div",{class:"row items-center no-wrap"},[d("div","R"),d(K,{modelValue:n.value.r,min:0,max:255,color:"red",dark:a.value,readonly:x.value!==!0,...c("rSlide",{"onUpdate:modelValue":i=>N(i,"r",255),onChange:i=>N(i,"r",255,void 0,!0)})}),d("input",{value:n.value.r,maxlength:3,readonly:x.value!==!0,onChange:Z,...c("rIn",{onInput:i=>N(i.target.value,"r",255,i),onBlur:i=>N(i.target.value,"r",255,i,!0)})})]),d("div",{class:"row items-center no-wrap"},[d("div","G"),d(K,{modelValue:n.value.g,min:0,max:255,color:"green",dark:a.value,readonly:x.value!==!0,...c("gSlide",{"onUpdate:modelValue":i=>N(i,"g",255),onChange:i=>N(i,"g",255,void 0,!0)})}),d("input",{value:n.value.g,maxlength:3,readonly:x.value!==!0,onChange:Z,...c("gIn",{onInput:i=>N(i.target.value,"g",255,i),onBlur:i=>N(i.target.value,"g",255,i,!0)})})]),d("div",{class:"row items-center no-wrap"},[d("div","B"),d(K,{modelValue:n.value.b,min:0,max:255,color:"blue",readonly:x.value!==!0,dark:a.value,...c("bSlide",{"onUpdate:modelValue":i=>N(i,"b",255),onChange:i=>N(i,"b",255,void 0,!0)})}),d("input",{value:n.value.b,maxlength:3,readonly:x.value!==!0,onChange:Z,...c("bIn",{onInput:i=>N(i.target.value,"b",255,i),onBlur:i=>N(i.target.value,"b",255,i,!0)})})]),b.value===!0?d("div",{class:"row items-center no-wrap"},[d("div","A"),d(K,{modelValue:n.value.a,color:"grey",readonly:x.value!==!0,dark:a.value,...c("aSlide",{"onUpdate:modelValue":i=>N(i,"a",100),onChange:i=>N(i,"a",100,void 0,!0)})}),d("input",{value:n.value.a,maxlength:3,readonly:x.value!==!0,onChange:Z,...c("aIn",{onInput:i=>N(i.target.value,"a",100,i),onBlur:i=>N(i.target.value,"a",100,i,!0)})})]):null]}function ro(){const i=m=>d("div",{class:"q-color-picker__cube col-auto",style:{backgroundColor:m},...x.value===!0?c("palette#"+m,{onClick:()=>{We(m)}}):{}});return[d("div",{class:"row items-center q-color-picker__palette-rows"+(x.value===!0?" q-color-picker__palette-rows--editable":"")},Re.value.map(i))]}return()=>{const i=[eo()];return r.name!==void 0&&r.disable!==!0&&t(i,"push"),r.noHeader!==!0&&i.unshift($e()),r.noFooter!==!0&&i.push(oo()),d("div",{class:je.value,...Ge.value},i)}}});const Ao={components:{Avatar:wo},data(){return{certificado:{arquivo:"",senha:""},itemHistoricoIssModelo:{data:"",aliquota:0},itemListaDeServicoModelo:{codigo:"",codigoCNAE:"",codigoTributacao:"",descricao:""},itemHistoricoIssModal:!1,itemListaDeServicoModal:!1,dbUsuario:$db.usuario,empresa:{},itemHistoricoIss:{},itemListaDeServico:{},historicoIss:[],itensListaDeServico:[],empresas:[],modalCertificado:!1,modalEmpresa:!1,simENaoOpcoes:ye.opcoesSimNao,naturezaOperacaoOpcoes:ye.opcoesNatureza,regimeTributarioOpcoes:ye.opcoesRegimeEspecialTributacao,resultado:{erro:0,final:"",listaNCMErros:[],percentagem:0,sucesso:0,titulo:"Importando...",total:0,visivel:!1},colunasTabelaHistoricoIss:[{name:"data",label:"Data",field:"data",align:"center"},{name:"aliquota",label:"Aliquota",field:"aliquota",align:"center"},{name:"acao",label:"A\xE7\xF5es",align:"center"}],colunasTabelaItensListaServico:[{name:"codigo",label:"C\xF3digo",field:"codigo",align:"center"},{name:"codigoCNAE",label:"C\xF3digo CNAE",field:"codigoCNAE",align:"center"},{name:"codigoTributacao",label:"C\xF3digo de tributa\xE7\xE3o",field:"codigoTributacao",align:"center"},{name:"descricao",label:"Descri\xE7\xE3o",field:"descricao",align:"center"},{name:"acao",label:"A\xE7\xF5es",align:"center"}],empresaUsuarios:{empresa:"",usuario:[],mostrar:!1}}},methods:{abrirValidCertificadora(){window.open("http://www.validcertificadora.com.br/P/B516DF35-5BC4-4D2D-8A62-CCF42F9BEF71/RD019446","_blank")},async atualizar(){try{const r=localStorage.getItem("clienteSistema");$utils.verificarErro(!r,"Ocorreu erro ao consultar clienteSistema"),this.clienteSistema=JSON.parse(r);const o=await $db.empresa.leOnlinePlat({codigoClienteSistema:this.clienteSistema.codigoClienteSistema});for(const s of o){const u=await $db.contato.leOnline({codigoContato:s.codigoContato});s.contato=u[0]||{}}this.empresas=o}catch(r){this.$q.notifyError("Ocorreu erro ao consultar empresas",r)}},async abrirPromptContatoEmpresa(){const r=await $g.promptContato.show({filtro:{ativo:!0},placeholder:"Selecione a empresa"});(r||{}).id&&this.criarEmpresa(r.id,r)},abrirModalEmpresa(r){try{this.modalEmpresa=!0,this.empresa=r,this.historicoIss=r.nfseHistoricoIss?JSON.parse(r.nfseHistoricoIss):[],this.itensListaDeServico=r.nfseItensListaDeServico?JSON.parse(r.nfseItensListaDeServico):[]}catch(o){this.$q.notifyError("Ocorreu erro ao abrir empresa",o)}},abrirSiteIbpt(){window.open("https://deolhonoimposto.ibpt.org.br/Site/PassoPasso")},adicionarCertificado(r){this.certificado.arquivo=r[0]},async configurarEmpresa(){var g,y,U,O,n,x;const r=new Headers,o=new FormData;let s,u,a,c,q,_;try{a=await $erp().configuracoes.where({nome:"integrador.servidor.opcoes"}).toArray(),q=(U=JSON.parse((y=(g=a==null?void 0:a[0])==null?void 0:g.valor)!=null?y:null))!=null?U:[],q=q.filter(D=>D.motor==="node")}catch(D){console.error(D),$q.notify({type:"negative",message:"Erro ao obter configura\xE7\xE3o 'integrador.servidor.opcoes'."});return}_=await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id),a=await $erp().configuracoes.where({nome:"nfe.homologacao"}).toArray(),c=((O=a[0])==null?void 0:O.valor)==="1"?2:1,r.append("Content-Type","application/json;charset=utf-8"),o.append("cnpj",(n=this.empresa.numeroDocumentoNacional)==null?void 0:n.replace(/\D/g,"")),o.append("razaoSocial",this.empresa.nome),o.append("certificadoArquivo",this.certificado.arquivo),o.append("certificadoSenha",this.certificado.senha),o.append("ufCod",_.ufCod),o.append("ambiente",c),o.append("identificadorCSC",c===1?this.empresa.hashCSCProducao:this.empresa.hashCSCHomologacao),o.append("tokenCSC",c===1?this.empresa.tokenCSCProducao:this.empresa.tokenCSCHomologacao);for(const D of q){try{if(s=await fetch(`${D.url}/nfe/configurar-empresa`,{method:"POST",mode:"cors",body:o}),u=await s.json(),!s.ok)throw u!=null&&u.message?new Error(u.message):new Error("Erro desconhecido");if(u.cStat==="1"&&$q.notify({type:"positive",message:`${D.descricao}|NF-e: ${u.xMotivo}`}),u.cStat!=="1")throw new Error(`GError:${u.xMotivo}`)}catch(P){console.error(P.message);const f=/GError:.+/.test(P.message);f&&$q.notify({type:"negative",message:`${D.descricao}|NF-e: ${P.message.slice(7)}`}),f||$q.notify({type:"negative",message:`${D.descricao}|NF-e: N\xE3o foi poss\xEDvel concluir a opera\xE7\xE3o.`})}try{if(s=await fetch(`${D.url}/nfse/configurar-empresa`,{method:"POST",headers:r,mode:"cors",body:JSON.stringify({cnpj:(x=this.empresa.numeroDocumentoNacional)==null?void 0:x.replace(/\D/g,""),razaoSocial:this.empresa.nome,certificadoSenha:this.certificado.senha,ibgeCod:_.ibgeCod,ambiente:1})}),u=await s.json(),!s.ok)throw u!=null&&u.message?new Error(u.message):new Error("Erro desconhecido");if(u.cStat==="1"&&$q.notify({type:"positive",message:`${D.descricao}|NFS-e: ${u.xMotivo}`}),u.cStat!=="1")throw new Error(`GError:${u.xMotivo}`)}catch(P){console.error(P.message);const f=/GError:.+/.test(P.message);f&&$q.notify({type:"negative",message:`${D.descricao}|NFS-e: ${P.message.slice(7)}`}),f||$q.notify({type:"negative",message:`${D.descricao}|NFS-e: N\xE3o foi poss\xEDvel concluir a opera\xE7\xE3o.`})}}},async enviarCertificado(){var a,c,q,_,g,y,U,O,n,x,D,P;let r;const o=await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id);await $erp().contato.get(this.empresa.contato.id);let s=!1;(a=this.empresa)!=null&&a.nfseCodigoServico&&(s=!0),$utils.verificarErro(!this.certificado.arquivo,"Certificado n\xE3o selecionado"),$utils.verificarErro(!this.certificado.senha,"Senha obrigat\xF3ria"),await this.configurarEmpresa(),this.certificado.error={};let u;if(u=o.ibgeCod!==3543402,!u){const f=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");u=(f==null?void 0:f.toLowerCase())==="plugnotas"}{const f=new FormData;f.append("funcao","948AE0B9-67F9-4116-AE95-E48617202DCA"),f.append("arquivo",this.certificado.arquivo),f.append("senha",this.certificado.senha),f.append("CNPJ",$utils.filtrarDigitos(this.empresa.numeroDocumentoNacional)),f.append("razaoSocial",this.empresa.nome);try{r=await this.$utils.geeksApi(f,{baseURL:"https://srv2.api.b15.com.br"})}catch(b){console.error(b.message)}let t=!1;if((r==null?void 0:r.status)===200&&(this.$q.notifyPositive("Geeks: Certificado enviado com sucesso"),t=!0),(r==null?void 0:r.status)!==200&&(this.$q.notifyError("Geeks: N\xE3o foi poss\xEDvel enviar o certificado para ambos os servidores NF-e e NFS-e"),t=!0),!t){const b=(r==null?void 0:r.status)!==200?"NF-e":"NFS-e",h=(r==null?void 0:r.status)===200?"NF-e":"NFS-e";this.$q.notifyPositive(`Geeks: Certificado enviado com sucesso para o servidor ${h}`),this.$q.notifyError(`Geeks: N\xE3o foi poss\xEDvel enviar o certificado para o servidor ${b}`)}}if(s&&u){let f,t,b,h,A,I;if(f=await $api.plugnotas.certificado.cadastrar(this.certificado.arquivo,this.certificado.senha),t=(y=(c=f==null?void 0:f.data)==null?void 0:c.id)!=null?y:(g=(_=(q=f==null?void 0:f.error)==null?void 0:q.data)==null?void 0:_.current)==null?void 0:g.id,!t&&((U=f==null?void 0:f.error)==null?void 0:U.message)){this.$q.notifyError(`PlugNotas: ${(O=f==null?void 0:f.error)==null?void 0:O.message}`);return}b=(n=this.empresa.numeroDocumentoNacional)==null?void 0:n.replace(/\D/g,""),h=await $api.plugnotas.empresa.consultar(b),A=await this.cadastrarEmpresaPlugNotas(t),((D=(x=h==null?void 0:h.error)==null?void 0:x.data)==null?void 0:D.cpfCnpj)===b&&(I=await $api.plugnotas.empresa.cadastrar(A)),h!=null&&h.cpfCnpj&&(I=await $api.plugnotas.empresa.alterar(h.cpfCnpj,A)),(P=I==null?void 0:I.error)!=null&&P.message&&(this.$q.notifyError(`PlugNotas: ${I.error.message}`),this.certificado.error=I.error),I!=null&&I.message&&(this.$q.notifyPositive(`PlugNotas: ${I.message}`),this.modalCertificado=!1)}},async cadastrarEmpresaPlugNotas(r){var g,y;const o=await $db.contato.le({id:this.empresa.contato.id}),s=await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id);let a=(await $erp().contatoTelefone.where("idContato").equals(this.empresa.contato.id).toArray()||[]).find(U=>U.tipoTelefone==="Principal"),c=a.telefone.substr(0,2),q=a.telefone.substr(3);return{cpfCnpj:(g=this.empresa.contato.numeroDocumentoNacional)==null?void 0:g.replace(/\D/g,""),inscricaoMunicipal:o.numeroDocumentoMunicipal,inscricaoEstadual:(y=this.empresa.numeroDocumentoEstadual)!=null?y:null,razaoSocial:this.empresa.contato.nome,nomeFantasia:this.empresa.contato.apelido,certificado:r,simplesNacional:!0,regimeTributario:1,incentivoFiscal:!0,incentivadorCultural:!0,regimeTributarioEspecial:5,endereco:{bairro:s.bairro,cep:s.cep,codigoCidade:s.ibgeCod,estado:s.uf,logradouro:s.logradouro,numero:s.numero,codigoPais:s.codigoPais,complemento:s.complemento,descricaoCidade:s.municipio,descricaoPais:s.pais},telefone:{numero:`${q}`,ddd:`${c}`},email:o.emailNfe,nfse:{ativo:!0,tipoContrato:0,config:{producao:!0,rps:{lote:1,numeracao:[{numero:1,serie:"1"}]},email:{envio:!0},calculoAutomaticoIbpt:{ativo:!0}}}}},async removerEmpresa(r){$q.dialog({title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 remover esta empresa.",preventClose:!0,cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Remover",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show(),await $db.empresa.removeOnline(r),await this.atualizar(),$q.notifyPositive("A empresa foi removida com sucesso.")}catch(o){$q.notifyError("Ocorreu um erro ao remover empresa",o)}finally{$q.loading.hide()}})},async criarEmpresa(r,o){try{if(!r)return;const s=this.empresas.find(u=>u.idContato===o.id)||{};await $db.empresa.gravaOnline({atual:{...s,idContato:o.id,codigoContato:o.codigoContato,nome:o.nome,apelido:o.apelido,numeroDocumentoNacional:o.numeroDocumentoNacional,numeroDocumentoEstadual:o.numeroDocumentoEstadual,codigoClienteSistema:this.clienteSistema.codigoClienteSistema,idClienteSistema:this.clienteSistema.idClienteSistema}}),await this.atualizar(),this.$q.notifyPositive("Empresa salva com sucesso")}catch(s){this.$q.notifyError("Ocorreu erro ao salvar empresa",s)}},async gravarEmpresa(){try{this.empresa.nfseHistoricoIss=JSON.stringify(this.historicoIss),this.empresa.nfseItensListaDeServico=JSON.stringify(this.itensListaDeServico),await $db.empresa.gravaOnline({atual:{...this.empresa,idContato:this.empresa.contato.id,codigoClienteSistema:this.clienteSistema.codigoClienteSistema,idClienteSistema:this.clienteSistema.idClienteSistema}}),await this.atualizar(),this.$q.notifyPositive("Empresa salva com sucesso"),this.modalEmpresa=!1}catch(r){this.$q.notifyError("Ocorreu erro ao salvar empresa",r)}},async importaAliquotasIBPT(r){var o,s;try{$utils.verificarErro($utils.filtrarDigitos(r.numeroDocumentoNacional).length!==14,"CNPJ da empresa inv\xE1lido"),$utils.verificarErro(!r.tokenIBPT,"Empresa sem Token do IBPT"),r.contato.enderecoPrincipal=await $db.contatoEndereco.leEnderecoPrincipal(r.contato.id),$utils.verificarErro(!r.contato.enderecoPrincipal,"Empresa sem endereco"),$utils.verificarErro(!r.contato.enderecoPrincipal.uf,"Empresa sem UF cadastrado");let u={token:r.tokenIBPT,cnpj:$utils.filtrarDigitos(r.numeroDocumentoNacional),codigo:"",uf:r.contato.enderecoPrincipal.uf,ex:"0",descricao:"X",unidadeMedida:"UN",valor:"0",gtin:"0"};this.resultado.visivel=!0,this.resultado.sucesso=0,this.resultado.erro=0,this.resultado.percentagem=0,this.resultado.listaNCMErros=[],this.resultado.final="";const a=(await $db.ncm.le()).map(_=>_.ncm).sort();this.resultado.total=a.length;let c=[],q=[c];for(const _ of a)c.length>=10&&(c=[],q.push(c)),c.push({ncm:_,params:$utils.clonarV2(u),promisse:null});for(const _ of q){if(!this.resultado.visivel)return;for(const g of _)try{if(g.params.codigo=g.ncm,!((o=g.params)!=null&&o.codigo))continue;g.promisse=await ko({method:"get",url:"https://apidoni.ibpt.org.br/api/v1/produtos",params:g.params,validateStatus:y=>y>=200&&y<=500})}catch(y){console.error(`EROO -------- ${y}`)}for(const g of _){let y;if(!!((s=g.params)!=null&&s.codigo)){if(!g.promisse){q.push([g]);continue}try{y=await g.promisse}catch{}$utils.verificarErro(!y||!y.data||!y.status,"Erro de comunica\xE7\xE3o com o servidor IBPT. Tente novamente mais tarde."),$utils.verificarErro(y.status!==200,"Erro retornado pelo servidor do IBPT: "+y.data.Message||"Sem mensagem"),y.data.Codigo===g.ncm?(this.resultado.sucesso++,await $db.nfeIbpt.atualiza(r.contato.id,y.data)):(this.resultado.erro++,this.resultado.listaNCMErros.push(g.ncm)),this.resultado.percentagem=100*(this.resultado.sucesso+this.resultado.erro)/this.resultado.total}}}this.resultado.final="Importa\xE7\xE3o finalizada!"}catch(u){this.resultado.final=this.$q.notifyError("Falha na importa\xE7\xE3o!",u)}},async empresaUsuarios_click(r){this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{};const o=await $utils.geeksApi({grupo:{funcao:"9C93290F-BEDD-4051-A0F5-FA01D961CCF4",codigoClienteSistema:this.clienteSistema.codigoClienteSistema},usuario:{funcao:"E4E43C26-D0B7-4CFB-9F13-BBFA9F11E847",codigoClienteSistema:this.clienteSistema.codigoClienteSistema},permissao:{funcao:"E0982E1C-87EC-4506-8293-675407D3312C",empresaCnpj:r.numeroDocumentoNacional}});for(const s of o.data.usuario)s.ativo=!!o.data.permissao.find(u=>u.usuarioCpf===s.numeroDocumentoNacional),s.ativoOriginal=s.ativo;this.empresaUsuarios.grupo=o.data.grupo.sort((s,u)=>{var a,c;return((a=s.descricao)==null?void 0:a.toLowerCase())<((c=u.descricao)==null?void 0:c.toLowerCase())?-1:1}).map(s=>(s.ativo=!1,s.aberto=!0,s)),this.empresaUsuarios.usuario=o.data.usuario.sort((s,u)=>{var a,c;return((a=s.nome)==null?void 0:a.toLowerCase())<((c=u.nome)==null?void 0:c.toLowerCase())?-1:1}),this.empresaUsuarios.empresa=r,this.empresaUsuarios.empresa.ativo=!1,this.empresaUsuarios.mostrar=!this.empresaUsuarios.mostrar,this.empresaUsuarios_pai_atualizar()},async empresaUsuarios_gravar_click(r){const o=[],s=[];for(const u of this.empresaUsuarios.usuario)u.ativo!==u.ativoOriginal&&(u.ativo?o.push(u.numeroDocumentoNacional):s.push(u.numeroDocumentoNacional));console.log("ativar",o,o.join(",")),console.log("inativar",s,s.join(",")),await $utils.geeksApi({ret:{funcao:"A28E375E-DD31-4580-B8CF-07F6D2254044",ativar:o,inativar:s,empresaCnpj:this.empresaUsuarios.empresa.numeroDocumentoNacional}})},empresaUsuarios_ativar_todos_click(r,o){r==="empresa"&&(this.empresaUsuarios.grupo.forEach(s=>{s.ativo=this.empresaUsuarios.empresa.ativo}),this.empresaUsuarios.usuario.forEach(s=>{s.ativo=this.empresaUsuarios.empresa.ativo})),r==="grupo"&&this.empresaUsuarios.usuario.filter(s=>s.codigoGrupo===o.codigoGrupo).forEach(s=>{s.ativo=o.ativo}),this.empresaUsuarios_pai_atualizar()},empresaUsuarios_pai_atualizar(){let r=this.empresaUsuarios.usuario[0].ativo;for(const o of this.empresaUsuarios.usuario)if(o.ativo!==r){r=null;break}this.empresaUsuarios.empresa.ativo=r;for(const o of this.empresaUsuarios.grupo){let s=this.empresaUsuarios.usuario.filter(u=>u.codigoGrupo===o.codigoGrupo)[0].ativo;for(const u of this.empresaUsuarios.usuario.filter(a=>a.codigoGrupo===o.codigoGrupo))if(u.ativo!==s){s=null;break}o.ativo=s}},adicionarHistorico(){if(this.itemHistoricoIss.data.length!==10){this.$q.notifyError("A data precisa ser v\xE1lida");return}this.historicoIss.push(this.itemHistoricoIss),this.itemHistoricoIssModal=!1},adicionarItemListaDeServico(){if(!this.itemListaDeServico.codigo||!this.itemListaDeServico.codigoCNAE||!this.itemListaDeServico.codigoTributacao||!this.itemListaDeServico.descricao){this.$q.notifyError("Preencha os campos");return}this.itemListaDeServico.id===void 0?this.itensListaDeServico.push(this.itemListaDeServico):this.itensListaDeServico[this.itemListaDeServico.id]={codigo:this.itemListaDeServico.codigo,codigoCNAE:this.itemListaDeServico.codigoCNAE,codigoTributacao:this.itemListaDeServico.codigoTributacao,descricao:this.itemListaDeServico.descricao},this.itemListaDeServicoModal=!1},removerHistoricoIss(r){this.historicoIss.splice(r,1)},removerItemListaDeServico(r){this.itensListaDeServico[r].codigo===this.empresa.nfseCodigoServico?$q.dialog({title:"Deletar item da lista de servi\xE7o",message:"Esse item est\xE1 sendo usado nos valores padr\xF5es, ao deletar o mesmo ser\xE1 eliminado, deseja continuar?",cancel:!0}).onOk(()=>{this.empresa.nfseCodigoServico="",this.itensListaDeServico.splice(r,1)}):this.itensListaDeServico.splice(r,1)},editarItemListaDeServico(r){const o=this.itensListaDeServico[r];o.id=r,this.itemListaDeServico={...o},this.itemListaDeServicoModal=!0}},created(){this.atualizar()}},H=r=>(Io("data-v-7447af60"),r=r(),No(),r),To={class:"ConfiguracoesEmpresas u-container"},Lo={class:"q-mt-md no-shadow"},Ho={class:"col text-body1"},Oo={class:"col text-body1"},Mo={class:"col text-body1"},Bo={class:"q-pr-md"},Fo={key:0,class:"q-pr-md"},zo={key:0,class:"q-mt-md text-center"},Qo={class:"layout-padding q-pa-none q-pb-md"},Ro={class:"u-container"},jo={class:"col-12 col-md-4"},Go={class:"row items-center"},Jo=H(()=>p("div",{class:"col no-wrap"},"Cor principal",-1)),Wo={class:"col-12 col-md-4"},Yo={class:"row items-center"},Xo=H(()=>p("div",{class:"col no-wrap"},"Cor secundaria",-1)),Zo=H(()=>p("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Token de atualiza\xE7\xE3o de al\xEDquotas para calculo do valor aproximado dos tributos",-1)),Ko=H(()=>p("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Dados para gera\xE7\xE3o do QRCode da NFC-e",-1)),$o=H(()=>p("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"}," Dados padr\xF5es para serem utilizados na cria\xE7\xE3o de uma NFS-e ",-1)),ea={class:"row justify-between",style:{width:"100%"}},oa=H(()=>p("div",{class:"text-subtitle text-tertiary text-weight-bold"}," Hist\xF3rico ISS ",-1)),aa={class:"row justify-between",style:{width:"100%"}},ta=H(()=>p("div",{class:"text-subtitle text-tertiary text-weight-bold"}," Itens da Lista de Servi\xE7o ",-1)),ra=H(()=>p("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Certificado digital",-1)),ia={class:"row q-ma-md"},la={key:0,class:"row q-ma-md"},sa={class:"certificado-error-messages"},na=H(()=>p("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Total de NCMs:",-1)),ua={class:"col-6 col-sm-9 text-subtitle text-tertiary"},ca=H(()=>p("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Sucesso:",-1)),da={class:"col-6 col-sm-9 text-subtitle text-tertiary"},ma=H(()=>p("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Erro(s):",-1)),pa={class:"col-6 col-sm-9 text-subtitle text-tertiary"},ga=H(()=>p("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Os NCMs abaixo n\xE3o foram validados no servidor do IBPT:",-1)),fa={class:"col-12 text-subtitle text-tertiary text-weight-bold"},va=H(()=>p("div",{class:"text-h6"},"Adicionar Hist\xF3rico ISS",-1)),ba=H(()=>p("div",{class:"text-h6"},"Adicionar Item na Lista de Servi\xE7o",-1));function ha(r,o,s,u,a,c){var P,f;const q=R("avatar"),_=R("row"),g=R("campo"),y=R("SeletorContato"),U=R("card"),O=R("g-col"),n=R("g-label"),x=R("g-row"),D=R("badge");return V(),M("div",To,[p("div",Lo,[(V(!0),M($,null,ie(a.empresas,t=>(V(),G(Q,{class:"extratoItem bg-white q-mb-md q-pa-md",key:t.id},{default:l(()=>[e(le,null,{default:l(()=>[e(q,{imagem:t.contato.imagem,rotulo:t.apelido,tamanho:"40",class:"float-left"},null,8,["imagem","rotulo"]),e(se,null,{default:l(()=>[p("div",null,w(t.nome),1),e(_,{class:"q-col-gutter-md"},{default:l(()=>[p("div",Ho,w(t.apelido),1),p("div",Oo,w(t.numeroDocumentoNacional),1),p("div",Mo,[p("span",Bo,[E("Ativa: "),p("b",null,w(t.ativo?"Sim":"N\xE3o"),1)]),t.sigla?(V(),M("span",Fo,[E("Sigla: "),p("b",null,w(t.sigla),1)])):J("",!0)])]),_:2},1024)]),_:2},1024),e(k,{onClick:b=>c.abrirModalEmpresa(t),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:"",class:"q-ma-xs"},null,8,["onClick"]),e(k,{onClick:b=>c.empresaUsuarios_click(t),icon:"manage_accounts",size:"md",color:"primary",round:"",flat:"",dense:"",class:"q-ma-xs"},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),[1,2].includes((f=(P=a.dbUsuario)==null?void 0:P.logado)==null?void 0:f.grupoInterno)?(V(),M("div",zo,[e(k,{onClick:c.abrirPromptContatoEmpresa,icon:"add",size:"sm",label:"Empresa",color:"positive",outline:""},null,8,["onClick"])])):J("",!0)]),e(ee,{modelValue:a.modalEmpresa,"onUpdate:modelValue":o[27]||(o[27]=t=>a.modalEmpresa=t),maximized:""},{default:l(()=>[e(me,{class:"bg-light",container:""},{default:l(()=>[p("form",{onSubmit:o[26]||(o[26]=Ue((...t)=>c.gravarEmpresa&&c.gravarEmpresa(...t),["prevent"]))},[e(pe,null,{default:l(()=>[e(le,null,{default:l(()=>[z(e(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[W]]),e(se,null,{default:l(()=>[E(w(a.empresa.nome),1)]),_:1}),e(k,{class:"q-ml-sm no-shadow",color:"white","text-color":"primary",label:"Salvar",type:"submit",unelevated:""})]),_:1})]),_:1}),e(ge,null,{default:l(()=>[p("div",Qo,[p("div",Ro,[e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(_,{class:"q-col-gutter-md items-center"},{default:l(()=>[!!a.dbUsuario.logado.administrador&&[1,2].includes(a.dbUsuario.logado.grupoInterno)?(V(),G(g,{key:0,modelValue:a.empresa.ativo,"onUpdate:modelValue":o[0]||(o[0]=t=>a.empresa.ativo=t),class:"col-12 col-md-4",maxlength:"1",rotulo:"Ativo",tipo:"logico"},null,8,["modelValue"])):J("",!0),p("div",jo,[p("div",Go,[z(e(Fe,{modelValue:a.empresa.corPrincipal,"onUpdate:modelValue":o[1]||(o[1]=t=>a.empresa.corPrincipal=t),ref:"corPrincipal","format-model":"hex",modal:"",clearable:"","ok-label":"Ok","cancel-label":"Cancelar"},null,8,["modelValue"]),[[Ce,!1]]),e(k,{class:"col-auto",style:Ae({color:a.empresa.corPrincipal}),flat:"",icon:"mdi-circle",size:"xl",onClick:o[2]||(o[2]=t=>r.$refs.corPrincipal.show())},null,8,["style"]),Jo])]),p("div",Wo,[p("div",Yo,[z(e(Fe,{modelValue:a.empresa.corSecundaria,"onUpdate:modelValue":o[3]||(o[3]=t=>a.empresa.corSecundaria=t),ref:"corSecundaria","format-model":"hex",modal:"",clearable:"","ok-label":"Ok","cancel-label":"Cancelar"},null,8,["modelValue"]),[[Ce,!1]]),e(k,{class:"col-auto",style:Ae({color:a.empresa.corSecundaria}),flat:"",icon:"mdi-circle",size:"xl",onClick:o[4]||(o[4]=t=>r.$refs.corSecundaria.show())},null,8,["style"]),Xo])])]),_:1}),e(_,{class:"q-col-gutter-md"},{default:l(()=>[e(g,{modelValue:a.empresa.sigla,"onUpdate:modelValue":o[5]||(o[5]=t=>a.empresa.sigla=t),class:"col-12 col-md-4",maxlength:"5",rotulo:"Sigla"},null,8,["modelValue"]),e(y,{modelValue:a.empresa.idPai,"onUpdate:modelValue":o[6]||(o[6]=t=>a.empresa.idPai=t),class:"col-12 col-md-8",filtro:{ativo:!0,empresas:!0},rotulo:"Grupo",onSelecionar:o[7]||(o[7]=t=>a.empresa.codigoPai=t.codigoContato)},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(_,{class:"q-col-gutter-md"},{default:l(()=>[Zo,e(g,{modelValue:a.empresa.tokenIBPT,"onUpdate:modelValue":o[8]||(o[8]=t=>a.empresa.tokenIBPT=t),class:"col-12",maxlength:"64",rotulo:"Token IBPT (ibpt.com.br)"},null,8,["modelValue"]),a.empresa.tokenIBPT?(V(),G(k,{key:0,label:"Atualizar al\xEDquotas online",color:"primary",flat:"",icon:"cloud_download",onClick:o[9]||(o[9]=t=>c.importaAliquotasIBPT(a.empresa))})):J("",!0),e(k,{label:"Site para obter o token",color:"primary",flat:"",icon:"vpn_key",onClick:c.abrirSiteIbpt},null,8,["onClick"])]),_:1})]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(_,{class:"q-col-gutter-md"},{default:l(()=>[Ko,e(g,{modelValue:a.empresa.tokenCSCProducao,"onUpdate:modelValue":o[10]||(o[10]=t=>a.empresa.tokenCSCProducao=t),class:"col-12 col-md-4",maxlength:"6",rotulo:"Token CSC Produ\xE7\xE3o"},null,8,["modelValue"]),e(g,{modelValue:a.empresa.hashCSCProducao,"onUpdate:modelValue":o[11]||(o[11]=t=>a.empresa.hashCSCProducao=t),class:"col-12 col-md-8",maxlength:"50",rotulo:"Hash CSC Produ\xE7\xE3o"},null,8,["modelValue"]),e(g,{modelValue:a.empresa.tokenCSCHomologacao,"onUpdate:modelValue":o[12]||(o[12]=t=>a.empresa.tokenCSCHomologacao=t),class:"col-12 col-md-4",maxlength:"6",rotulo:"Token CSC Homologa\xE7\xE3o"},null,8,["modelValue"]),e(g,{modelValue:a.empresa.hashCSCHomologacao,"onUpdate:modelValue":o[13]||(o[13]=t=>a.empresa.hashCSCHomologacao=t),class:"col-12 col-md-8",maxlength:"50",rotulo:"Hash CSC Homologa\xE7\xE3o"},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(_,{class:"q-col-gutter-md"},{default:l(()=>[$o,e(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseOptanteSimples,"onUpdate:modelValue":o[14]||(o[14]=t=>a.empresa.nfseOptanteSimples=t),label:"Optante Simples Nacional",options:[{label:"Sim",value:"1"},{label:"N\xE3o",value:"2"}],"emit-value":"","map-options":"",dense:""},null,8,["modelValue"]),e(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseIncentivadorCultural,"onUpdate:modelValue":o[15]||(o[15]=t=>a.empresa.nfseIncentivadorCultural=t),label:"Incentivador Cultural",options:a.simENaoOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),e(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseNaturezaOperacao,"onUpdate:modelValue":o[16]||(o[16]=t=>a.empresa.nfseNaturezaOperacao=t),label:"Natureza da Opera\xE7\xE3o",options:a.naturezaOperacaoOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),e(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseRegimeTributario,"onUpdate:modelValue":o[17]||(o[17]=t=>a.empresa.nfseRegimeTributario=t),label:"Regime Especial Tributa\xE7\xE3o",options:a.regimeTributarioOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),e(g,{class:"col-12 col-md-3",modelValue:a.empresa.nfseDescricaoServico,"onUpdate:modelValue":o[18]||(o[18]=t=>a.empresa.nfseDescricaoServico=t),rotulo:"Descri\xE7\xE3o do Servi\xE7o"},null,8,["modelValue"]),e(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseCodigoServico,"onUpdate:modelValue":o[19]||(o[19]=t=>a.empresa.nfseCodigoServico=t),options:a.itensListaDeServico,label:"C\xF3digo de Item da Lista e Servi\xE7o","option-label":"descricao","option-value":"codigo","map-options":"","emit-value":"",dense:""},{"no-option":l(()=>[e(fe,null,{default:l(()=>[e(j,null,{default:l(()=>[e(ve,null,{default:l(()=>[E("Nenhuma op\xE7\xE3o. Por favor, cadastre um item")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","options"]),e(g,{class:"col-12 col-md-3",rotulo:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal",modelValue:a.empresa.nfseAliquotaIss,"onUpdate:modelValue":o[20]||(o[20]=t=>a.empresa.nfseAliquotaIss=t)},null,8,["modelValue"]),e(g,{modelValue:a.empresa.nRps,"onUpdate:modelValue":o[21]||(o[21]=t=>a.empresa.nRps=t),class:"col-4 col-md-4",maxlength:"6",rotulo:"Numero RPS"},null,8,["modelValue"]),e(g,{modelValue:a.empresa.serieRps,"onUpdate:modelValue":o[22]||(o[22]=t=>a.empresa.serieRps=t),class:"col-4 col-md-8",maxlength:"6",rotulo:"S\xE9rie RPS"},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(Te,{rows:a.historicoIss,columns:a.colunasTabelaHistoricoIss,"row-key":"name"},{top:l(()=>[p("div",ea,[oa,e(k,{label:"Novo",icon:"add",color:"primary",onClick:o[23]||(o[23]=t=>(a.itemHistoricoIss={...a.itemHistoricoIssModelo},a.itemHistoricoIssModal=!0))})])]),body:l(t=>[e(Le,{props:t},{default:l(()=>[e(Y,{key:"data",props:t},{default:l(()=>[E(w(t.row.data),1)]),_:2},1032,["props"]),e(Y,{key:"aliquota",props:t},{default:l(()=>[E(w(t.row.aliquota)+" % ",1)]),_:2},1032,["props"]),e(Y,{key:"acao",props:t},{default:l(()=>[e(k,{icon:"delete",color:"red",flat:"",onClick:b=>c.removerHistoricoIss(t.rowIndex)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(Te,{rows:a.itensListaDeServico,columns:a.colunasTabelaItensListaServico,"row-key":"name"},{top:l(()=>[p("div",aa,[ta,e(k,{label:"Novo",icon:"add",color:"primary",onClick:o[24]||(o[24]=t=>(a.itemListaDeServico={...a.itemListaDeServicoModelo},a.itemListaDeServicoModal=!0))})])]),body:l(t=>[e(Le,{props:t},{default:l(()=>[e(Y,{key:"codigo",props:t},{default:l(()=>[E(w(t.row.codigo),1)]),_:2},1032,["props"]),e(Y,{key:"codigoCNAE",props:t},{default:l(()=>[E(w(t.row.codigoCNAE),1)]),_:2},1032,["props"]),e(Y,{key:"codigoTributacao",props:t},{default:l(()=>[E(w(t.row.codigoTributacao),1)]),_:2},1032,["props"]),e(Y,{key:"descricao",props:t},{default:l(()=>[E(w(t.row.descricao),1)]),_:2},1032,["props"]),e(Y,{key:"acao",props:t},{default:l(()=>[e(k,{icon:"edit",color:"primary",flat:"",onClick:b=>c.editarItemListaDeServico(t.rowIndex)},null,8,["onClick"]),e(k,{icon:"delete",color:"red",flat:"",onClick:b=>c.removerItemListaDeServico(t.rowIndex)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1}),e(Q,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:l(()=>[e(_,{class:"q-col-gutter-md"},{default:l(()=>[ra,e(k,{label:"Upload certificado",color:"primary",flat:"",icon:"vpn_key",onClick:o[25]||(o[25]=t=>{a.modalCertificado=!0,a.certificado.error={},a.certificado.senha=""})}),e(k,{label:"Adquirir/Renovar Certificado",color:"primary",flat:"",icon:"add_moderator",onClick:c.abrirValidCertificadora},null,8,["onClick"])]),_:1})]),_:1})])])]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:a.modalCertificado,"onUpdate:modelValue":o[30]||(o[30]=t=>a.modalCertificado=t)},{default:l(()=>[e(me,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:l(()=>[p("form",{onSubmit:o[29]||(o[29]=Ue(t=>r.tryLoading(c.enviarCertificado),["prevent"]))},[e(pe,null,{default:l(()=>[e(le,null,{default:l(()=>[z(e(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[W]]),e(se,null,{default:l(()=>[E("Upload certificado digital")]),_:1}),e(k,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),e(ge,{class:"u-container"},{default:l(()=>[e(He,null,{default:l(()=>{var t,b,h;return[p("div",ia,[e(xo,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:c.adicionarCertificado,filter:A=>A.filter(I=>I.type==="application/x-pkcs12")},null,8,["factory","filter"]),e(g,{modelValue:a.certificado.senha,"onUpdate:modelValue":o[28]||(o[28]=A=>a.certificado.senha=A),class:"col-12 q-mt-lg",rotulo:"Senha",type:"password",autofocus:""},null,8,["modelValue"])]),Object.keys((h=(b=(t=a.certificado.error)==null?void 0:t.data)==null?void 0:b.fields)!=null?h:{}).length?(V(),M("div",la,[p("ul",sa,[(V(!0),M($,null,ie(Object.keys(a.certificado.error.data.fields),A=>(V(),M("li",{key:A},[p("span",null,w(A),1),p("span",null,w(a.certificado.error.data.fields[A]),1)]))),128))])])):J("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:a.resultado.visivel,"onUpdate:modelValue":o[31]||(o[31]=t=>a.resultado.visivel=t),"content-css":{width:"100vw",maxWidth:"768px"}},{default:l(()=>[e(me,{container:"",class:"bg-light"},{default:l(()=>[e(pe,null,{default:l(()=>[e(le,null,{default:l(()=>[z(e(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[W]]),e(se,null,{default:l(()=>[E(w(a.resultado.titulo),1)]),_:1}),z(e(k,{color:"white","text-color":"primary",label:a.resultado.percentagem>=99.9?"Fechar":"Parar",unelevated:""},null,8,["label"]),[[W]])]),_:1})]),_:1}),e(ge,{class:"u-container"},{default:l(()=>[e(He,null,{default:l(()=>[e(U,null,{default:l(()=>[e(_,null,{default:l(()=>[na,p("div",ua,w(a.resultado.total),1),ca,p("div",da,w(a.resultado.sucesso),1),ma,p("div",pa,w(a.resultado.erro),1),a.resultado.listaNCMErros.length>0?(V(),M($,{key:0},[ga,(V(!0),M($,null,ie(a.resultado.listaNCMErros,(t,b)=>(V(),M("div",{key:b,class:"col-12 text-subtitle text-tertiary"},"'"+w(t)+"'",1))),128))],64)):J("",!0),e(Vo,{class:"col-12 q-my-md",percentage:a.resultado.percentagem,color:"primary"},null,8,["percentage"]),p("div",fa,w(a.resultado.final),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:a.itemHistoricoIssModal,"onUpdate:modelValue":o[34]||(o[34]=t=>a.itemHistoricoIssModal=t)},{default:l(()=>[e(Q,{style:{"min-width":"350px"}},{default:l(()=>[e(X,null,{default:l(()=>[va]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(ue,{dense:"",modelValue:a.itemHistoricoIss.data,"onUpdate:modelValue":o[32]||(o[32]=t=>a.itemHistoricoIss.data=t),label:"Data",mask:"##/##/####"},null,8,["modelValue"])]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(g,{rotulo:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal",modelValue:a.itemHistoricoIss.aliquota,"onUpdate:modelValue":o[33]||(o[33]=t=>a.itemHistoricoIss.aliquota=t)},null,8,["modelValue"])]),_:1}),e(Oe,{align:"right",class:"text-primary"},{default:l(()=>[z(e(k,{flat:"",label:"Cancel"},null,512),[[W]]),e(k,{flat:"",label:"Adicionar Hist\xF3rico",onClick:c.adicionarHistorico},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:a.itemListaDeServicoModal,"onUpdate:modelValue":o[39]||(o[39]=t=>a.itemListaDeServicoModal=t)},{default:l(()=>[e(Q,{style:{"min-width":"350px"}},{default:l(()=>[e(X,null,{default:l(()=>[ba]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(ue,{dense:"",modelValue:a.itemListaDeServico.codigo,"onUpdate:modelValue":o[35]||(o[35]=t=>a.itemListaDeServico.codigo=t),label:"C\xF3digo"},null,8,["modelValue"])]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(ue,{dense:"",modelValue:a.itemListaDeServico.codigoCNAE,"onUpdate:modelValue":o[36]||(o[36]=t=>a.itemListaDeServico.codigoCNAE=t),label:"C\xF3digo CNAE"},null,8,["modelValue"])]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(ue,{dense:"",modelValue:a.itemListaDeServico.codigoTributacao,"onUpdate:modelValue":o[37]||(o[37]=t=>a.itemListaDeServico.codigoTributacao=t),label:"C\xF3digo de Tributa\xE7\xE3o"},null,8,["modelValue"])]),_:1}),e(X,{class:"q-pt-none"},{default:l(()=>[e(ue,{dense:"",modelValue:a.itemListaDeServico.descricao,"onUpdate:modelValue":o[38]||(o[38]=t=>a.itemListaDeServico.descricao=t),label:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:1}),e(Oe,{align:"right",class:"text-primary"},{default:l(()=>[z(e(k,{flat:"",label:"Cancel"},null,512),[[W]]),a.itemListaDeServico.id===void 0?(V(),G(k,{key:0,flat:"",label:"Adicionar Item",onClick:c.adicionarItemListaDeServico},null,8,["onClick"])):(V(),G(k,{key:1,flat:"",label:"Editar Item",onClick:c.adicionarItemListaDeServico},null,8,["onClick"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:a.empresaUsuarios.mostrar,"onUpdate:modelValue":o[42]||(o[42]=t=>a.empresaUsuarios.mostrar=t),maximized:""},{default:l(()=>[e(me,{container:"",class:"bg-light"},{default:l(()=>[e(pe,{class:"bg-light text-tertiary"},{default:l(()=>[e(le,{class:"bg-primary text-white q-pa-sm"},{default:l(()=>[z(e(k,{dense:"",flat:"",icon:"arrow_back",round:""},null,512),[[W]]),e(se,null,{default:l(()=>[E("Permiss\xE3o de usu\xE1rios")]),_:1}),e(qo),z(e(k,{onClick:c.empresaUsuarios_gravar_click,label:"Salvar","text-color":"primary",color:"white",unelevated:""},null,8,["onClick"]),[[W]])]),_:1}),e(x,{gutter:"sm",items:"center"},{default:l(()=>[e(O,{col:"xs-shrink"},{default:l(()=>[e(q,{imagem:a.empresaUsuarios.empresa.contato.imagem,rotulo:a.empresaUsuarios.empresa.apelido,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:1}),e(O,{col:"xs"},{default:l(()=>[e(n,{text:"body1 medium"},{default:l(()=>[E(w(a.empresaUsuarios.empresa.apelido),1)]),_:1}),e(n,{text:"caption"},{default:l(()=>[E(w(a.empresaUsuarios.empresa.numeroDocumentoNacional),1)]),_:1})]),_:1}),e(O,{col:"xs-shrink"},{default:l(()=>[e(Se,{modelValue:a.empresaUsuarios.empresa.ativo,"onUpdate:modelValue":o[40]||(o[40]=t=>a.empresaUsuarios.empresa.ativo=t),onClick:o[41]||(o[41]=t=>c.empresaUsuarios_ativar_todos_click("empresa",a.empresaUsuarios.empresa))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(ge,null,{default:l(()=>[(V(!0),M($,null,ie(a.empresaUsuarios.grupo,(t,b)=>(V(),G(Eo,{key:b,bordered:"",class:"bg-white q-ma-xs q-mb-md rounded-borders"},{default:l(()=>[e(fe,{clickable:"","manual-focus":"",class:"q-py-sm q-px-xs itemHover"},{default:l(()=>[e(j,{class:"col-xs no-margin",onClick:()=>{t.aberto=!t.aberto}},{default:l(()=>[e(ve,{lines:"1",class:"text-subtitle1 text-weight-bold ellipsis-2-lines"},{default:l(()=>[e(ze,{name:t.aberto?"expand_less":"expand_more",size:"md",class:"q-px-xs"},null,8,["name"]),E(" "+w(t.descricao),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(j,{class:"col-xs-shrink no-margin"},{default:l(()=>[e(Se,{modelValue:t.ativo,"onUpdate:modelValue":h=>t.ativo=h,onClick:h=>c.empresaUsuarios_ativar_todos_click("grupo",t)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)]),_:2},1024),e(Me),(V(!0),M($,null,ie(a.empresaUsuarios.usuario.filter(h=>h.codigoGrupo===t.codigoGrupo),(h,A)=>z((V(),M("div",{key:A,class:"itemHover"},[e(fe,{clickable:"","manual-focus":"",class:"q-py-sm q-px-xs"},{default:l(()=>[e(j,{class:"col-xs no-margin"},{default:l(()=>[e(fe,{class:"q-pa-none"},{default:l(()=>[e(j,{class:"col-auto items-center"},{default:l(()=>[e(q,{imagem:h.imagem,rotulo:h.nome,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:2},1024),e(j,{class:"col"},{default:l(()=>[e(ve,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:l(()=>[E(w(h.nome),1)]),_:2},1024),e(ve,{caption:"",lines:"2",class:"text-tertiary ellipsis"},{default:l(()=>[E(w(h.apelido),1)]),_:2},1024),e(j,{class:"hideondesktop q-mt-sm"},{default:l(()=>[p("div",null,[h.numeroDocumentoNacional?(V(),G(D,{key:0,cor:"tertiary",escuro:"",class:"q-mr-xs"},{default:l(()=>[E(w(h.numeroDocumentoNacional),1)]),_:2},1024)):J("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(j,{class:"hideonmobile maxw180 q-pl-sm no-margin"},{default:l(()=>[h.numeroDocumentoNacional?(V(),G(Do,{key:0,color:"tertiary","multi-line":"",class:"col-auto q-mx-auto q-py-xs"},{default:l(()=>[E(w(h.numeroDocumentoNacional),1)]),_:2},1024)):J("",!0)]),_:2},1024),e(j,{class:"col-xs-shrink no-margin"},{default:l(()=>[e(Se,{modelValue:h.ativo,"onUpdate:modelValue":I=>h.ativo=I,onClick:I=>c.empresaUsuarios_ativar_todos_click("usuario",h)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)]),_:2},1024),e(Me)])),[[Ce,t.aberto]])),128))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ya=_o(Ao,[["render",ha],["__scopeId","data-v-7447af60"]]);export{ya as default};
